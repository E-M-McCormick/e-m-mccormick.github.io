<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Covariates and Distal Outcomes | The Hitchhiker’s Guide to Longitudinal Models</title>
  <meta name="description" content="This is a code companion for The Hitchhiker’s Guide to Longitudinal Models." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Covariates and Distal Outcomes | The Hitchhiker’s Guide to Longitudinal Models" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://https://mccormickneuro.github.io/longitudinal-primer/" />
  
  <meta property="og:description" content="This is a code companion for The Hitchhiker’s Guide to Longitudinal Models." />
  <meta name="github-repo" content="McCormickNeuro/longitudinal-primer" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Covariates and Distal Outcomes | The Hitchhiker’s Guide to Longitudinal Models" />
  
  <meta name="twitter:description" content="This is a code companion for The Hitchhiker’s Guide to Longitudinal Models." />
  

<meta name="author" content="Ethan M. McCormick, Michelle L. Byrne, John C. Flournoy, Kathryn L. Mills, &amp; Jennifer H. Pfeifer" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="04-shape.html"/>
<link rel="next" href="06-nesting.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/font-awesome-5.13.0/js/script.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The Hitchhiker’s Guide to Longitudinal Models</a></li>

<li class="divider"></li>
<li><a href="index.html#about" id="toc-about">About</a></li>
<li><a href="01-introduction.html#intro" id="toc-intro">Introduction</a></li>
<li><a href="02-canonical.html#canon" id="toc-canon">Canonical Models</a>
<ul>
<li><a href="02-canonical.html#multilevel-model" id="toc-multilevel-model">Multilevel Model</a>
<ul>
<li><a href="02-canonical.html#nlme" id="toc-nlme">nlme</a></li>
<li><a href="02-canonical.html#lme4" id="toc-lme4">lme4</a></li>
<li><a href="02-canonical.html#lmertest" id="toc-lmertest">lmerTest</a></li>
<li><a href="02-canonical.html#mlm-outputs" id="toc-mlm-outputs">MLM Outputs</a></li>
<li><a href="02-canonical.html#mlm-plotting-model-implied-trajectories" id="toc-mlm-plotting-model-implied-trajectories">MLM Plotting Model-Implied Trajectories</a></li>
</ul></li>
<li><a href="02-canonical.html#generalized-additive-mixed-model" id="toc-generalized-additive-mixed-model">Generalized Additive Mixed Model</a>
<ul>
<li><a href="02-canonical.html#gamm-outputs" id="toc-gamm-outputs">GAMM Outputs</a></li>
</ul></li>
<li><a href="02-canonical.html#latent-curve-model" id="toc-latent-curve-model">Latent Curve Model</a>
<ul>
<li><a href="02-canonical.html#lcm-syntax-and-model-fitting" id="toc-lcm-syntax-and-model-fitting">LCM Syntax and Model Fitting</a></li>
<li><a href="02-canonical.html#lcm-outputs" id="toc-lcm-outputs">LCM Outputs</a></li>
<li><a href="02-canonical.html#lcm-path-diagrams" id="toc-lcm-path-diagrams">LCM Path Diagrams</a></li>
<li><a href="02-canonical.html#lcm-plotting-model-implied-trajectories" id="toc-lcm-plotting-model-implied-trajectories">LCM Plotting Model-Implied Trajectories</a></li>
</ul></li>
<li><a href="02-canonical.html#latent-change-score-model" id="toc-latent-change-score-model">Latent Change Score Model</a>
<ul>
<li><a href="02-canonical.html#linear-lcsm" id="toc-linear-lcsm">Linear LCSM</a></li>
<li><a href="02-canonical.html#linear-lcsm-with-proportional-change" id="toc-linear-lcsm-with-proportional-change">Linear LCSM with Proportional Change</a></li>
</ul></li>
</ul></li>
<li><a href="03-time.html#time" id="toc-time">Time Structure</a>
<ul>
<li><a href="03-time.html#assessment-schedules" id="toc-assessment-schedules">Assessment Schedules</a>
<ul>
<li><a href="03-time.html#single-cohort-data" id="toc-single-cohort-data">Single Cohort Data</a></li>
<li><a href="03-time.html#multiple-cohort-data" id="toc-multiple-cohort-data">Multiple Cohort Data</a></li>
<li><a href="03-time.html#accelerated-design" id="toc-accelerated-design">Accelerated Design</a></li>
</ul></li>
<li><a href="03-time.html#time-coding" id="toc-time-coding">Time Coding</a></li>
<li><a href="03-time.html#additional-considerations" id="toc-additional-considerations">Additional Considerations</a>
<ul>
<li><a href="03-time.html#alternative-metrics-of-time" id="toc-alternative-metrics-of-time">Alternative Metrics of Time</a></li>
<li><a href="03-time.html#residual-estimates" id="toc-residual-estimates">Residual Estimates</a></li>
</ul></li>
</ul></li>
<li><a href="04-shape.html#shape" id="toc-shape">The Shape of Development</a>
<ul>
<li><a href="04-shape.html#polynomial-trajectories" id="toc-polynomial-trajectories">Polynomial Trajectories</a>
<ul>
<li><a href="04-shape.html#intercept-only-model" id="toc-intercept-only-model">Intercept-Only Model</a></li>
<li><a href="04-shape.html#linear-model" id="toc-linear-model">Linear Model</a></li>
<li><a href="04-shape.html#quadratic-model" id="toc-quadratic-model">Quadratic Model</a></li>
<li><a href="04-shape.html#inverse-model" id="toc-inverse-model">Inverse Model</a></li>
</ul></li>
<li><a href="04-shape.html#piecewise-trajectories" id="toc-piecewise-trajectories">Piecewise Trajectories</a></li>
<li><a href="04-shape.html#nonlinear-trajectories" id="toc-nonlinear-trajectories">Nonlinear Trajectories</a></li>
<li><a href="04-shape.html#fixed-and-random-effects" id="toc-fixed-and-random-effects">Fixed and Random Effects</a></li>
</ul></li>
<li><a href="05-covariates.html#covariates" id="toc-covariates">Covariates and Distal Outcomes</a>
<ul>
<li><a href="05-covariates.html#covariates-1" id="toc-covariates-1">Covariates</a>
<ul>
<li><a href="05-covariates.html#time-invariant-covariates" id="toc-time-invariant-covariates">Time Invariant Covariates</a></li>
<li><a href="05-covariates.html#cross-level-interactions" id="toc-cross-level-interactions">Cross-Level Interactions</a></li>
<li><a href="05-covariates.html#time-varying-covariates" id="toc-time-varying-covariates">Time Varying Covariates</a></li>
<li><a href="05-covariates.html#multivariate-models" id="toc-multivariate-models">Multivariate Models</a></li>
<li><a href="05-covariates.html#within--and-betwen-person-variance" id="toc-within--and-betwen-person-variance">Within- and Betwen-Person Variance</a></li>
</ul></li>
<li><a href="05-covariates.html#distal-outcomes" id="toc-distal-outcomes">Distal Outcomes</a></li>
</ul></li>
<li><a href="06-nesting.html#nesting" id="toc-nesting">Nested Data</a>
<ul>
<li><a href="06-nesting.html#unconditional-model" id="toc-unconditional-model">Unconditional Model</a></li>
<li><a href="06-nesting.html#categorical-predictors" id="toc-categorical-predictors">Categorical Predictors</a></li>
<li><a href="06-nesting.html#multiple-groups-models" id="toc-multiple-groups-models">Multiple Groups Models</a></li>
<li><a href="06-nesting.html#fixed-effect-approach" id="toc-fixed-effect-approach">Fixed Effect Approach</a></li>
<li><a href="06-nesting.html#random-effect-approach" id="toc-random-effect-approach">Random Effect Approach</a></li>
<li><a href="06-nesting.html#cluster-correction" id="toc-cluster-correction">Cluster Correction</a></li>
</ul></li>
<li><a href="07-datasets.html#datasets" id="toc-datasets">Datasets</a>
<ul>
<li><a href="07-datasets.html#descriptions" id="toc-descriptions">Descriptions</a>
<ul>
<li><a href="07-datasets.html#executive-function" id="toc-executive-function">Executive Function</a></li>
<li><a href="07-datasets.html#feedback-learning" id="toc-feedback-learning">Feedback Learning</a></li>
<li><a href="07-datasets.html#externalizing-and-math" id="toc-externalizing-and-math">Externalizing and Math</a></li>
<li><a href="07-datasets.html#adversity" id="toc-adversity">Adversity</a></li>
<li><a href="07-datasets.html#trials" id="toc-trials">Trials</a></li>
<li><a href="07-datasets.html#achieve" id="toc-achieve">Achieve</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Hitchhiker’s Guide to Longitudinal Models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="covariates" class="section level1">
<h1>Covariates and Distal Outcomes</h1>
<p>Thus far, we have only considered <em>unconditional</em> growth models. This is somewhat of a misnomer because clearly time is included as a predictor, but that is considered integral to the growth model so we tend not to count it as a conditional model (as with many terminological things in quant: <strong>shrugs</strong>). What we will do in this section is bring in additional variables to our growth model as predictors. These covariates will either predict the parameters of the growth process (i.e., intercept and slope) or the individual repeated measures directly (some models will allow a single covariate to do both simultaneously). We will read in the relevant data sets below.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="05-covariates.html#cb164-1" aria-hidden="true" tabindex="-1"></a>adversity <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/adversity.csv&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb164-2"><a href="05-covariates.html#cb164-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-3"><a href="05-covariates.html#cb164-3" aria-hidden="true" tabindex="-1"></a>executive.function <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/executive-function.csv&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div id="covariates-1" class="section level2">
<h2>Covariates</h2>
<div id="time-invariant-covariates" class="section level3">
<h3>Time Invariant Covariates</h3>
<p>We will begin with the relatively straightforward time-invariant covariate (TIC). These covariates operate at the level of the growth process: meaning that they predict the random effects (MEMs) or latent factors (SEMs). As the name implies, we will have a single value of each TIC per individual. While we often obtain that value at the first observation, in theory we could have measured that variable at any time and we should get the same value (otherwise it isn’t time-invariant, is it?). One common misconception is that there is any temporal ordering inherent at this level of the model. The TIC and the intercept/slope parameters are time-invariant and so we cannot establish temporal precedence unless we bring other knowledge of the data to bear (e.g., the TIC measures something early in life and the growth parameters are fit to adolescent data). This is the same reason why regressing the slope of one outcome on the intercept of the other is very theoretically dubious unless the growth processes are truly separated in time. At this level, we essentially have cross-sectional regressions (again unless we know something extra about our variables temporally). As such, inclusion of TICs is relatively simple compared with what we will consider for the remainder of this section. We will demonstrate our examples in the MLM and LCM because of the relatively simple syntax, but the principles extend naturally to the GAMM and LCSM.</p>
<p>Below we can expand our unconditional growth of <code>fmin</code> to include an early life experience variable. Here we will begin with the multilevel model. Including a TIC is trivially easy from a model syntax standpoint. We can add our early life experience variable (<code>neglect</code>) into the fixed effect just as we have done for <code>age</code>. Even though these variables operate at different levels of the model (<code>age</code> is a level 1 variable and <code>neglect</code> is a level 2 variable) there is no need to differentiate them in the model syntax. We will need to keep track of these different levels of effect in our <em>interpretation</em> but the model really operates at a single <strong>reduced-form</strong> level and our syntax reflects that fact.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="05-covariates.html#cb165-1" aria-hidden="true" tabindex="-1"></a>adversity.long <span class="ot">&lt;-</span> adversity <span class="sc">%&gt;%</span> </span>
<span id="cb165-2"><a href="05-covariates.html#cb165-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;fmin&quot;</span>), </span>
<span id="cb165-3"><a href="05-covariates.html#cb165-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;.value&quot;</span>, <span class="st">&quot;age&quot;</span>), </span>
<span id="cb165-4"><a href="05-covariates.html#cb165-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_pattern =</span> <span class="st">&quot;(fmin)(.+)&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb165-5"><a href="05-covariates.html#cb165-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> <span class="fu">as.numeric</span>(age)) <span class="sc">%&gt;%</span></span>
<span id="cb165-6"><a href="05-covariates.html#cb165-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(fmin)</span>
<span id="cb165-7"><a href="05-covariates.html#cb165-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-8"><a href="05-covariates.html#cb165-8" aria-hidden="true" tabindex="-1"></a>tic.mlm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(fmin <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> neglect <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> age <span class="sc">|</span> id),</span>
<span id="cb165-9"><a href="05-covariates.html#cb165-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.action =</span> na.omit,</span>
<span id="cb165-10"><a href="05-covariates.html#cb165-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">REML =</span> <span class="cn">TRUE</span>,</span>
<span id="cb165-11"><a href="05-covariates.html#cb165-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> adversity.long,</span>
<span id="cb165-12"><a href="05-covariates.html#cb165-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>,</span>
<span id="cb165-13"><a href="05-covariates.html#cb165-13" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>)))</span>
<span id="cb165-14"><a href="05-covariates.html#cb165-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-15"><a href="05-covariates.html#cb165-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tic.mlm, <span class="at">correlation =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [&#39;lmerModLmerTest&#39;]
## Formula: fmin ~ 1 + age + neglect + (1 + age | id)
##    Data: adversity.long
## Control: lmerControl(optimizer = &quot;bobyqa&quot;, optCtrl = list(maxfun = 2e+05))
## 
## REML criterion at convergence: 3544
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.4004 -0.5309 -0.1831  0.4462  3.7548 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr 
##  id       (Intercept) 0.26613  0.5159        
##           age         0.01086  0.1042   -0.31
##  Residual             0.62111  0.7881        
## Number of obs: 1240, groups:  id, 398
## 
## Fixed effects:
##              Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)  -0.17524    0.08671 320.73547  -2.021   0.0441 *  
## age           0.05101    0.01199 291.23548   4.256 2.81e-05 ***
## neglect      -0.10133    0.01911 397.77909  -5.301 1.91e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Here we can see that there is a positive effect of <code>age</code>, reflecting general increases in FA values across age. Conversely, there is a negative <em>between-person</em> effect of <code>neglect</code>, with those experiencing greater levels of early childhood neglect showing reduced levels of white matter FA in the forceps minor (<code>fmin</code>). Note that this is a prediction of level, not of slopes. We will return to this in a bit when we consider cross-level interactions.</p>
<p>The corresponding model in the LCM is similarly straightforward.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="05-covariates.html#cb167-1" aria-hidden="true" tabindex="-1"></a>tic.lcm <span class="ot">&lt;-</span> <span class="st">&quot;int =~ 1*fmin4 + 1*fmin5 + 1*fmin6 + 1*fmin7 + 1*fmin8 +</span></span>
<span id="cb167-2"><a href="05-covariates.html#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="st">                   1*fmin9 + 1*fmin10 + 1*fmin11</span></span>
<span id="cb167-3"><a href="05-covariates.html#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="st">            slp =~ 0*fmin4 + 1*fmin5 + 2*fmin6 + 3*fmin7 + 4*fmin8 +</span></span>
<span id="cb167-4"><a href="05-covariates.html#cb167-4" aria-hidden="true" tabindex="-1"></a><span class="st">                   5*fmin9 + 6*fmin10 + 7*fmin11</span></span>
<span id="cb167-5"><a href="05-covariates.html#cb167-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-6"><a href="05-covariates.html#cb167-6" aria-hidden="true" tabindex="-1"></a><span class="st">            int ~ neglect&quot;</span></span>
<span id="cb167-7"><a href="05-covariates.html#cb167-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-8"><a href="05-covariates.html#cb167-8" aria-hidden="true" tabindex="-1"></a>tic.lcm.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(tic.lcm, </span>
<span id="cb167-9"><a href="05-covariates.html#cb167-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> adversity,</span>
<span id="cb167-10"><a href="05-covariates.html#cb167-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb167-11"><a href="05-covariates.html#cb167-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb167-12"><a href="05-covariates.html#cb167-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-13"><a href="05-covariates.html#cb167-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tic.lcm.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>, </span>
<span id="cb167-14"><a href="05-covariates.html#cb167-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">FALSE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 29 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        13
## 
##   Number of observations                           398
##   Number of missing patterns                        40
## 
## Model Test User Model:
##                                                       
##   Test statistic                                49.965
##   Degrees of freedom                                39
##   P-value (Chi-square)                           0.112
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int =~                                              
##     fmin4             1.000                           
##     fmin5             1.000                           
##     fmin6             1.000                           
##     fmin7             1.000                           
##     fmin8             1.000                           
##     fmin9             1.000                           
##     fmin10            1.000                           
##     fmin11            1.000                           
##   slp =~                                              
##     fmin4             0.000                           
##     fmin5             1.000                           
##     fmin6             2.000                           
##     fmin7             3.000                           
##     fmin8             4.000                           
##     fmin9             5.000                           
##     fmin10            6.000                           
##     fmin11            7.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int ~                                               
##     neglect          -0.101    0.019   -5.352    0.000
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .fmin4             0.000                           
##    .fmin5             0.000                           
##    .fmin6             0.000                           
##    .fmin7             0.000                           
##    .fmin8             0.000                           
##    .fmin9             0.000                           
##    .fmin10            0.000                           
##    .fmin11            0.000                           
##    .int               0.026    0.052    0.502    0.616
##     slp               0.049    0.012    3.997    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .fmin4             0.578    0.107    5.380    0.000
##    .fmin5             0.433    0.072    5.998    0.000
##    .fmin6             0.598    0.099    6.032    0.000
##    .fmin7             0.682    0.092    7.434    0.000
##    .fmin8             0.796    0.123    6.459    0.000
##    .fmin9             0.623    0.095    6.592    0.000
##    .fmin10            0.393    0.111    3.543    0.000
##    .fmin11            0.575    0.120    4.791    0.000
##    .int               0.402    0.059    6.835    0.000
##     slp               0.017    0.003    5.031    0.000</code></pre>
<p>This syntax highlights the idea that our TIC is only predicting the intercept (i.e., level). We will extend this model later. However, there are two potential extensions of the TIC model in the SEM that we can consider here. One concerns missing data on our exogenous TIC. For <strong>reasons</strong> (the reasons aren’t particularly important for our purposes), the standard estimator for SEMs in most software is a conditional estimator, which is the same used in MLMs. The upshot of this estimator is that we cannot accomodate <em>any</em> missing data on exogenous variables (i.e, variables that only act as predictors) in the model. With this estimator any individual with missing observations on the exogenous variable will simply be dropped from the model. We can see this below where we predict the intercept by maternal warmth in early childhood (<code>warmth</code>).</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="05-covariates.html#cb169-1" aria-hidden="true" tabindex="-1"></a>joint.lik <span class="ot">&lt;-</span> <span class="st">&quot;int =~ 1*fmin4 + 1*fmin5 + 1*fmin6 + 1*fmin7 + 1*fmin8 +</span></span>
<span id="cb169-2"><a href="05-covariates.html#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="st">                     1*fmin9 + 1*fmin10 + 1*fmin11</span></span>
<span id="cb169-3"><a href="05-covariates.html#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="st">              slp =~ 0*fmin4 + 1*fmin5 + 2*fmin6 + 3*fmin7 + 4*fmin8 +</span></span>
<span id="cb169-4"><a href="05-covariates.html#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="st">                     5*fmin9 + 6*fmin10 + 7*fmin11</span></span>
<span id="cb169-5"><a href="05-covariates.html#cb169-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-6"><a href="05-covariates.html#cb169-6" aria-hidden="true" tabindex="-1"></a><span class="st">              int ~ warmth&quot;</span></span>
<span id="cb169-7"><a href="05-covariates.html#cb169-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-8"><a href="05-covariates.html#cb169-8" aria-hidden="true" tabindex="-1"></a>joint.lik.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(joint.lik, </span>
<span id="cb169-9"><a href="05-covariates.html#cb169-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> adversity,</span>
<span id="cb169-10"><a href="05-covariates.html#cb169-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb169-11"><a href="05-covariates.html#cb169-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb169-12"><a href="05-covariates.html#cb169-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-13"><a href="05-covariates.html#cb169-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(joint.lik.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">FALSE</span>, </span>
<span id="cb169-14"><a href="05-covariates.html#cb169-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">FALSE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 27 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        13
## 
##   Number of observations                           398
##   Number of missing patterns                        40
## 
## Model Test User Model:
##                                                       
##   Test statistic                                55.165
##   Degrees of freedom                                39
##   P-value (Chi-square)                           0.045</code></pre>
<p>We can see that while the dataset has a total of <span class="math inline">\(398\)</span> individuals, only <span class="math inline">\(361\)</span> are being used in the actual model fit. While in the MLM, this would be the price of admission, in the SEM we can utilize the <em>joint</em> rather than the conditional likelihood which instead estimates a mean and variance for the exogenous variable (essentially treating it as an <em>endogenous</em> variable with no predictors). There are two ways to accomplish this. In general, we can simply explicitly include a variance and intercept term for the exogenous variable(s) in the model syntax (this works across programs). We can see this below.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="05-covariates.html#cb171-1" aria-hidden="true" tabindex="-1"></a>joint.lik <span class="ot">&lt;-</span> <span class="st">&quot;int =~ 1*fmin4 + 1*fmin5 + 1*fmin6 + 1*fmin7 + 1*fmin8 +</span></span>
<span id="cb171-2"><a href="05-covariates.html#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="st">                     1*fmin9 + 1*fmin10 + 1*fmin11</span></span>
<span id="cb171-3"><a href="05-covariates.html#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="st">              slp =~ 0*fmin4 + 1*fmin5 + 2*fmin6 + 3*fmin7 + 4*fmin8 +</span></span>
<span id="cb171-4"><a href="05-covariates.html#cb171-4" aria-hidden="true" tabindex="-1"></a><span class="st">                     5*fmin9 + 6*fmin10 + 7*fmin11</span></span>
<span id="cb171-5"><a href="05-covariates.html#cb171-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-6"><a href="05-covariates.html#cb171-6" aria-hidden="true" tabindex="-1"></a><span class="st">              int ~ warmth</span></span>
<span id="cb171-7"><a href="05-covariates.html#cb171-7" aria-hidden="true" tabindex="-1"></a><span class="st">               </span></span>
<span id="cb171-8"><a href="05-covariates.html#cb171-8" aria-hidden="true" tabindex="-1"></a><span class="st">              warmth ~~ warmth</span></span>
<span id="cb171-9"><a href="05-covariates.html#cb171-9" aria-hidden="true" tabindex="-1"></a><span class="st">              warmth ~ 1&quot;</span></span>
<span id="cb171-10"><a href="05-covariates.html#cb171-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-11"><a href="05-covariates.html#cb171-11" aria-hidden="true" tabindex="-1"></a>joint.lik.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(joint.lik, </span>
<span id="cb171-12"><a href="05-covariates.html#cb171-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> adversity,</span>
<span id="cb171-13"><a href="05-covariates.html#cb171-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb171-14"><a href="05-covariates.html#cb171-14" aria-hidden="true" tabindex="-1"></a>                      <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb171-15"><a href="05-covariates.html#cb171-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-16"><a href="05-covariates.html#cb171-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(joint.lik.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">FALSE</span>, </span>
<span id="cb171-17"><a href="05-covariates.html#cb171-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">FALSE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 27 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        15
## 
##   Number of observations                           398
##   Number of missing patterns                        40
## 
## Model Test User Model:
##                                                       
##   Test statistic                                55.165
##   Degrees of freedom                                39
##   P-value (Chi-square)                           0.045</code></pre>
<p>In <strong>lavaan</strong> we have the additional option to use the argument <code>fixed.x = FALSE</code> which will accomplish the same thing without the additional lines of syntax.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="05-covariates.html#cb173-1" aria-hidden="true" tabindex="-1"></a>joint.lik <span class="ot">&lt;-</span> <span class="st">&quot;int =~ 1*fmin4 + 1*fmin5 + 1*fmin6 + 1*fmin7 + 1*fmin8 +</span></span>
<span id="cb173-2"><a href="05-covariates.html#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="st">                     1*fmin9 + 1*fmin10 + 1*fmin11</span></span>
<span id="cb173-3"><a href="05-covariates.html#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="st">              slp =~ 0*fmin4 + 1*fmin5 + 2*fmin6 + 3*fmin7 + 4*fmin8 +</span></span>
<span id="cb173-4"><a href="05-covariates.html#cb173-4" aria-hidden="true" tabindex="-1"></a><span class="st">                     5*fmin9 + 6*fmin10 + 7*fmin11</span></span>
<span id="cb173-5"><a href="05-covariates.html#cb173-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-6"><a href="05-covariates.html#cb173-6" aria-hidden="true" tabindex="-1"></a><span class="st">              int ~ warmth&quot;</span></span>
<span id="cb173-7"><a href="05-covariates.html#cb173-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-8"><a href="05-covariates.html#cb173-8" aria-hidden="true" tabindex="-1"></a>joint.lik.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(joint.lik, </span>
<span id="cb173-9"><a href="05-covariates.html#cb173-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> adversity,</span>
<span id="cb173-10"><a href="05-covariates.html#cb173-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb173-11"><a href="05-covariates.html#cb173-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>,</span>
<span id="cb173-12"><a href="05-covariates.html#cb173-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fixed.x =</span> <span class="cn">FALSE</span>)</span>
<span id="cb173-13"><a href="05-covariates.html#cb173-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-14"><a href="05-covariates.html#cb173-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(joint.lik.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">FALSE</span>, </span>
<span id="cb173-15"><a href="05-covariates.html#cb173-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">FALSE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 27 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        14
## 
##   Number of observations                           398
##   Number of missing patterns                        40
## 
## Model Test User Model:
##                                                       
##   Test statistic                                56.625
##   Degrees of freedom                                40
##   P-value (Chi-square)                           0.043</code></pre>
<p>In both instances, we can see that the model utilizes all observations rather than only those with non-missing values on <code>warmth</code>. One particular application where this may be of interest is when doing a larger behavioral study with a smaller neuroimaging component. If the brain measures are predictors, than the joint likelihood approach allows us to estimate the behavioral parameters from the larger dataset when including brain-based variables.</p>
<p>Another unique strength of SEMs is the ability to leverage the power of latent variables at all levels of the model. Observed TICs are by-far the most common application of these models, but there is nothing stopping us from attenuating measurement error in the TIC as well using a measurement model. We can see this below where we regress the intercept on a latent measure of cognitive stimulation in the home (measured by observed variables: <code>cog1</code> - <code>cog4</code>). Unlike the growth-related latent variables, here we allow the factor loadings on the latent <code>cog</code> variable to be freely-estimated.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="05-covariates.html#cb175-1" aria-hidden="true" tabindex="-1"></a>latent.tic <span class="ot">&lt;-</span> <span class="st">&quot;int =~ 1*fmin4 + 1*fmin5 + 1*fmin6 + 1*fmin7 + 1*fmin8 +</span></span>
<span id="cb175-2"><a href="05-covariates.html#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="st">                      1*fmin9 + 1*fmin10 + 1*fmin11</span></span>
<span id="cb175-3"><a href="05-covariates.html#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="st">               slp =~ 0*fmin4 + 1*fmin5 + 2*fmin6 + 3*fmin7 + 4*fmin8 +</span></span>
<span id="cb175-4"><a href="05-covariates.html#cb175-4" aria-hidden="true" tabindex="-1"></a><span class="st">                      5*fmin9 + 6*fmin10 + 7*fmin11</span></span>
<span id="cb175-5"><a href="05-covariates.html#cb175-5" aria-hidden="true" tabindex="-1"></a><span class="st">                          </span></span>
<span id="cb175-6"><a href="05-covariates.html#cb175-6" aria-hidden="true" tabindex="-1"></a><span class="st">               cog =~ cog1 + cog2 + cog3 + cog4</span></span>
<span id="cb175-7"><a href="05-covariates.html#cb175-7" aria-hidden="true" tabindex="-1"></a><span class="st">               cog ~~ 1*cog</span></span>
<span id="cb175-8"><a href="05-covariates.html#cb175-8" aria-hidden="true" tabindex="-1"></a><span class="st">               cog ~ 0*1</span></span>
<span id="cb175-9"><a href="05-covariates.html#cb175-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-10"><a href="05-covariates.html#cb175-10" aria-hidden="true" tabindex="-1"></a><span class="st">               int ~ cog&quot;</span></span>
<span id="cb175-11"><a href="05-covariates.html#cb175-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-12"><a href="05-covariates.html#cb175-12" aria-hidden="true" tabindex="-1"></a>latent.tic.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(latent.tic, </span>
<span id="cb175-13"><a href="05-covariates.html#cb175-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> adversity,</span>
<span id="cb175-14"><a href="05-covariates.html#cb175-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb175-15"><a href="05-covariates.html#cb175-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb175-16"><a href="05-covariates.html#cb175-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-17"><a href="05-covariates.html#cb175-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(latent.tic.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>, </span>
<span id="cb175-18"><a href="05-covariates.html#cb175-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">TRUE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 29 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        21
## 
##   Number of observations                           398
##   Number of missing patterns                        40
## 
## Model Test User Model:
##                                                       
##   Test statistic                               133.445
##   Degrees of freedom                                69
##   P-value (Chi-square)                           0.000
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   int =~                                                                
##     fmin4             1.000                               0.710    0.692
##     fmin5             1.000                               0.710    0.735
##     fmin6             1.000                               0.710    0.664
##     fmin7             1.000                               0.710    0.620
##     fmin8             1.000                               0.710    0.574
##     fmin9             1.000                               0.710    0.577
##     fmin10            1.000                               0.710    0.589
##     fmin11            1.000                               0.710    0.520
##   slp =~                                                                
##     fmin4             0.000                               0.000    0.000
##     fmin5             1.000                               0.134    0.139
##     fmin6             2.000                               0.268    0.251
##     fmin7             3.000                               0.402    0.351
##     fmin8             4.000                               0.536    0.434
##     fmin9             5.000                               0.670    0.544
##     fmin10            6.000                               0.804    0.667
##     fmin11            7.000                               0.938    0.687
##   cog =~                                                                
##     cog1              1.000                               1.000    0.756
##     cog2              0.452    0.084    5.397    0.000    0.452    0.404
##     cog3              0.574    0.095    6.043    0.000    0.574    0.500
##     cog4              0.588    0.098    5.992    0.000    0.588    0.514
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   int ~                                                                 
##     cog               0.331    0.078    4.268    0.000    0.466    0.466
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   slp ~~                                                                
##     cog              -0.020    0.018   -1.100    0.271   -0.147   -0.147
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##     cog               0.000                               0.000    0.000
##    .fmin4             0.000                               0.000    0.000
##    .fmin5             0.000                               0.000    0.000
##    .fmin6             0.000                               0.000    0.000
##    .fmin7             0.000                               0.000    0.000
##    .fmin8             0.000                               0.000    0.000
##    .fmin9             0.000                               0.000    0.000
##    .fmin10            0.000                               0.000    0.000
##    .fmin11            0.000                               0.000    0.000
##    .cog1              0.000                               0.000    0.000
##    .cog2              0.000                               0.000    0.000
##    .cog3              0.000                               0.000    0.000
##    .cog4              0.000                               0.000    0.000
##    .int               0.040    0.052    0.762    0.446    0.056    0.056
##     slp               0.048    0.012    3.878    0.000    0.356    0.356
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##     cog               1.000                               1.000    1.000
##    .fmin4             0.548    0.107    5.132    0.000    0.548    0.521
##    .fmin5             0.425    0.073    5.837    0.000    0.425    0.455
##    .fmin6             0.593    0.099    5.986    0.000    0.593    0.519
##    .fmin7             0.684    0.092    7.439    0.000    0.684    0.522
##    .fmin8             0.789    0.122    6.451    0.000    0.789    0.516
##    .fmin9             0.628    0.095    6.608    0.000    0.628    0.414
##    .fmin10            0.379    0.109    3.466    0.001    0.379    0.261
##    .fmin11            0.573    0.121    4.748    0.000    0.573    0.307
##    .cog1              0.750    0.124    6.036    0.000    0.750    0.428
##    .cog2              1.051    0.084   12.504    0.000    1.051    0.837
##    .cog3              0.990    0.093   10.672    0.000    0.990    0.750
##    .cog4              0.963    0.095   10.171    0.000    0.963    0.736
##    .int               0.395    0.061    6.461    0.000    0.783    0.783
##     slp               0.018    0.003    5.199    0.000    1.000    1.000</code></pre>
<p>You might wonder why bother estimating a new latent variable rather than simply summing up the <code>cog</code> items and regressing the intercept on the observed measure. Well we can do this below and compare the results to the latent TIC approach.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="05-covariates.html#cb177-1" aria-hidden="true" tabindex="-1"></a>adversity <span class="ot">=</span> adversity <span class="sc">%&gt;%</span></span>
<span id="cb177-2"><a href="05-covariates.html#cb177-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cog =</span> cog1 <span class="sc">+</span> cog2 <span class="sc">+</span> cog3 <span class="sc">+</span> cog4)</span>
<span id="cb177-3"><a href="05-covariates.html#cb177-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-4"><a href="05-covariates.html#cb177-4" aria-hidden="true" tabindex="-1"></a>obs.tic <span class="ot">&lt;-</span> <span class="st">&quot;int =~ 1*fmin4 + 1*fmin5 + 1*fmin6 + 1*fmin7 + 1*fmin8 +</span></span>
<span id="cb177-5"><a href="05-covariates.html#cb177-5" aria-hidden="true" tabindex="-1"></a><span class="st">                   1*fmin9 + 1*fmin10 + 1*fmin11</span></span>
<span id="cb177-6"><a href="05-covariates.html#cb177-6" aria-hidden="true" tabindex="-1"></a><span class="st">            slp =~ 0*fmin4 + 1*fmin5 + 2*fmin6 + 3*fmin7 + 4*fmin8 +</span></span>
<span id="cb177-7"><a href="05-covariates.html#cb177-7" aria-hidden="true" tabindex="-1"></a><span class="st">                   5*fmin9 + 6*fmin10 + 7*fmin11</span></span>
<span id="cb177-8"><a href="05-covariates.html#cb177-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-9"><a href="05-covariates.html#cb177-9" aria-hidden="true" tabindex="-1"></a><span class="st">            int ~ cog&quot;</span></span>
<span id="cb177-10"><a href="05-covariates.html#cb177-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-11"><a href="05-covariates.html#cb177-11" aria-hidden="true" tabindex="-1"></a>obs.tic.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(obs.tic, </span>
<span id="cb177-12"><a href="05-covariates.html#cb177-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> adversity,</span>
<span id="cb177-13"><a href="05-covariates.html#cb177-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb177-14"><a href="05-covariates.html#cb177-14" aria-hidden="true" tabindex="-1"></a>                      <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb177-15"><a href="05-covariates.html#cb177-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-16"><a href="05-covariates.html#cb177-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(obs.tic.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>, </span>
<span id="cb177-17"><a href="05-covariates.html#cb177-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">TRUE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 26 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        13
## 
##   Number of observations                           398
##   Number of missing patterns                        40
## 
## Model Test User Model:
##                                                       
##   Test statistic                                49.911
##   Degrees of freedom                                39
##   P-value (Chi-square)                           0.113
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   int =~                                                                
##     fmin4             1.000                               0.676    0.667
##     fmin5             1.000                               0.676    0.708
##     fmin6             1.000                               0.676    0.640
##     fmin7             1.000                               0.676    0.595
##     fmin8             1.000                               0.676    0.549
##     fmin9             1.000                               0.676    0.548
##     fmin10            1.000                               0.676    0.558
##     fmin11            1.000                               0.676    0.494
##   slp =~                                                                
##     fmin4             0.000                               0.000    0.000
##     fmin5             1.000                               0.132    0.138
##     fmin6             2.000                               0.263    0.249
##     fmin7             3.000                               0.395    0.347
##     fmin8             4.000                               0.526    0.427
##     fmin9             5.000                               0.658    0.533
##     fmin10            6.000                               0.789    0.651
##     fmin11            7.000                               0.921    0.673
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   int ~                                                                 
##     cog               0.069    0.015    4.563    0.000    0.103    0.296
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .fmin4             0.000                               0.000    0.000
##    .fmin5             0.000                               0.000    0.000
##    .fmin6             0.000                               0.000    0.000
##    .fmin7             0.000                               0.000    0.000
##    .fmin8             0.000                               0.000    0.000
##    .fmin9             0.000                               0.000    0.000
##    .fmin10            0.000                               0.000    0.000
##    .fmin11            0.000                               0.000    0.000
##    .int               0.037    0.052    0.715    0.475    0.055    0.055
##     slp               0.049    0.012    3.993    0.000    0.372    0.372
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .fmin4             0.569    0.107    5.305    0.000    0.569    0.555
##    .fmin5             0.436    0.073    5.963    0.000    0.436    0.479
##    .fmin6             0.591    0.098    6.002    0.000    0.591    0.529
##    .fmin7             0.678    0.091    7.424    0.000    0.678    0.525
##    .fmin8             0.782    0.122    6.435    0.000    0.782    0.516
##    .fmin9             0.631    0.095    6.624    0.000    0.631    0.415
##    .fmin10            0.389    0.110    3.524    0.000    0.389    0.265
##    .fmin11            0.568    0.120    4.746    0.000    0.568    0.303
##    .int               0.417    0.060    6.992    0.000    0.912    0.912
##     slp               0.017    0.003    5.151    0.000    1.000    1.000</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="05-covariates.html#cb179-1" aria-hidden="true" tabindex="-1"></a>adversity <span class="ot">&lt;-</span> adversity <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>cog)</span></code></pre></div>
<p>Focusing one the regression of <code>int ~ cog</code> in both models, we can compare the standardized coefficients and see that the observed measure reduces the effect quite substantially (latent TIC: <span class="math inline">\(\beta = 0.466\)</span>, observed TIC: <span class="math inline">\(\beta = 0.296\)</span>). Since we simulated this measure a, we knew that the true standardized effect should be <span class="math inline">\(\beta_{population} = 0.500\)</span>, highlighting the utility of latent variables to attenuate the effects of measurement error that often bias effects downwards.</p>
</div>
<div id="cross-level-interactions" class="section level3">
<h3>Cross-Level Interactions</h3>
<p>Up until now, we have limited our discussion of TICs to include only those that predicted the intercept. This is because when we combine level 1 TVC variables with level 2 TIC variables, we can begin generating cross level interactions. We have not yet discussed TVCs in-depth (we do so below), in growth models the most common cross-level interactions are between TICs and our time variable (here <code>age</code>). As such, we will introuce these effects here before going on to explore TVCs in a more general way. Cross-level interactions are easier to see with the MLM, as the interaction is often not immediately apparent in SEMs. Below we will introduce a treatment TIC (<code>tx</code>) to our earlier TIC model. Here we will switch our TIC of interest to be the variable <code>abuse</code> for…reasons (it is a better demonstration). We will first only predict the intercept as we did previously and then we will fit a cross-level interaction model.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="05-covariates.html#cb180-1" aria-hidden="true" tabindex="-1"></a>tic.mlm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(fmin <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> abuse <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> age <span class="sc">|</span> id),</span>
<span id="cb180-2"><a href="05-covariates.html#cb180-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.action =</span> na.omit,</span>
<span id="cb180-3"><a href="05-covariates.html#cb180-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">REML =</span> <span class="cn">TRUE</span>,</span>
<span id="cb180-4"><a href="05-covariates.html#cb180-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> adversity.long,</span>
<span id="cb180-5"><a href="05-covariates.html#cb180-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>,</span>
<span id="cb180-6"><a href="05-covariates.html#cb180-6" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>)))</span>
<span id="cb180-7"><a href="05-covariates.html#cb180-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-8"><a href="05-covariates.html#cb180-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tic.mlm, <span class="at">correlation =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [&#39;lmerModLmerTest&#39;]
## Formula: fmin ~ 1 + age + abuse + (1 + age | id)
##    Data: adversity.long
## Control: lmerControl(optimizer = &quot;bobyqa&quot;, optCtrl = list(maxfun = 2e+05))
## 
## REML criterion at convergence: 3557.6
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.3459 -0.5333 -0.1760  0.4587  3.7771 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr 
##  id       (Intercept) 0.34928  0.5910        
##           age         0.01093  0.1046   -0.35
##  Residual             0.62065  0.7878        
## Number of obs: 1240, groups:  id, 398
## 
## Fixed effects:
##              Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)  -0.18075    0.08801 320.87068  -2.054 0.040824 *  
## age           0.05129    0.01200 290.29406   4.273 2.62e-05 ***
## abuse        -0.06501    0.01728 387.90442  -3.763 0.000194 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>When we add <code>abuse</code> as a predictor, we are really only estimating intercept differences across levels of experience of abuse (there is an negative effect here). If we want to know whether individuals with different experiences of abuse differ in their slopes, we need to explicitly create an interaction variable (<code>age:abuse</code>).</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="05-covariates.html#cb182-1" aria-hidden="true" tabindex="-1"></a>cross.mlm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(fmin <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> abuse <span class="sc">+</span> age<span class="sc">:</span>abuse <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> age <span class="sc">|</span> id),</span>
<span id="cb182-2"><a href="05-covariates.html#cb182-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">na.action =</span> na.omit,</span>
<span id="cb182-3"><a href="05-covariates.html#cb182-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">REML =</span> <span class="cn">TRUE</span>,</span>
<span id="cb182-4"><a href="05-covariates.html#cb182-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> adversity.long,</span>
<span id="cb182-5"><a href="05-covariates.html#cb182-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>,</span>
<span id="cb182-6"><a href="05-covariates.html#cb182-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>)))</span>
<span id="cb182-7"><a href="05-covariates.html#cb182-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-8"><a href="05-covariates.html#cb182-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cross.mlm, <span class="at">correlation =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [&#39;lmerModLmerTest&#39;]
## Formula: fmin ~ 1 + age + abuse + age:abuse + (1 + age | id)
##    Data: adversity.long
## Control: lmerControl(optimizer = &quot;bobyqa&quot;, optCtrl = list(maxfun = 2e+05))
## 
## REML criterion at convergence: 3562.1
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.3630 -0.5303 -0.1670  0.4595  3.6994 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr 
##  id       (Intercept) 0.303868 0.55124       
##           age         0.009976 0.09988  -0.27
##  Residual             0.622593 0.78905       
## Number of obs: 1240, groups:  id, 398
## 
## Fixed effects:
##               Estimate Std. Error         df t value Pr(&gt;|t|)    
## (Intercept)  -0.180119   0.087311 316.426367  -2.063   0.0399 *  
## age           0.051237   0.011889 284.132355   4.309 2.26e-05 ***
## abuse        -0.004256   0.033426 308.486988  -0.127   0.8988    
## age:abuse    -0.009689   0.004569 276.107835  -2.121   0.0348 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The interaction nature of the second effect is immediately apparent given the construction of the syntax. We can even plot these effects using the <code>interact_plot()</code> function from the <strong>interactions</strong> package.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="05-covariates.html#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(<span class="at">model =</span> cross.mlm, </span>
<span id="cb184-2"><a href="05-covariates.html#cb184-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">pred =</span> <span class="st">&quot;age&quot;</span>,  </span>
<span id="cb184-3"><a href="05-covariates.html#cb184-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">modx =</span> <span class="st">&quot;abuse&quot;</span>, </span>
<span id="cb184-4"><a href="05-covariates.html#cb184-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">interval =</span> <span class="cn">TRUE</span>, </span>
<span id="cb184-5"><a href="05-covariates.html#cb184-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">int.type =</span> <span class="st">&quot;confidence&quot;</span>, </span>
<span id="cb184-6"><a href="05-covariates.html#cb184-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">x.label =</span> <span class="st">&quot;Age&quot;</span>,</span>
<span id="cb184-7"><a href="05-covariates.html#cb184-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">y.label =</span> <span class="st">&quot;Forcept Minor White Matter FA&quot;</span>)</span></code></pre></div>
<p><img src="longitudinal_primer_files/figure-html/crosslevel%2003-1.png" width="672" /></p>
<p>Here we can see some (non-significant) level differences between those who experience low levels of abuse (<span class="math inline">\(-1\)</span> SD) versus those who experienced mean or high (<span class="math inline">\(+1\)</span> SD) levels of abuse. However, there are significant slope differences (i.e., the interaction term is significant), such that those who experience lower levels of early childhood abuse also show faster gains in white matter FA. For some additional examples that have both intercept and slope differences, you can consult the help tools for the <strong>interactions</strong> package <a href="https://interactions.jacob-long.com/reference/interact_plot.html">here</a>.</p>
<p>In an SEM approach, seeing <em>how</em> to specify a cross-level interaction is easier, although the interaction nature is somewhat more obscured. Implementing the model is trivial, we simply predict both the intercept and slope with our TIC. We again retain the TVC effects for consistency, even though they are not strictly necessary to demonstrate a cross-level interaction.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="05-covariates.html#cb185-1" aria-hidden="true" tabindex="-1"></a>cross.lcm <span class="ot">&lt;-</span> <span class="st">&quot;int =~ 1*ef1 + 1*ef2 + 1*ef3 + 1*ef4</span></span>
<span id="cb185-2"><a href="05-covariates.html#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="st">              slp =~ 0*ef1 + 1*ef2 + 2*ef3 + 3*ef4</span></span>
<span id="cb185-3"><a href="05-covariates.html#cb185-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-4"><a href="05-covariates.html#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="st">              ef1 ~ c*dlpfc1</span></span>
<span id="cb185-5"><a href="05-covariates.html#cb185-5" aria-hidden="true" tabindex="-1"></a><span class="st">              ef2 ~ c*dlpfc2</span></span>
<span id="cb185-6"><a href="05-covariates.html#cb185-6" aria-hidden="true" tabindex="-1"></a><span class="st">              ef3 ~ c*dlpfc3</span></span>
<span id="cb185-7"><a href="05-covariates.html#cb185-7" aria-hidden="true" tabindex="-1"></a><span class="st">              ef4 ~ dlpfc4</span></span>
<span id="cb185-8"><a href="05-covariates.html#cb185-8" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb185-9"><a href="05-covariates.html#cb185-9" aria-hidden="true" tabindex="-1"></a><span class="st">              int ~ tx</span></span>
<span id="cb185-10"><a href="05-covariates.html#cb185-10" aria-hidden="true" tabindex="-1"></a><span class="st">              slp ~ tx&quot;</span></span>
<span id="cb185-11"><a href="05-covariates.html#cb185-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-12"><a href="05-covariates.html#cb185-12" aria-hidden="true" tabindex="-1"></a>cross.lcm.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(cross.lcm,</span>
<span id="cb185-13"><a href="05-covariates.html#cb185-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> executive.function,</span>
<span id="cb185-14"><a href="05-covariates.html#cb185-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb185-15"><a href="05-covariates.html#cb185-15" aria-hidden="true" tabindex="-1"></a>                        <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb185-16"><a href="05-covariates.html#cb185-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-17"><a href="05-covariates.html#cb185-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cross.lcm.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>, </span>
<span id="cb185-18"><a href="05-covariates.html#cb185-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">FALSE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 33 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        15
##   Number of equality constraints                     2
## 
##                                                   Used       Total
##   Number of observations                           296         342
##   Number of missing patterns                         7            
## 
## Model Test User Model:
##                                                       
##   Test statistic                                18.561
##   Degrees of freedom                                21
##   P-value (Chi-square)                           0.613
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int =~                                              
##     ef1               1.000                           
##     ef2               1.000                           
##     ef3               1.000                           
##     ef4               1.000                           
##   slp =~                                              
##     ef1               0.000                           
##     ef2               1.000                           
##     ef3               2.000                           
##     ef4               3.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   ef1 ~                                               
##     dlpfc1     (c)    0.043    0.023    1.918    0.055
##   ef2 ~                                               
##     dlpfc2     (c)    0.043    0.023    1.918    0.055
##   ef3 ~                                               
##     dlpfc3     (c)    0.043    0.023    1.918    0.055
##   ef4 ~                                               
##     dlpfc4            0.095    0.030    3.132    0.002
##   int ~                                               
##     tx                0.112    0.086    1.294    0.196
##   slp ~                                               
##     tx                0.000    0.030    0.008    0.994
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##  .int ~~                                              
##    .slp              -0.004    0.015   -0.269    0.788
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ef1               0.000                           
##    .ef2               0.000                           
##    .ef3               0.000                           
##    .ef4               0.000                           
##    .int               2.390    0.063   37.666    0.000
##    .slp               0.033    0.023    1.434    0.151
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ef1               0.219    0.036    6.040    0.000
##    .ef2               0.242    0.026    9.125    0.000
##    .ef3               0.266    0.029    9.102    0.000
##    .ef4               0.137    0.036    3.852    0.000
##    .int               0.389    0.049    7.990    0.000
##    .slp               0.026    0.008    3.290    0.001</code></pre>
<p>Unlike with the MLM, there is no product variable that we enter explicitly into the model. However, we can think about how the slope factor links the TIC and the individual repeated measures. The factor loadings are increasing integers and so the effect of the TIC on each successive repeated measure gets moderated by the numerical value of the factor loading. This serves the same function as an interaction for the SEM approaches.</p>
</div>
<div id="time-varying-covariates" class="section level3">
<h3>Time Varying Covariates</h3>
<p>While TICs can provide important insights into what factors might contribute to individual differences in the growth trajectories, they fundamentally represent cross-sectional regressions of the latent factors on a set of exogenous variables. However, if we want to test the effects of variables that themselves change over time, we can instead move the TVC model. While TICs predict the growth components (and therefore the repeated measures <em>indirectly</em>; hence cross-level interactions), a TVC directly predicts the individual repeated observations. In this section, we will return to our <code>executive.function</code> dataset. Here we can model the impact of DLPFC activation on executive function scores. As with the TIC model, we will first consider the MLM specification of this approach.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="05-covariates.html#cb187-1" aria-hidden="true" tabindex="-1"></a>executive.function.long <span class="ot">&lt;-</span> executive.function <span class="sc">%&gt;%</span> </span>
<span id="cb187-2"><a href="05-covariates.html#cb187-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="fu">c</span>(<span class="st">&quot;dlpfc&quot;</span>,<span class="st">&quot;ef&quot;</span>,<span class="st">&quot;age&quot;</span>)), </span>
<span id="cb187-3"><a href="05-covariates.html#cb187-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;.value&quot;</span>, <span class="st">&quot;wave&quot;</span>), </span>
<span id="cb187-4"><a href="05-covariates.html#cb187-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_pattern =</span> <span class="st">&quot;(.+)(.)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb187-5"><a href="05-covariates.html#cb187-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">wave =</span> <span class="fu">as.numeric</span>(wave) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb187-6"><a href="05-covariates.html#cb187-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">age =</span> age <span class="sc">-</span> <span class="fu">min</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb187-7"><a href="05-covariates.html#cb187-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-8"><a href="05-covariates.html#cb187-8" aria-hidden="true" tabindex="-1"></a>tvc.mlm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(ef <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> dlpfc <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> age <span class="sc">|</span> id),</span>
<span id="cb187-9"><a href="05-covariates.html#cb187-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">na.action =</span> na.omit,</span>
<span id="cb187-10"><a href="05-covariates.html#cb187-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">REML =</span> <span class="cn">TRUE</span>,</span>
<span id="cb187-11"><a href="05-covariates.html#cb187-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> executive.function.long,</span>
<span id="cb187-12"><a href="05-covariates.html#cb187-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>,</span>
<span id="cb187-13"><a href="05-covariates.html#cb187-13" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>)))</span>
<span id="cb187-14"><a href="05-covariates.html#cb187-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-15"><a href="05-covariates.html#cb187-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tvc.mlm, <span class="at">correlation =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [&#39;lmerModLmerTest&#39;]
## Formula: ef ~ 1 + age + dlpfc + (1 + age | id)
##    Data: executive.function.long
## Control: lmerControl(optimizer = &quot;bobyqa&quot;, optCtrl = list(maxfun = 2e+05))
## 
## REML criterion at convergence: 2550
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.2978 -0.4809  0.0377  0.5297  3.1320 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr 
##  id       (Intercept) 0.42998  0.6557        
##           age         0.01877  0.1370   -0.10
##  Residual             0.23913  0.4890        
## Number of obs: 1241, groups:  id, 342
## 
## Fixed effects:
##              Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept) 2.371e+00  4.505e-02 3.626e+02  52.623  &lt; 2e-16 ***
## age         4.610e-02  1.516e-02 2.951e+02   3.041  0.00257 ** 
## dlpfc       5.633e-02  2.062e-02 1.197e+03   2.732  0.00638 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>We know have a variable that changes <em>within</em> (i.e., across time) as well as <em>between</em> individuals. Here we have actually somewhat blurred that line but we will talk about how to separate these within- and between-person effects towards the end of this chapter. However, for now we can see that there is a positive effect where more DLPFC activation predicts higher executive function scores. Here this is a purely fixed effect meaning that it holds across all individuals. As with the effect of <code>age</code>; however, we can introduce a random effect of the TVC as well but including it in the random effects structure. This addition allows for the possibility that increasing DLPFC activation has <em>differential</em> effects within different individuals.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="05-covariates.html#cb189-1" aria-hidden="true" tabindex="-1"></a>rtvc.mlm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(ef <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> dlpfc <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> dlpfc <span class="sc">|</span> id),</span>
<span id="cb189-2"><a href="05-covariates.html#cb189-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">na.action =</span> na.omit,</span>
<span id="cb189-3"><a href="05-covariates.html#cb189-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">REML =</span> <span class="cn">TRUE</span>,</span>
<span id="cb189-4"><a href="05-covariates.html#cb189-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> executive.function.long,</span>
<span id="cb189-5"><a href="05-covariates.html#cb189-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>,</span>
<span id="cb189-6"><a href="05-covariates.html#cb189-6" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>)))</span>
<span id="cb189-7"><a href="05-covariates.html#cb189-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-8"><a href="05-covariates.html#cb189-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rtvc.mlm, <span class="at">correlation =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [&#39;lmerModLmerTest&#39;]
## Formula: ef ~ 1 + age + dlpfc + (1 + age + dlpfc | id)
##    Data: executive.function.long
## Control: lmerControl(optimizer = &quot;bobyqa&quot;, optCtrl = list(maxfun = 2e+05))
## 
## REML criterion at convergence: 2547.9
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.2787 -0.4949  0.0408  0.5271  3.1584 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr       
##  id       (Intercept) 0.443935 0.66628             
##           age         0.017585 0.13261  -0.13      
##           dlpfc       0.002587 0.05086  -0.41  0.96
##  Residual             0.237147 0.48698             
## Number of obs: 1241, groups:  id, 342
## 
## Fixed effects:
##              Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)   2.36832    0.04568 307.54702  51.842  &lt; 2e-16 ***
## age           0.04646    0.01498 296.52049   3.102  0.00211 ** 
## dlpfc         0.05560    0.02092 714.79021   2.658  0.00803 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## optimizer (bobyqa) convergence code: 0 (OK)
## boundary (singular) fit: see ?isSingular</code></pre>
<p>Here we’ve added <span class="math inline">\(3\)</span> additional elements in our random effects covariance matrix, one additional variance, and two additional covariances with the effects we had in the prior model. We can see that the correlation between the random slope (<code>age</code>) and DLPFC activation (<code>dlpfc</code>) is quite high. This can lead to estimation issues if this correlation gets too high, and generally reflects redundancy among the random effects.</p>
<p>While the model above already gives us the effect of DLPFC on executive funciton scores above and beyond the growth trajectory, the effects are all contemporaneous. That is, predicting executive function at a given time with DLPFC activation from that same time. A more interesting model is one in which we used activation from one time point to predict executive function at a <em>later</em> time point. While relatively rare, these lagged-effect models really represent a more exciting use of the trouble we went to in order to collect these variables over time. Because of the long format used in MLM, including lagged effects necessitates the creation of a new DLFPC variable with values offset one time point. Fortunately <strong>dplyr</strong> provides a convenient function to accomplish this data management step. It is; however, important to remember to group by <code>id</code> before creating this new variable so the last value of <code>dlpfc</code> for one person does not shift to the next person’s data rows. In this model, we will drop the random effect of <code>dlpfc</code> for simplicity (and it’s redundancy in the prior model).</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="05-covariates.html#cb191-1" aria-hidden="true" tabindex="-1"></a>executive.function.long <span class="ot">&lt;-</span> executive.function.long <span class="sc">%&gt;%</span> </span>
<span id="cb191-2"><a href="05-covariates.html#cb191-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb191-3"><a href="05-covariates.html#cb191-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dlpfc.lag =</span> dplyr<span class="sc">::</span><span class="fu">lag</span>(dlpfc, <span class="dv">1</span>))</span>
<span id="cb191-4"><a href="05-covariates.html#cb191-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-5"><a href="05-covariates.html#cb191-5" aria-hidden="true" tabindex="-1"></a>lag.tvc.mlm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(ef <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> dlpfc <span class="sc">+</span> dlpfc.lag <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> age <span class="sc">|</span> id),</span>
<span id="cb191-6"><a href="05-covariates.html#cb191-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">na.action =</span> na.omit,</span>
<span id="cb191-7"><a href="05-covariates.html#cb191-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">REML =</span> <span class="cn">TRUE</span>,</span>
<span id="cb191-8"><a href="05-covariates.html#cb191-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> executive.function.long,</span>
<span id="cb191-9"><a href="05-covariates.html#cb191-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>,</span>
<span id="cb191-10"><a href="05-covariates.html#cb191-10" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>)))</span>
<span id="cb191-11"><a href="05-covariates.html#cb191-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-12"><a href="05-covariates.html#cb191-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lag.tvc.mlm, <span class="at">correlation =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [&#39;lmerModLmerTest&#39;]
## Formula: ef ~ 1 + age + dlpfc + dlpfc.lag + (1 + age | id)
##    Data: executive.function.long
## Control: lmerControl(optimizer = &quot;bobyqa&quot;, optCtrl = list(maxfun = 2e+05))
## 
## REML criterion at convergence: 1888.8
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.2342 -0.5072  0.0392  0.5511  3.0448 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr
##  id       (Intercept) 0.435953 0.66027      
##           age         0.001306 0.03614  0.39
##  Residual             0.242442 0.49238      
## Number of obs: 892, groups:  id, 330
## 
## Fixed effects:
##              Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)   2.31372    0.06229 323.33710  37.142  &lt; 2e-16 ***
## age           0.06044    0.02116 281.02897   2.856  0.00461 ** 
## dlpfc         0.07326    0.02378 814.70968   3.081  0.00213 ** 
## dlpfc.lag     0.04651    0.02455 823.26058   1.895  0.05850 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Here the effect of the lagged DLPFC variable is non-significant (arbitrary thresholds are arbitrary but live by <span class="math inline">\(p &lt; .05\)</span>, die by <span class="math inline">\(p &lt; .05\)</span>; just be consistent). However, one concerning thing about the lagged MLM model is that we have a reduced sample size compared to the contemporaneous model (contemporaneous: N obs = <span class="math inline">\(1241\)</span> &amp; N <code>id</code> = <span class="math inline">\(342\)</span>; lagged: N obs = <span class="math inline">\(892\)</span> &amp; N <code>id</code> = <span class="math inline">\(330\)</span>). This loss of information is not trivial and comes from two sources. It is helpful to visualize the data frame, which we have done below.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="05-covariates.html#cb193-1" aria-hidden="true" tabindex="-1"></a>executive.function.long <span class="sc">%&gt;%</span> <span class="fu">filter</span>(id <span class="sc">&lt;=</span> <span class="dv">15</span> <span class="sc">&amp;</span> id <span class="sc">&gt;=</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb193-2"><a href="05-covariates.html#cb193-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">label =</span> <span class="cn">NA</span>,</span>
<span id="cb193-3"><a href="05-covariates.html#cb193-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">format =</span> <span class="st">&quot;html&quot;</span>,</span>
<span id="cb193-4"><a href="05-covariates.html#cb193-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb193-5"><a href="05-covariates.html#cb193-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">booktabs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb193-6"><a href="05-covariates.html#cb193-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">escape =</span> <span class="cn">FALSE</span>,</span>
<span id="cb193-7"><a href="05-covariates.html#cb193-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">&quot;**Executive Function Data with Lagged Variable**&quot;</span>,</span>
<span id="cb193-8"><a href="05-covariates.html#cb193-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="st">&quot;c&quot;</span>,</span>
<span id="cb193-9"><a href="05-covariates.html#cb193-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb193-10"><a href="05-covariates.html#cb193-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="at">row =</span> <span class="dv">0</span>, <span class="at">align =</span> <span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<table>
<caption>
<strong>Executive Function Data with Lagged Variable</strong>
</caption>
<thead>
<tr>
<th style="text-align:center;text-align: center;">
id
</th>
<th style="text-align:center;text-align: center;">
sex
</th>
<th style="text-align:center;text-align: center;">
tx
</th>
<th style="text-align:center;text-align: center;">
wave
</th>
<th style="text-align:center;text-align: center;">
dlpfc
</th>
<th style="text-align:center;text-align: center;">
ef
</th>
<th style="text-align:center;text-align: center;">
age
</th>
<th style="text-align:center;text-align: center;">
dlpfc.lag
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1.457
</td>
<td style="text-align:center;">
2.889
</td>
<td style="text-align:center;">
0.232
</td>
<td style="text-align:center;">
NA
</td>
</tr>
<tr>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1.129
</td>
<td style="text-align:center;">
1.806
</td>
<td style="text-align:center;">
1.331
</td>
<td style="text-align:center;">
1.457
</td>
</tr>
<tr>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
1.785
</td>
<td style="text-align:center;">
2.889
</td>
<td style="text-align:center;">
2.280
</td>
<td style="text-align:center;">
1.129
</td>
</tr>
<tr>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
0.472
</td>
<td style="text-align:center;">
2.889
</td>
<td style="text-align:center;">
3.280
</td>
<td style="text-align:center;">
1.785
</td>
</tr>
<tr>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.472
</td>
<td style="text-align:center;">
2.889
</td>
<td style="text-align:center;">
0.152
</td>
<td style="text-align:center;">
NA
</td>
</tr>
<tr>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0.472
</td>
<td style="text-align:center;">
2.889
</td>
<td style="text-align:center;">
1.278
</td>
<td style="text-align:center;">
0.472
</td>
</tr>
<tr>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
0.472
</td>
<td style="text-align:center;">
1.806
</td>
<td style="text-align:center;">
2.161
</td>
<td style="text-align:center;">
0.472
</td>
</tr>
<tr>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
1.129
</td>
<td style="text-align:center;">
2.889
</td>
<td style="text-align:center;">
3.290
</td>
<td style="text-align:center;">
0.472
</td>
</tr>
<tr>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.472
</td>
<td style="text-align:center;">
0.361
</td>
<td style="text-align:center;">
0.248
</td>
<td style="text-align:center;">
NA
</td>
</tr>
<tr>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
-0.512
</td>
<td style="text-align:center;">
2.889
</td>
<td style="text-align:center;">
1.101
</td>
<td style="text-align:center;">
0.472
</td>
</tr>
<tr>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
-0.840
</td>
<td style="text-align:center;">
2.167
</td>
<td style="text-align:center;">
2.408
</td>
<td style="text-align:center;">
-0.512
</td>
</tr>
<tr>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
-0.184
</td>
<td style="text-align:center;">
1.806
</td>
<td style="text-align:center;">
3.027
</td>
<td style="text-align:center;">
-0.840
</td>
</tr>
<tr>
<td style="text-align:center;">
13
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.144
</td>
<td style="text-align:center;">
3.250
</td>
<td style="text-align:center;">
0.335
</td>
<td style="text-align:center;">
NA
</td>
</tr>
<tr>
<td style="text-align:center;">
13
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
-0.840
</td>
<td style="text-align:center;">
2.167
</td>
<td style="text-align:center;">
1.261
</td>
<td style="text-align:center;">
0.144
</td>
</tr>
<tr>
<td style="text-align:center;">
13
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
1.444
</td>
<td style="text-align:center;">
2.225
</td>
<td style="text-align:center;">
-0.840
</td>
</tr>
<tr>
<td style="text-align:center;">
13
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
1.129
</td>
<td style="text-align:center;">
2.167
</td>
<td style="text-align:center;">
3.182
</td>
<td style="text-align:center;">
NA
</td>
</tr>
<tr>
<td style="text-align:center;">
14
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1.129
</td>
<td style="text-align:center;">
1.806
</td>
<td style="text-align:center;">
0.533
</td>
<td style="text-align:center;">
NA
</td>
</tr>
<tr>
<td style="text-align:center;">
14
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1.457
</td>
<td style="text-align:center;">
1.806
</td>
<td style="text-align:center;">
1.338
</td>
<td style="text-align:center;">
1.129
</td>
</tr>
<tr>
<td style="text-align:center;">
14
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
2.114
</td>
<td style="text-align:center;">
2.167
</td>
<td style="text-align:center;">
2.088
</td>
<td style="text-align:center;">
1.457
</td>
</tr>
<tr>
<td style="text-align:center;">
14
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
1.457
</td>
<td style="text-align:center;">
2.167
</td>
<td style="text-align:center;">
3.232
</td>
<td style="text-align:center;">
2.114
</td>
</tr>
<tr>
<td style="text-align:center;">
15
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1.129
</td>
<td style="text-align:center;">
2.528
</td>
<td style="text-align:center;">
0.250
</td>
<td style="text-align:center;">
NA
</td>
</tr>
<tr>
<td style="text-align:center;">
15
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1.457
</td>
<td style="text-align:center;">
2.528
</td>
<td style="text-align:center;">
1.003
</td>
<td style="text-align:center;">
1.129
</td>
</tr>
<tr>
<td style="text-align:center;">
15
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
0.144
</td>
<td style="text-align:center;">
2.889
</td>
<td style="text-align:center;">
2.111
</td>
<td style="text-align:center;">
1.457
</td>
</tr>
<tr>
<td style="text-align:center;">
15
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
-0.184
</td>
<td style="text-align:center;">
1.806
</td>
<td style="text-align:center;">
3.375
</td>
<td style="text-align:center;">
0.144
</td>
</tr>
</tbody>
</table>
<p>Note that for every person in our data, we have <code>NA</code> values for the first observation of the <code>dlpfc.lag</code> variable. This is because we could not observe DLPFC activation the time point <em>before</em> we began the study. Because of the conditional likelihood approach we discussed previous as the only option in the MLM, all of these first observation rows are removed from the model. If that wasn’t enough of a bummer, any missing data in the contemporaneous DLPFC variable are shifted to be missing in the lagged version for the <em>next</em> time point, so we lose both time points when we include the contemporaneous and lagged effects (which we should pretty much always do to properly specify the model, so don’t be tempted to only include the lagged effect). We can see this effect for <code>id</code> <span class="math inline">\(13\)</span> where DLPFC is missing at time <span class="math inline">\(3\)</span> and so the lagged variable is missing at time <span class="math inline">\(4\)</span>. One potential solution proposed by <a href="">Dan McNeish</a> is that we replace the <code>NA</code> values for the first observation with a constant, <span class="math inline">\(0\)</span>, so that we don’t lose those time points but they also do not introduce spurious effects. However, we do not want to remove <code>NA</code> values that arise due to true missing data.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="05-covariates.html#cb194-1" aria-hidden="true" tabindex="-1"></a>executive.function.long[executive.function.long<span class="sc">$</span>wave <span class="sc">==</span> <span class="dv">0</span>, <span class="st">&quot;dlpfc.lag&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb194-2"><a href="05-covariates.html#cb194-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3"><a href="05-covariates.html#cb194-3" aria-hidden="true" tabindex="-1"></a>lag.tvc.mlm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(ef <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> dlpfc <span class="sc">+</span> dlpfc.lag <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> age <span class="sc">|</span> id),</span>
<span id="cb194-4"><a href="05-covariates.html#cb194-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">na.action =</span> na.omit,</span>
<span id="cb194-5"><a href="05-covariates.html#cb194-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">REML =</span> <span class="cn">TRUE</span>,</span>
<span id="cb194-6"><a href="05-covariates.html#cb194-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> executive.function.long,</span>
<span id="cb194-7"><a href="05-covariates.html#cb194-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>,</span>
<span id="cb194-8"><a href="05-covariates.html#cb194-8" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>)))</span>
<span id="cb194-9"><a href="05-covariates.html#cb194-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-10"><a href="05-covariates.html#cb194-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lag.tvc.mlm, <span class="at">correlation =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [&#39;lmerModLmerTest&#39;]
## Formula: ef ~ 1 + age + dlpfc + dlpfc.lag + (1 + age | id)
##    Data: executive.function.long
## Control: lmerControl(optimizer = &quot;bobyqa&quot;, optCtrl = list(maxfun = 2e+05))
## 
## REML criterion at convergence: 2523.4
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.3151 -0.4776  0.0375  0.5303  3.0969 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr 
##  id       (Intercept) 0.42664  0.6532        
##           age         0.01684  0.1298   -0.07
##  Residual             0.24168  0.4916        
## Number of obs: 1224, groups:  id, 342
## 
## Fixed effects:
##              Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept) 2.367e+00  4.507e-02 3.628e+02  52.516  &lt; 2e-16 ***
## age         3.948e-02  1.620e-02 3.397e+02   2.437  0.01531 *  
## dlpfc       5.807e-02  2.085e-02 1.179e+03   2.785  0.00544 ** 
## dlpfc.lag   4.262e-02  2.186e-02 9.588e+02   1.950  0.05152 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>As we can see, the number of observations and <code>id</code> values is much more similar to the contemporaneous effects model. The lag effect is still not significant, but them’s the breaks. Lag effects are often difficult to detect in these kind of longitudinal models due to the relatively long intervals between observations. Relationships simply decay over time and therefore observations spaced out in year or biennial schedules often don’t result in unique lagged effects.</p>
<p>We can also briefly return to the idea of cross-level interactions here. While in the growth model context, we are primarily concerned with cross-level interactions with whatever metric of time we are utilizing in the model, we are not limited to this kind of effect and can moderate the effect of any level 1 TVC with a level 2 TIC. Below might be an example with <code>tx</code> and <code>dlpfc</code>.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="05-covariates.html#cb196-1" aria-hidden="true" tabindex="-1"></a>cross.mlm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(ef <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> dlpfc <span class="sc">+</span> tx <span class="sc">+</span> dlpfc<span class="sc">:</span>tx <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> age <span class="sc">|</span> id),</span>
<span id="cb196-2"><a href="05-covariates.html#cb196-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">na.action =</span> na.omit,</span>
<span id="cb196-3"><a href="05-covariates.html#cb196-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">REML =</span> <span class="cn">TRUE</span>,</span>
<span id="cb196-4"><a href="05-covariates.html#cb196-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> executive.function.long,</span>
<span id="cb196-5"><a href="05-covariates.html#cb196-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>,</span>
<span id="cb196-6"><a href="05-covariates.html#cb196-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>)))</span>
<span id="cb196-7"><a href="05-covariates.html#cb196-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-8"><a href="05-covariates.html#cb196-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cross.mlm, <span class="at">correlation =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [&#39;lmerModLmerTest&#39;]
## Formula: ef ~ 1 + age + dlpfc + tx + dlpfc:tx + (1 + age | id)
##    Data: executive.function.long
## Control: lmerControl(optimizer = &quot;bobyqa&quot;, optCtrl = list(maxfun = 2e+05))
## 
## REML criterion at convergence: 2554.8
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.3128 -0.4805  0.0457  0.5191  3.1417 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr 
##  id       (Intercept) 0.42661  0.6532        
##           age         0.01864  0.1365   -0.10
##  Residual             0.23955  0.4894        
## Number of obs: 1241, groups:  id, 342
## 
## Fixed effects:
##              Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept) 2.306e+00  6.180e-02 4.211e+02  37.321   &lt;2e-16 ***
## age         4.603e-02  1.516e-02 2.952e+02   3.037   0.0026 ** 
## dlpfc       5.017e-02  2.990e-02 1.207e+03   1.678   0.0937 .  
## tx          1.262e-01  8.229e-02 3.981e+02   1.533   0.1260    
## dlpfc:tx    1.256e-02  4.080e-02 1.189e+03   0.308   0.7583    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="05-covariates.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(<span class="at">model =</span> cross.mlm, </span>
<span id="cb198-2"><a href="05-covariates.html#cb198-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">pred =</span> <span class="st">&quot;dlpfc&quot;</span>,  </span>
<span id="cb198-3"><a href="05-covariates.html#cb198-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">modx =</span> <span class="st">&quot;tx&quot;</span>, </span>
<span id="cb198-4"><a href="05-covariates.html#cb198-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">interval =</span> <span class="cn">TRUE</span>, </span>
<span id="cb198-5"><a href="05-covariates.html#cb198-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">int.type =</span> <span class="st">&quot;confidence&quot;</span>, </span>
<span id="cb198-6"><a href="05-covariates.html#cb198-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">x.label =</span> <span class="st">&quot;DLPFC Activation&quot;</span>,</span>
<span id="cb198-7"><a href="05-covariates.html#cb198-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">y.label =</span> <span class="st">&quot;Executive Function&quot;</span>, </span>
<span id="cb198-8"><a href="05-covariates.html#cb198-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">modx.labels =</span> <span class="fu">c</span>(<span class="st">&quot;Treatment&quot;</span>, <span class="st">&quot;Control&quot;</span>))</span></code></pre></div>
<p><img src="longitudinal_primer_files/figure-html/crosslevel%2005-1.png" width="672" /></p>
<p>The effects here are not significant, but it is a good principle to keep in mind, especially if fitting these models in a non-growth context.</p>
<p>If we turn to the SEMs, we can re-create many of the models we saw with the MLM (although not exclusively in R), but the SEM does allow for some additional flexibility that may be attractive. Because each measure gets its own column at different time points (i.e., wide format), we need to specify each of the contemporaneous (or lagged) effects individually. However, we will not need to explicitly create a lagged version of the variable. We can see the contemporaneous effect model below. Note that each time-specific regression of <code>ef</code> on <code>dlpfc</code> requires its own line of syntax.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="05-covariates.html#cb199-1" aria-hidden="true" tabindex="-1"></a>tvc.lcm <span class="ot">&lt;-</span> <span class="st">&quot;int =~ 1*ef1 + 1*ef2 + 1*ef3 + 1*ef4</span></span>
<span id="cb199-2"><a href="05-covariates.html#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="st">            slp =~ 0*ef1 + 1*ef2 + 2*ef3 + 3*ef4</span></span>
<span id="cb199-3"><a href="05-covariates.html#cb199-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-4"><a href="05-covariates.html#cb199-4" aria-hidden="true" tabindex="-1"></a><span class="st">            ef1 ~ dlpfc1</span></span>
<span id="cb199-5"><a href="05-covariates.html#cb199-5" aria-hidden="true" tabindex="-1"></a><span class="st">            ef2 ~ dlpfc2</span></span>
<span id="cb199-6"><a href="05-covariates.html#cb199-6" aria-hidden="true" tabindex="-1"></a><span class="st">            ef3 ~ dlpfc3</span></span>
<span id="cb199-7"><a href="05-covariates.html#cb199-7" aria-hidden="true" tabindex="-1"></a><span class="st">            ef4 ~ dlpfc4&quot;</span></span>
<span id="cb199-8"><a href="05-covariates.html#cb199-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-9"><a href="05-covariates.html#cb199-9" aria-hidden="true" tabindex="-1"></a>tvc.lcm.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(tvc.lcm, </span>
<span id="cb199-10"><a href="05-covariates.html#cb199-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> executive.function,</span>
<span id="cb199-11"><a href="05-covariates.html#cb199-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb199-12"><a href="05-covariates.html#cb199-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb199-13"><a href="05-covariates.html#cb199-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-14"><a href="05-covariates.html#cb199-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tvc.lcm.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>, </span>
<span id="cb199-15"><a href="05-covariates.html#cb199-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">FALSE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 37 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        13
## 
##                                                   Used       Total
##   Number of observations                           296         342
##   Number of missing patterns                         7            
## 
## Model Test User Model:
##                                                       
##   Test statistic                                16.183
##   Degrees of freedom                                17
##   P-value (Chi-square)                           0.511
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int =~                                              
##     ef1               1.000                           
##     ef2               1.000                           
##     ef3               1.000                           
##     ef4               1.000                           
##   slp =~                                              
##     ef1               0.000                           
##     ef2               1.000                           
##     ef3               2.000                           
##     ef4               3.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   ef1 ~                                               
##     dlpfc1            0.027    0.036    0.773    0.440
##   ef2 ~                                               
##     dlpfc2            0.051    0.029    1.753    0.080
##   ef3 ~                                               
##     dlpfc3            0.044    0.031    1.450    0.147
##   ef4 ~                                               
##     dlpfc4            0.098    0.032    3.080    0.002
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int ~~                                              
##     slp              -0.003    0.015   -0.229    0.819
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ef1               0.000                           
##    .ef2               0.000                           
##    .ef3               0.000                           
##    .ef4               0.000                           
##     int               2.451    0.047   52.040    0.000
##     slp               0.030    0.019    1.603    0.109
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ef1               0.220    0.036    6.070    0.000
##    .ef2               0.241    0.026    9.119    0.000
##    .ef3               0.266    0.029    9.113    0.000
##    .ef4               0.138    0.036    3.857    0.000
##     int               0.391    0.049    8.001    0.000
##     slp               0.026    0.008    3.216    0.001</code></pre>
<p>The striking thing here, compared with the MLM results, is that we get <span class="math inline">\(4\)</span> regression coefficients for the relationship between <code>ef</code> and <code>dlpfc</code> instead of <span class="math inline">\(1\)</span>. These individual time-specific effects are one of the unique strengths of the SEM approaches, and would be essentially impossible to achieve with most MLMs (<strong>Mplus</strong> is a bit of a potential exception, but that’s because it specifies MLMs more like SEMs), since this is a weird form of nonlinear interaction between the overall TVC effect and time. However, we could also impose simpler functional forms on these regressions. The simplest is to constrain all of them to be equal. This constraint is the one imposed in the MLM, so we should get a single overall TVC effect with this approach. We can see this below.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="05-covariates.html#cb201-1" aria-hidden="true" tabindex="-1"></a>tvc.lcm <span class="ot">&lt;-</span> <span class="st">&quot;int =~ 1*ef1 + 1*ef2 + 1*ef3 + 1*ef4</span></span>
<span id="cb201-2"><a href="05-covariates.html#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="st">            slp =~ 0*ef1 + 1*ef2 + 2*ef3 + 3*ef4</span></span>
<span id="cb201-3"><a href="05-covariates.html#cb201-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-4"><a href="05-covariates.html#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="st">            ef1 ~ c*dlpfc1</span></span>
<span id="cb201-5"><a href="05-covariates.html#cb201-5" aria-hidden="true" tabindex="-1"></a><span class="st">            ef2 ~ c*dlpfc2</span></span>
<span id="cb201-6"><a href="05-covariates.html#cb201-6" aria-hidden="true" tabindex="-1"></a><span class="st">            ef3 ~ c*dlpfc3</span></span>
<span id="cb201-7"><a href="05-covariates.html#cb201-7" aria-hidden="true" tabindex="-1"></a><span class="st">            ef4 ~ c*dlpfc4&quot;</span></span>
<span id="cb201-8"><a href="05-covariates.html#cb201-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-9"><a href="05-covariates.html#cb201-9" aria-hidden="true" tabindex="-1"></a>tvc.lcm.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(tvc.lcm, </span>
<span id="cb201-10"><a href="05-covariates.html#cb201-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> executive.function,</span>
<span id="cb201-11"><a href="05-covariates.html#cb201-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb201-12"><a href="05-covariates.html#cb201-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb201-13"><a href="05-covariates.html#cb201-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-14"><a href="05-covariates.html#cb201-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tvc.lcm.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>, </span>
<span id="cb201-15"><a href="05-covariates.html#cb201-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">FALSE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 30 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        13
##   Number of equality constraints                     3
## 
##                                                   Used       Total
##   Number of observations                           296         342
##   Number of missing patterns                         7            
## 
## Model Test User Model:
##                                                       
##   Test statistic                                19.768
##   Degrees of freedom                                20
##   P-value (Chi-square)                           0.473
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int =~                                              
##     ef1               1.000                           
##     ef2               1.000                           
##     ef3               1.000                           
##     ef4               1.000                           
##   slp =~                                              
##     ef1               0.000                           
##     ef2               1.000                           
##     ef3               2.000                           
##     ef4               3.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   ef1 ~                                               
##     dlpfc1     (c)    0.056    0.021    2.634    0.008
##   ef2 ~                                               
##     dlpfc2     (c)    0.056    0.021    2.634    0.008
##   ef3 ~                                               
##     dlpfc3     (c)    0.056    0.021    2.634    0.008
##   ef4 ~                                               
##     dlpfc4     (c)    0.056    0.021    2.634    0.008
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int ~~                                              
##     slp              -0.004    0.015   -0.269    0.788
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ef1               0.000                           
##    .ef2               0.000                           
##    .ef3               0.000                           
##    .ef4               0.000                           
##     int               2.429    0.045   54.225    0.000
##     slp               0.048    0.015    3.124    0.002
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ef1               0.220    0.036    6.067    0.000
##    .ef2               0.241    0.026    9.119    0.000
##    .ef3               0.266    0.029    9.091    0.000
##    .ef4               0.139    0.036    3.896    0.000
##     int               0.390    0.049    8.000    0.000
##     slp               0.027    0.008    3.308    0.001</code></pre>
<p>If we examine the TVC regressions, they are all precisely equal (it should worry us if they are not) and equivalent to the results from the MLM. It is possible through the use of nonlinear constraints to put other functional forms on these regressions. For instance, we could impose a linear constraint so that the regressions increase or decrease over time. We could also impose order constraints where we want the regressions at some time points to be larger than at others. This is where the incredible flexibility of SEM approaches comes out most strongly. The important thing to keep in mind is that this flexibility is also a great way to wander and over-fit our way off a cliff. We need good theoretical justification for our model specification choices and a greater willingness to admit when some features of our model are exploratory to avoid these pitfalls.</p>
<p>One current limitation of implementing SEM TVC models in R is in the inability to specify a random effect of the TVC (to our knowledge). This is possible in <strong>Mplus</strong> and we have included syntax for that model in the external software downloads.</p>
<p>Finally, the lagged effect model is simple to implement in SEM approaches. We simply include the earlier time point version of our TVC in the regressions for the time-specific outcomes. We won’t need to worry about inducing additional missing data because we never created a lagged version of our TVC.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="05-covariates.html#cb203-1" aria-hidden="true" tabindex="-1"></a>lag.lcm <span class="ot">&lt;-</span> <span class="st">&quot;int =~ 1*ef1 + 1*ef2 + 1*ef3 + 1*ef4</span></span>
<span id="cb203-2"><a href="05-covariates.html#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="st">            slp =~ 0*ef1 + 1*ef2 + 2*ef3 + 3*ef4</span></span>
<span id="cb203-3"><a href="05-covariates.html#cb203-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-4"><a href="05-covariates.html#cb203-4" aria-hidden="true" tabindex="-1"></a><span class="st">            ef1 ~ dlpfc1</span></span>
<span id="cb203-5"><a href="05-covariates.html#cb203-5" aria-hidden="true" tabindex="-1"></a><span class="st">            ef2 ~ dlpfc2 + dlpfc1</span></span>
<span id="cb203-6"><a href="05-covariates.html#cb203-6" aria-hidden="true" tabindex="-1"></a><span class="st">            ef3 ~ dlpfc3 + dlpfc2</span></span>
<span id="cb203-7"><a href="05-covariates.html#cb203-7" aria-hidden="true" tabindex="-1"></a><span class="st">            ef4 ~ dlpfc4 + dlpfc3&quot;</span></span>
<span id="cb203-8"><a href="05-covariates.html#cb203-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-9"><a href="05-covariates.html#cb203-9" aria-hidden="true" tabindex="-1"></a>lag.lcm.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(lag.lcm, </span>
<span id="cb203-10"><a href="05-covariates.html#cb203-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> executive.function,</span>
<span id="cb203-11"><a href="05-covariates.html#cb203-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb203-12"><a href="05-covariates.html#cb203-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb203-13"><a href="05-covariates.html#cb203-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-14"><a href="05-covariates.html#cb203-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lag.lcm.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>, </span>
<span id="cb203-15"><a href="05-covariates.html#cb203-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">FALSE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 36 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        16
## 
##                                                   Used       Total
##   Number of observations                           296         342
##   Number of missing patterns                         7            
## 
## Model Test User Model:
##                                                       
##   Test statistic                                 9.699
##   Degrees of freedom                                14
##   P-value (Chi-square)                           0.784
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int =~                                              
##     ef1               1.000                           
##     ef2               1.000                           
##     ef3               1.000                           
##     ef4               1.000                           
##   slp =~                                              
##     ef1               0.000                           
##     ef2               1.000                           
##     ef3               2.000                           
##     ef4               3.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   ef1 ~                                               
##     dlpfc1            0.045    0.039    1.154    0.248
##   ef2 ~                                               
##     dlpfc2            0.067    0.038    1.783    0.075
##     dlpfc1            0.008    0.044    0.178    0.859
##   ef3 ~                                               
##     dlpfc3            0.077    0.039    1.940    0.052
##     dlpfc2            0.014    0.037    0.376    0.707
##   ef4 ~                                               
##     dlpfc4            0.054    0.037    1.455    0.146
##     dlpfc3            0.106    0.042    2.507    0.012
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int ~~                                              
##     slp              -0.005    0.015   -0.333    0.739
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ef1               0.000                           
##    .ef2               0.000                           
##    .ef3               0.000                           
##    .ef4               0.000                           
##     int               2.442    0.048   50.832    0.000
##     slp               0.020    0.019    1.052    0.293
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ef1               0.220    0.036    6.048    0.000
##    .ef2               0.242    0.026    9.143    0.000
##    .ef3               0.265    0.029    9.131    0.000
##    .ef4               0.133    0.035    3.798    0.000
##     int               0.391    0.049    8.007    0.000
##     slp               0.026    0.008    3.245    0.001</code></pre>
<p>Finally, we could constrain the different types of pathways to be equal within type. While the flexibility of the time-specific effects can be powerful, it can also overwhelm us inferentially. What do we do with the fact that only one of our paths here (<code>ef4 ~ dlpfc3</code>) is significant? Who knows. Constraints can both narrow the number of parameters we are interpreting, but also increase the power to detect an overall effect if one exists because we aggregate over more information.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="05-covariates.html#cb205-1" aria-hidden="true" tabindex="-1"></a>lag.lcm <span class="ot">&lt;-</span> <span class="st">&quot;int =~ 1*ef1 + 1*ef2 + 1*ef3 + 1*ef4</span></span>
<span id="cb205-2"><a href="05-covariates.html#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="st">            slp =~ 0*ef1 + 1*ef2 + 2*ef3 + 3*ef4</span></span>
<span id="cb205-3"><a href="05-covariates.html#cb205-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-4"><a href="05-covariates.html#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="st">            ef1 ~ c1*dlpfc1</span></span>
<span id="cb205-5"><a href="05-covariates.html#cb205-5" aria-hidden="true" tabindex="-1"></a><span class="st">            ef2 ~ c1*dlpfc2 + c2*dlpfc1</span></span>
<span id="cb205-6"><a href="05-covariates.html#cb205-6" aria-hidden="true" tabindex="-1"></a><span class="st">            ef3 ~ c1*dlpfc3 + c2*dlpfc2</span></span>
<span id="cb205-7"><a href="05-covariates.html#cb205-7" aria-hidden="true" tabindex="-1"></a><span class="st">            ef4 ~ c1*dlpfc4 + c2*dlpfc3&quot;</span></span>
<span id="cb205-8"><a href="05-covariates.html#cb205-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-9"><a href="05-covariates.html#cb205-9" aria-hidden="true" tabindex="-1"></a>lag.lcm.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(lag.lcm, </span>
<span id="cb205-10"><a href="05-covariates.html#cb205-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> executive.function,</span>
<span id="cb205-11"><a href="05-covariates.html#cb205-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb205-12"><a href="05-covariates.html#cb205-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb205-13"><a href="05-covariates.html#cb205-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-14"><a href="05-covariates.html#cb205-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lag.lcm.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>, </span>
<span id="cb205-15"><a href="05-covariates.html#cb205-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">FALSE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 29 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        16
##   Number of equality constraints                     5
## 
##                                                   Used       Total
##   Number of observations                           296         342
##   Number of missing patterns                         7            
## 
## Model Test User Model:
##                                                       
##   Test statistic                                16.245
##   Degrees of freedom                                19
##   P-value (Chi-square)                           0.641
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int =~                                              
##     ef1               1.000                           
##     ef2               1.000                           
##     ef3               1.000                           
##     ef4               1.000                           
##   slp =~                                              
##     ef1               0.000                           
##     ef2               1.000                           
##     ef3               2.000                           
##     ef4               3.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   ef1 ~                                               
##     dlpfc1    (c1)    0.057    0.021    2.691    0.007
##   ef2 ~                                               
##     dlpfc2    (c1)    0.057    0.021    2.691    0.007
##     dlpfc1    (c2)    0.042    0.022    1.879    0.060
##   ef3 ~                                               
##     dlpfc3    (c1)    0.057    0.021    2.691    0.007
##     dlpfc2    (c2)    0.042    0.022    1.879    0.060
##   ef4 ~                                               
##     dlpfc4    (c1)    0.057    0.021    2.691    0.007
##     dlpfc3    (c2)    0.042    0.022    1.879    0.060
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int ~~                                              
##     slp              -0.004    0.015   -0.291    0.771
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ef1               0.000                           
##    .ef2               0.000                           
##    .ef3               0.000                           
##    .ef4               0.000                           
##     int               2.423    0.045   53.939    0.000
##     slp               0.038    0.016    2.381    0.017
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ef1               0.221    0.036    6.094    0.000
##    .ef2               0.243    0.027    9.135    0.000
##    .ef3               0.266    0.029    9.115    0.000
##    .ef4               0.137    0.035    3.883    0.000
##     int               0.389    0.049    7.998    0.000
##     slp               0.026    0.008    3.281    0.001</code></pre>
<p>This aggregation of course cuts both ways. Now we have no significant lagged effect (although we only had one out of three before so did we really have it to begin with?), but we do have a significant contemporaneous effect where we had no individual one before.</p>
<p>The examples we have included thus far are relatively simple, with a single TVC. Of course all of these models can be expanded to include multiple TVCs, and potentially interactions if we have the sample size to support them.</p>
</div>
<div id="multivariate-models" class="section level3">
<h3>Multivariate Models</h3>
<p>Those paying close attention (and at this point all the kudos to you) might have been a bit perturbed by the fact that in our <a href="02-canonical.html#canon">Canonical</a> chapter, we fit a growth model to the <code>dlpfc</code> variable, but here we have used it as our TVC. This is indeed of great concern and something we should always be thinking about when including a repeated measure as a TVC. The standard TVC model assumes that there are no systematic changes in the covariate across time. The values obviously change, but not systematically. Rather, the traditional TVC model is well suited for covariates that fluctuates from time point to time point. Weather over short intervals is often a canonical example in more-intensive applications, but we can think also the time of day that testing occurs as one that might be of interest for our purposes. From our earlier model fitting, we know that our <code>dlpfc</code> TVC does not meet this criteria. This is an issue because we essentially have an unmodeled age effect on the TVC, which will introduce bias into our model results.</p>
<p>The other issue is that of true exogeneity. Do we really believe that the causal effect in our model <em>only</em> runs from DLPFC activation to executive function, and that there are no reciprocal relationships over time? With something like the weather this is totally plausible; however, with our data this assumption seems unlikely to hold. As such, we might wish to treat both <code>ef</code> and <code>dlpfc</code> as outcomes in a multivariate model. This will involve some difficulty in the MLM, but will be a completely natural extension of the SEM. We will flip our usual order of considering the MLM first and demonstrate the SEM specifications so it’s easier to see where we will run into difficulty with the MLMs. We will first re-fit the TVC model we ended with earlier</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="05-covariates.html#cb207-1" aria-hidden="true" tabindex="-1"></a>tvc.lcm <span class="ot">&lt;-</span> <span class="st">&quot;int =~ 1*ef1 + 1*ef2 + 1*ef3 + 1*ef4</span></span>
<span id="cb207-2"><a href="05-covariates.html#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="st">            slp =~ 0*ef1 + 1*ef2 + 2*ef3 + 3*ef4</span></span>
<span id="cb207-3"><a href="05-covariates.html#cb207-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-4"><a href="05-covariates.html#cb207-4" aria-hidden="true" tabindex="-1"></a><span class="st">            ef1 ~ c*dlpfc1</span></span>
<span id="cb207-5"><a href="05-covariates.html#cb207-5" aria-hidden="true" tabindex="-1"></a><span class="st">            ef2 ~ c*dlpfc2</span></span>
<span id="cb207-6"><a href="05-covariates.html#cb207-6" aria-hidden="true" tabindex="-1"></a><span class="st">            ef3 ~ c*dlpfc3</span></span>
<span id="cb207-7"><a href="05-covariates.html#cb207-7" aria-hidden="true" tabindex="-1"></a><span class="st">            ef4 ~ c*dlpfc4&quot;</span></span>
<span id="cb207-8"><a href="05-covariates.html#cb207-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-9"><a href="05-covariates.html#cb207-9" aria-hidden="true" tabindex="-1"></a>tvc.lcm.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(tvc.lcm, </span>
<span id="cb207-10"><a href="05-covariates.html#cb207-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> executive.function,</span>
<span id="cb207-11"><a href="05-covariates.html#cb207-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb207-12"><a href="05-covariates.html#cb207-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb207-13"><a href="05-covariates.html#cb207-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-14"><a href="05-covariates.html#cb207-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tvc.lcm.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>, </span>
<span id="cb207-15"><a href="05-covariates.html#cb207-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">FALSE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 30 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        13
##   Number of equality constraints                     3
## 
##                                                   Used       Total
##   Number of observations                           296         342
##   Number of missing patterns                         7            
## 
## Model Test User Model:
##                                                       
##   Test statistic                                19.768
##   Degrees of freedom                                20
##   P-value (Chi-square)                           0.473
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int =~                                              
##     ef1               1.000                           
##     ef2               1.000                           
##     ef3               1.000                           
##     ef4               1.000                           
##   slp =~                                              
##     ef1               0.000                           
##     ef2               1.000                           
##     ef3               2.000                           
##     ef4               3.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   ef1 ~                                               
##     dlpfc1     (c)    0.056    0.021    2.634    0.008
##   ef2 ~                                               
##     dlpfc2     (c)    0.056    0.021    2.634    0.008
##   ef3 ~                                               
##     dlpfc3     (c)    0.056    0.021    2.634    0.008
##   ef4 ~                                               
##     dlpfc4     (c)    0.056    0.021    2.634    0.008
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int ~~                                              
##     slp              -0.004    0.015   -0.269    0.788
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ef1               0.000                           
##    .ef2               0.000                           
##    .ef3               0.000                           
##    .ef4               0.000                           
##     int               2.429    0.045   54.225    0.000
##     slp               0.048    0.015    3.124    0.002
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ef1               0.220    0.036    6.067    0.000
##    .ef2               0.241    0.026    9.119    0.000
##    .ef3               0.266    0.029    9.091    0.000
##    .ef4               0.139    0.036    3.896    0.000
##     int               0.390    0.049    8.000    0.000
##     slp               0.027    0.008    3.308    0.001</code></pre>
<p>To transform this model into a multivariate version, we need to estimate an intercept and slope for both the <code>ef</code> and the <code>dlpfc</code> variables. One thing to note is that we should be explicit about including the correlations between the growth factors within- and across-construct, as well as cross-construct, time-specific covariances between the individual repeated measures. These time-specific residuals are often necessary and help account for unmeasured common causes that might induce correlations among the repeated measures above-and-beyond the growth factors themselves. We can do all the usual things with these residual covariances, including testing equality constraints or even constraining them to zero and assess their impact on model fit through likelihood ratio tests. For now we will estimate unique relationships, as that is the default in SEM approaches.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="05-covariates.html#cb209-1" aria-hidden="true" tabindex="-1"></a>multivar.lcm <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb209-2"><a href="05-covariates.html#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="st">                 # Growth Factors for EF</span></span>
<span id="cb209-3"><a href="05-covariates.html#cb209-3" aria-hidden="true" tabindex="-1"></a><span class="st">                 int.ef =~ 1*ef1 + 1*ef2 + 1*ef3 + 1*ef4</span></span>
<span id="cb209-4"><a href="05-covariates.html#cb209-4" aria-hidden="true" tabindex="-1"></a><span class="st">                 slp.ef =~ 0*ef1 + 1*ef2 + 2*ef3 + 3*ef4</span></span>
<span id="cb209-5"><a href="05-covariates.html#cb209-5" aria-hidden="true" tabindex="-1"></a><span class="st">                 </span></span>
<span id="cb209-6"><a href="05-covariates.html#cb209-6" aria-hidden="true" tabindex="-1"></a><span class="st">                 # Growth Factors for DLPFC</span></span>
<span id="cb209-7"><a href="05-covariates.html#cb209-7" aria-hidden="true" tabindex="-1"></a><span class="st">                 int.dlpfc =~ 1*dlpfc1 + 1*dlpfc2 + 1*dlpfc3 + 1*dlpfc4</span></span>
<span id="cb209-8"><a href="05-covariates.html#cb209-8" aria-hidden="true" tabindex="-1"></a><span class="st">                 slp.dlpfc =~ 0*dlpfc1 + 1*dlpfc2 + 2*dlpfc3 + 3*dlpfc4</span></span>
<span id="cb209-9"><a href="05-covariates.html#cb209-9" aria-hidden="true" tabindex="-1"></a><span class="st">                 </span></span>
<span id="cb209-10"><a href="05-covariates.html#cb209-10" aria-hidden="true" tabindex="-1"></a><span class="st">                 # Factor Covariances</span></span>
<span id="cb209-11"><a href="05-covariates.html#cb209-11" aria-hidden="true" tabindex="-1"></a><span class="st">                 int.ef ~~ slp.ef + int.dlpfc + slp.dlpfc</span></span>
<span id="cb209-12"><a href="05-covariates.html#cb209-12" aria-hidden="true" tabindex="-1"></a><span class="st">                 slp.ef ~~ int.dlpfc + slp.dlpfc</span></span>
<span id="cb209-13"><a href="05-covariates.html#cb209-13" aria-hidden="true" tabindex="-1"></a><span class="st">                 int.dlpfc ~~ slp.dlpfc</span></span>
<span id="cb209-14"><a href="05-covariates.html#cb209-14" aria-hidden="true" tabindex="-1"></a><span class="st">                 </span></span>
<span id="cb209-15"><a href="05-covariates.html#cb209-15" aria-hidden="true" tabindex="-1"></a><span class="st">                 # Time-Specific Residual Covariance</span></span>
<span id="cb209-16"><a href="05-covariates.html#cb209-16" aria-hidden="true" tabindex="-1"></a><span class="st">                 ef1 ~~ dlpfc1</span></span>
<span id="cb209-17"><a href="05-covariates.html#cb209-17" aria-hidden="true" tabindex="-1"></a><span class="st">                 ef2 ~~ dlpfc2</span></span>
<span id="cb209-18"><a href="05-covariates.html#cb209-18" aria-hidden="true" tabindex="-1"></a><span class="st">                 ef3 ~~ dlpfc3</span></span>
<span id="cb209-19"><a href="05-covariates.html#cb209-19" aria-hidden="true" tabindex="-1"></a><span class="st">                 ef4 ~~ dlpfc4&quot;</span></span>
<span id="cb209-20"><a href="05-covariates.html#cb209-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-21"><a href="05-covariates.html#cb209-21" aria-hidden="true" tabindex="-1"></a>multivar.lcm.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(multivar.lcm, </span>
<span id="cb209-22"><a href="05-covariates.html#cb209-22" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> executive.function,</span>
<span id="cb209-23"><a href="05-covariates.html#cb209-23" aria-hidden="true" tabindex="-1"></a>                           <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb209-24"><a href="05-covariates.html#cb209-24" aria-hidden="true" tabindex="-1"></a>                           <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb209-25"><a href="05-covariates.html#cb209-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-26"><a href="05-covariates.html#cb209-26" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multivar.lcm.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>, </span>
<span id="cb209-27"><a href="05-covariates.html#cb209-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">FALSE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 50 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        26
## 
##   Number of observations                           342
##   Number of missing patterns                        28
## 
## Model Test User Model:
##                                                       
##   Test statistic                                11.574
##   Degrees of freedom                                18
##   P-value (Chi-square)                           0.868
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int.ef =~                                           
##     ef1               1.000                           
##     ef2               1.000                           
##     ef3               1.000                           
##     ef4               1.000                           
##   slp.ef =~                                           
##     ef1               0.000                           
##     ef2               1.000                           
##     ef3               2.000                           
##     ef4               3.000                           
##   int.dlpfc =~                                        
##     dlpfc1            1.000                           
##     dlpfc2            1.000                           
##     dlpfc3            1.000                           
##     dlpfc4            1.000                           
##   slp.dlpfc =~                                        
##     dlpfc1            0.000                           
##     dlpfc2            1.000                           
##     dlpfc3            2.000                           
##     dlpfc4            3.000                           
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int.ef ~~                                           
##     slp.ef           -0.010    0.016   -0.634    0.526
##     int.dlpfc         0.084    0.046    1.823    0.068
##     slp.dlpfc        -0.022    0.019   -1.159    0.247
##   slp.ef ~~                                           
##     int.dlpfc         0.011    0.017    0.647    0.518
##     slp.dlpfc         0.011    0.008    1.319    0.187
##   int.dlpfc ~~                                        
##     slp.dlpfc        -0.125    0.031   -4.072    0.000
##  .ef1 ~~                                              
##    .dlpfc1           -0.037    0.035   -1.066    0.286
##  .ef2 ~~                                              
##    .dlpfc2            0.048    0.027    1.738    0.082
##  .ef3 ~~                                              
##    .dlpfc3            0.023    0.029    0.781    0.435
##  .ef4 ~~                                              
##    .dlpfc4           -0.013    0.037   -0.348    0.728
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ef1               0.000                           
##    .ef2               0.000                           
##    .ef3               0.000                           
##    .ef4               0.000                           
##    .dlpfc1            0.000                           
##    .dlpfc2            0.000                           
##    .dlpfc3            0.000                           
##    .dlpfc4            0.000                           
##     int.ef            2.407    0.042   57.447    0.000
##     slp.ef            0.059    0.015    3.921    0.000
##     int.dlpfc         0.545    0.053   10.212    0.000
##     slp.dlpfc         0.120    0.021    5.696    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ef1               0.236    0.038    6.250    0.000
##    .ef2               0.262    0.027    9.569    0.000
##    .ef3               0.263    0.028    9.329    0.000
##    .ef4               0.123    0.034    3.615    0.000
##    .dlpfc1            0.235    0.063    3.733    0.000
##    .dlpfc2            0.566    0.055   10.268    0.000
##    .dlpfc3            0.577    0.057   10.110    0.000
##    .dlpfc4            0.399    0.074    5.389    0.000
##     int.ef            0.425    0.050    8.485    0.000
##     slp.ef            0.030    0.008    3.675    0.000
##     int.dlpfc         0.775    0.086    9.020    0.000
##     slp.dlpfc         0.081    0.016    5.134    0.000</code></pre>
<p>This model is quite simple for a SEM approach, and we can examine how different constructs travel together over time by examining the inter-relations among the growth factors. However, this is ultimately cross-sectional correlations because there is no temporal order at the latent level, either between intercepts and slope or between factors of different constructs. If we want to examine cross-lagged relationships among the repeated measures themselves (ala the standard cross-lag panel model we won’t consider here for numerous reasons), we might wish to introduce regression relationships among the repeated measures.</p>
<p>There are several ways to specify these regression among the repeated measures in a multivariate growth model; however, we will focus on what is known as the random-intercept cross-lag panel model (RI-CLPM) and it’s generalization in the latent curve model with structured residuals (LCM-SR). For an overview of potential alternatives, see <a href="https://psycnet.apa.org/fulltext/2019-21491-001.html">Usami &amp; Hamaker, 2019</a>. We retain the time-specific residual covariances, but now we include regression coefficients between the residuals of the repeated measures (hence “structured residuals”). Note that for the RI-CLPM, we remove the slope factors. In the LCM-SR, we can include any combination of latent growth factors, so that will be the term we will use to reference this general type of model, with the RI-CLPM being a special case.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="05-covariates.html#cb211-1" aria-hidden="true" tabindex="-1"></a>riclpm <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb211-2"><a href="05-covariates.html#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="st">          # Random Intercept for EF</span></span>
<span id="cb211-3"><a href="05-covariates.html#cb211-3" aria-hidden="true" tabindex="-1"></a><span class="st">          int.ef =~ 1*ef1 + 1*ef2 + 1*ef3 + 1*ef4</span></span>
<span id="cb211-4"><a href="05-covariates.html#cb211-4" aria-hidden="true" tabindex="-1"></a><span class="st">                 </span></span>
<span id="cb211-5"><a href="05-covariates.html#cb211-5" aria-hidden="true" tabindex="-1"></a><span class="st">          # Random Intercept for DLPFC</span></span>
<span id="cb211-6"><a href="05-covariates.html#cb211-6" aria-hidden="true" tabindex="-1"></a><span class="st">          int.dlpfc =~ 1*dlpfc1 + 1*dlpfc2 + 1*dlpfc3 + 1*dlpfc4</span></span>
<span id="cb211-7"><a href="05-covariates.html#cb211-7" aria-hidden="true" tabindex="-1"></a><span class="st">                 </span></span>
<span id="cb211-8"><a href="05-covariates.html#cb211-8" aria-hidden="true" tabindex="-1"></a><span class="st">          # Factor Covariances</span></span>
<span id="cb211-9"><a href="05-covariates.html#cb211-9" aria-hidden="true" tabindex="-1"></a><span class="st">          int.ef ~~ int.dlpfc</span></span>
<span id="cb211-10"><a href="05-covariates.html#cb211-10" aria-hidden="true" tabindex="-1"></a><span class="st">                 </span></span>
<span id="cb211-11"><a href="05-covariates.html#cb211-11" aria-hidden="true" tabindex="-1"></a><span class="st">          # Time-Specific Residual Covariance</span></span>
<span id="cb211-12"><a href="05-covariates.html#cb211-12" aria-hidden="true" tabindex="-1"></a><span class="st">          ef1 ~~ dlpfc1</span></span>
<span id="cb211-13"><a href="05-covariates.html#cb211-13" aria-hidden="true" tabindex="-1"></a><span class="st">          ef2 ~~ dlpfc2</span></span>
<span id="cb211-14"><a href="05-covariates.html#cb211-14" aria-hidden="true" tabindex="-1"></a><span class="st">          ef3 ~~ dlpfc3</span></span>
<span id="cb211-15"><a href="05-covariates.html#cb211-15" aria-hidden="true" tabindex="-1"></a><span class="st">          ef4 ~~ dlpfc4</span></span>
<span id="cb211-16"><a href="05-covariates.html#cb211-16" aria-hidden="true" tabindex="-1"></a><span class="st">              </span></span>
<span id="cb211-17"><a href="05-covariates.html#cb211-17" aria-hidden="true" tabindex="-1"></a><span class="st">          # Autoregressive and Cross-Regressive Effects</span></span>
<span id="cb211-18"><a href="05-covariates.html#cb211-18" aria-hidden="true" tabindex="-1"></a><span class="st">          ef2 ~ ef1 + dlpfc1</span></span>
<span id="cb211-19"><a href="05-covariates.html#cb211-19" aria-hidden="true" tabindex="-1"></a><span class="st">          ef3 ~ ef2 + dlpfc2</span></span>
<span id="cb211-20"><a href="05-covariates.html#cb211-20" aria-hidden="true" tabindex="-1"></a><span class="st">          ef4 ~ ef3 + dlpfc3</span></span>
<span id="cb211-21"><a href="05-covariates.html#cb211-21" aria-hidden="true" tabindex="-1"></a><span class="st">          dlpfc2 ~ dlpfc1 + ef1</span></span>
<span id="cb211-22"><a href="05-covariates.html#cb211-22" aria-hidden="true" tabindex="-1"></a><span class="st">          dlpfc3 ~ dlpfc2 + ef2</span></span>
<span id="cb211-23"><a href="05-covariates.html#cb211-23" aria-hidden="true" tabindex="-1"></a><span class="st">          dlpfc4 ~ dlpfc3 + ef3&quot;</span></span>
<span id="cb211-24"><a href="05-covariates.html#cb211-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-25"><a href="05-covariates.html#cb211-25" aria-hidden="true" tabindex="-1"></a>riclpm.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(riclpm,</span>
<span id="cb211-26"><a href="05-covariates.html#cb211-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> executive.function,</span>
<span id="cb211-27"><a href="05-covariates.html#cb211-27" aria-hidden="true" tabindex="-1"></a>                     <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb211-28"><a href="05-covariates.html#cb211-28" aria-hidden="true" tabindex="-1"></a>                     <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb211-29"><a href="05-covariates.html#cb211-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-30"><a href="05-covariates.html#cb211-30" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(riclpm.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>, </span>
<span id="cb211-31"><a href="05-covariates.html#cb211-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">FALSE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 44 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        29
## 
##   Number of observations                           342
##   Number of missing patterns                        28
## 
## Model Test User Model:
##                                                       
##   Test statistic                                30.269
##   Degrees of freedom                                15
##   P-value (Chi-square)                           0.011
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int.ef =~                                           
##     ef1               1.000                           
##     ef2               1.000                           
##     ef3               1.000                           
##     ef4               1.000                           
##   int.dlpfc =~                                        
##     dlpfc1            1.000                           
##     dlpfc2            1.000                           
##     dlpfc3            1.000                           
##     dlpfc4            1.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   ef2 ~                                               
##     ef1               0.027    0.018    1.472    0.141
##     dlpfc1            0.022    0.037    0.605    0.545
##   ef3 ~                                               
##     ef2               0.034    0.019    1.792    0.073
##     dlpfc2            0.034    0.035    0.971    0.332
##   ef4 ~                                               
##     ef3               0.065    0.019    3.490    0.000
##     dlpfc3            0.087    0.034    2.579    0.010
##   dlpfc2 ~                                            
##     dlpfc1            0.291    0.065    4.481    0.000
##     ef1              -0.001    0.027   -0.042    0.966
##   dlpfc3 ~                                            
##     dlpfc2            0.131    0.063    2.083    0.037
##     ef2               0.052    0.029    1.771    0.077
##   dlpfc4 ~                                            
##     dlpfc3            0.175    0.061    2.886    0.004
##     ef3               0.081    0.029    2.795    0.005
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int.ef ~~                                           
##     int.dlpfc         0.030    0.032    0.959    0.338
##  .ef1 ~~                                              
##    .dlpfc1           -0.008    0.033   -0.243    0.808
##  .ef2 ~~                                              
##    .dlpfc2            0.050    0.029    1.711    0.087
##  .ef3 ~~                                              
##    .dlpfc3            0.060    0.033    1.827    0.068
##  .ef4 ~~                                              
##    .dlpfc4            0.022    0.030    0.724    0.469
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ef1               0.000                           
##    .ef2               0.000                           
##    .ef3               0.000                           
##    .ef4               0.000                           
##    .dlpfc1            0.000                           
##    .dlpfc2            0.000                           
##    .dlpfc3            0.000                           
##    .dlpfc4            0.000                           
##     int.ef            2.390    0.046   52.341    0.000
##     int.dlpfc         0.546    0.052   10.501    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ef1               0.313    0.032    9.656    0.000
##    .ef2               0.262    0.028    9.267    0.000
##    .ef3               0.280    0.030    9.445    0.000
##    .ef4               0.229    0.026    8.773    0.000
##    .dlpfc1            0.627    0.069    9.120    0.000
##    .dlpfc2            0.568    0.060    9.507    0.000
##    .dlpfc3            0.669    0.069    9.660    0.000
##    .dlpfc4            0.639    0.062   10.310    0.000
##     int.ef            0.412    0.040   10.263    0.000
##     int.dlpfc         0.352    0.063    5.551    0.000</code></pre>
<p>With the LCM-SR, we simply add back the slope factors for each of our constructs. Note that in practice, we do not need to specify the same type of trajectory for each variable. It’s entirely possible that one variable might follow a linear and the other a quadratic. Indeed one construct might only need a random intercept (we will see this later); we can mix and match as we please.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="05-covariates.html#cb213-1" aria-hidden="true" tabindex="-1"></a>lcmsr <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb213-2"><a href="05-covariates.html#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="st">         # Growth Factors for EF</span></span>
<span id="cb213-3"><a href="05-covariates.html#cb213-3" aria-hidden="true" tabindex="-1"></a><span class="st">         int.ef =~ 1*ef1 + 1*ef2 + 1*ef3 + 1*ef4</span></span>
<span id="cb213-4"><a href="05-covariates.html#cb213-4" aria-hidden="true" tabindex="-1"></a><span class="st">         slp.ef =~ 0*ef1 + 1*ef2 + 2*ef3 + 3*ef4</span></span>
<span id="cb213-5"><a href="05-covariates.html#cb213-5" aria-hidden="true" tabindex="-1"></a><span class="st">                 </span></span>
<span id="cb213-6"><a href="05-covariates.html#cb213-6" aria-hidden="true" tabindex="-1"></a><span class="st">         # Growth Factors for DLPFC</span></span>
<span id="cb213-7"><a href="05-covariates.html#cb213-7" aria-hidden="true" tabindex="-1"></a><span class="st">         int.dlpfc =~ 1*dlpfc1 + 1*dlpfc2 + 1*dlpfc3 + 1*dlpfc4</span></span>
<span id="cb213-8"><a href="05-covariates.html#cb213-8" aria-hidden="true" tabindex="-1"></a><span class="st">         slp.dlpfc =~ 0*dlpfc1 + 1*dlpfc2 + 2*dlpfc3 + 3*dlpfc4</span></span>
<span id="cb213-9"><a href="05-covariates.html#cb213-9" aria-hidden="true" tabindex="-1"></a><span class="st">                 </span></span>
<span id="cb213-10"><a href="05-covariates.html#cb213-10" aria-hidden="true" tabindex="-1"></a><span class="st">         # Factor Covariances</span></span>
<span id="cb213-11"><a href="05-covariates.html#cb213-11" aria-hidden="true" tabindex="-1"></a><span class="st">         int.ef ~~ slp.ef + int.dlpfc + slp.dlpfc</span></span>
<span id="cb213-12"><a href="05-covariates.html#cb213-12" aria-hidden="true" tabindex="-1"></a><span class="st">         slp.ef ~~ int.dlpfc + slp.dlpfc</span></span>
<span id="cb213-13"><a href="05-covariates.html#cb213-13" aria-hidden="true" tabindex="-1"></a><span class="st">         int.dlpfc ~~ slp.dlpfc</span></span>
<span id="cb213-14"><a href="05-covariates.html#cb213-14" aria-hidden="true" tabindex="-1"></a><span class="st">                 </span></span>
<span id="cb213-15"><a href="05-covariates.html#cb213-15" aria-hidden="true" tabindex="-1"></a><span class="st">         # Time-Specific Residual Covariance</span></span>
<span id="cb213-16"><a href="05-covariates.html#cb213-16" aria-hidden="true" tabindex="-1"></a><span class="st">         ef1 ~~ dlpfc1</span></span>
<span id="cb213-17"><a href="05-covariates.html#cb213-17" aria-hidden="true" tabindex="-1"></a><span class="st">         ef2 ~~ dlpfc2</span></span>
<span id="cb213-18"><a href="05-covariates.html#cb213-18" aria-hidden="true" tabindex="-1"></a><span class="st">         ef3 ~~ dlpfc3</span></span>
<span id="cb213-19"><a href="05-covariates.html#cb213-19" aria-hidden="true" tabindex="-1"></a><span class="st">         ef4 ~~ dlpfc4</span></span>
<span id="cb213-20"><a href="05-covariates.html#cb213-20" aria-hidden="true" tabindex="-1"></a><span class="st">              </span></span>
<span id="cb213-21"><a href="05-covariates.html#cb213-21" aria-hidden="true" tabindex="-1"></a><span class="st">         # Autoregressive and Cross-Regressive Effects</span></span>
<span id="cb213-22"><a href="05-covariates.html#cb213-22" aria-hidden="true" tabindex="-1"></a><span class="st">         ef2 ~ ef1 + dlpfc1</span></span>
<span id="cb213-23"><a href="05-covariates.html#cb213-23" aria-hidden="true" tabindex="-1"></a><span class="st">         ef3 ~ ef2 + dlpfc2</span></span>
<span id="cb213-24"><a href="05-covariates.html#cb213-24" aria-hidden="true" tabindex="-1"></a><span class="st">         ef4 ~ ef3 + dlpfc3</span></span>
<span id="cb213-25"><a href="05-covariates.html#cb213-25" aria-hidden="true" tabindex="-1"></a><span class="st">         dlpfc2 ~ dlpfc1 + ef1</span></span>
<span id="cb213-26"><a href="05-covariates.html#cb213-26" aria-hidden="true" tabindex="-1"></a><span class="st">         dlpfc3 ~ dlpfc2 + ef2</span></span>
<span id="cb213-27"><a href="05-covariates.html#cb213-27" aria-hidden="true" tabindex="-1"></a><span class="st">         dlpfc4 ~ dlpfc3 + ef3&quot;</span></span>
<span id="cb213-28"><a href="05-covariates.html#cb213-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-29"><a href="05-covariates.html#cb213-29" aria-hidden="true" tabindex="-1"></a>lcmsr.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(lcmsr,</span>
<span id="cb213-30"><a href="05-covariates.html#cb213-30" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> executive.function,</span>
<span id="cb213-31"><a href="05-covariates.html#cb213-31" aria-hidden="true" tabindex="-1"></a>                    <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb213-32"><a href="05-covariates.html#cb213-32" aria-hidden="true" tabindex="-1"></a>                    <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb213-33"><a href="05-covariates.html#cb213-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-34"><a href="05-covariates.html#cb213-34" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lcmsr.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>, </span>
<span id="cb213-35"><a href="05-covariates.html#cb213-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">FALSE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 72 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        38
## 
##   Number of observations                           342
##   Number of missing patterns                        28
## 
## Model Test User Model:
##                                                       
##   Test statistic                                 1.299
##   Degrees of freedom                                 6
##   P-value (Chi-square)                           0.972
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int.ef =~                                           
##     ef1               1.000                           
##     ef2               1.000                           
##     ef3               1.000                           
##     ef4               1.000                           
##   slp.ef =~                                           
##     ef1               0.000                           
##     ef2               1.000                           
##     ef3               2.000                           
##     ef4               3.000                           
##   int.dlpfc =~                                        
##     dlpfc1            1.000                           
##     dlpfc2            1.000                           
##     dlpfc3            1.000                           
##     dlpfc4            1.000                           
##   slp.dlpfc =~                                        
##     dlpfc1            0.000                           
##     dlpfc2            1.000                           
##     dlpfc3            2.000                           
##     dlpfc4            3.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   ef2 ~                                               
##     ef1               0.022    0.048    0.463    0.643
##     dlpfc1            0.031    0.047    0.664    0.507
##   ef3 ~                                               
##     ef2               0.035    0.088    0.402    0.688
##     dlpfc2            0.074    0.044    1.702    0.089
##   ef4 ~                                               
##     ef3               0.052    0.133    0.390    0.697
##     dlpfc3            0.191    0.076    2.522    0.012
##   dlpfc2 ~                                            
##     dlpfc1            0.030    0.087    0.346    0.729
##     ef1               0.091    0.054    1.699    0.089
##   dlpfc3 ~                                            
##     dlpfc2            0.006    0.076    0.077    0.939
##     ef2               0.163    0.096    1.702    0.089
##   dlpfc4 ~                                            
##     dlpfc3           -0.062    0.155   -0.403    0.687
##     ef3               0.274    0.145    1.887    0.059
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int.ef ~~                                           
##     slp.ef           -0.020    0.019   -1.030    0.303
##     int.dlpfc         0.069    0.057    1.202    0.229
##     slp.dlpfc        -0.046    0.026   -1.752    0.080
##   slp.ef ~~                                           
##     int.dlpfc        -0.016    0.022   -0.731    0.465
##     slp.dlpfc        -0.009    0.013   -0.675    0.500
##   int.dlpfc ~~                                        
##     slp.dlpfc        -0.115    0.046   -2.504    0.012
##  .ef1 ~~                                              
##    .dlpfc1           -0.013    0.046   -0.287    0.774
##  .ef2 ~~                                              
##    .dlpfc2            0.059    0.029    2.044    0.041
##  .ef3 ~~                                              
##    .dlpfc3            0.113    0.047    2.392    0.017
##  .ef4 ~~                                              
##    .dlpfc4            0.059    0.056    1.057    0.291
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ef1               0.000                           
##    .ef2               0.000                           
##    .ef3               0.000                           
##    .ef4               0.000                           
##    .dlpfc1            0.000                           
##    .dlpfc2            0.000                           
##    .dlpfc3            0.000                           
##    .dlpfc4            0.000                           
##     int.ef            2.421    0.044   54.641    0.000
##     slp.ef           -0.033    0.112   -0.298    0.765
##     int.dlpfc         0.539    0.054    9.985    0.000
##     slp.dlpfc        -0.089    0.124   -0.715    0.475
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ef1               0.238    0.045    5.345    0.000
##    .ef2               0.268    0.030    8.961    0.000
##    .ef3               0.282    0.045    6.270    0.000
##    .ef4               0.144    0.051    2.815    0.005
##    .dlpfc1            0.262    0.106    2.466    0.014
##    .dlpfc2            0.559    0.058    9.605    0.000
##    .dlpfc3            0.557    0.099    5.614    0.000
##    .dlpfc4            0.409    0.103    3.980    0.000
##     int.ef            0.424    0.056    7.640    0.000
##     slp.ef            0.025    0.013    1.931    0.054
##     int.dlpfc         0.736    0.125    5.898    0.000
##     slp.dlpfc         0.086    0.027    3.252    0.001</code></pre>
<p>For all the reasons we have discussed so far (and common practice in CLPMs more generally), it is common to test equality constraints on the auto- and cross-regressive effects in these models. We can see an example of this below.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="05-covariates.html#cb215-1" aria-hidden="true" tabindex="-1"></a>lcmsr <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb215-2"><a href="05-covariates.html#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="st">         # Growth Factors for EF</span></span>
<span id="cb215-3"><a href="05-covariates.html#cb215-3" aria-hidden="true" tabindex="-1"></a><span class="st">         int.ef =~ 1*ef1 + 1*ef2 + 1*ef3 + 1*ef4</span></span>
<span id="cb215-4"><a href="05-covariates.html#cb215-4" aria-hidden="true" tabindex="-1"></a><span class="st">         slp.ef =~ 0*ef1 + 1*ef2 + 2*ef3 + 3*ef4</span></span>
<span id="cb215-5"><a href="05-covariates.html#cb215-5" aria-hidden="true" tabindex="-1"></a><span class="st">                 </span></span>
<span id="cb215-6"><a href="05-covariates.html#cb215-6" aria-hidden="true" tabindex="-1"></a><span class="st">         # Growth Factors for DLPFC</span></span>
<span id="cb215-7"><a href="05-covariates.html#cb215-7" aria-hidden="true" tabindex="-1"></a><span class="st">         int.dlpfc =~ 1*dlpfc1 + 1*dlpfc2 + 1*dlpfc3 + 1*dlpfc4</span></span>
<span id="cb215-8"><a href="05-covariates.html#cb215-8" aria-hidden="true" tabindex="-1"></a><span class="st">         slp.dlpfc =~ 0*dlpfc1 + 1*dlpfc2 + 2*dlpfc3 + 3*dlpfc4</span></span>
<span id="cb215-9"><a href="05-covariates.html#cb215-9" aria-hidden="true" tabindex="-1"></a><span class="st">                 </span></span>
<span id="cb215-10"><a href="05-covariates.html#cb215-10" aria-hidden="true" tabindex="-1"></a><span class="st">         # Factor Covariances</span></span>
<span id="cb215-11"><a href="05-covariates.html#cb215-11" aria-hidden="true" tabindex="-1"></a><span class="st">         int.ef ~~ slp.ef + int.dlpfc + slp.dlpfc</span></span>
<span id="cb215-12"><a href="05-covariates.html#cb215-12" aria-hidden="true" tabindex="-1"></a><span class="st">         slp.ef ~~ int.dlpfc + slp.dlpfc</span></span>
<span id="cb215-13"><a href="05-covariates.html#cb215-13" aria-hidden="true" tabindex="-1"></a><span class="st">         int.dlpfc ~~ slp.dlpfc</span></span>
<span id="cb215-14"><a href="05-covariates.html#cb215-14" aria-hidden="true" tabindex="-1"></a><span class="st">                 </span></span>
<span id="cb215-15"><a href="05-covariates.html#cb215-15" aria-hidden="true" tabindex="-1"></a><span class="st">         # Time-Specific Residual Covariance</span></span>
<span id="cb215-16"><a href="05-covariates.html#cb215-16" aria-hidden="true" tabindex="-1"></a><span class="st">         ef1 ~~ dlpfc1</span></span>
<span id="cb215-17"><a href="05-covariates.html#cb215-17" aria-hidden="true" tabindex="-1"></a><span class="st">         ef2 ~~ dlpfc2</span></span>
<span id="cb215-18"><a href="05-covariates.html#cb215-18" aria-hidden="true" tabindex="-1"></a><span class="st">         ef3 ~~ dlpfc3</span></span>
<span id="cb215-19"><a href="05-covariates.html#cb215-19" aria-hidden="true" tabindex="-1"></a><span class="st">         ef4 ~~ dlpfc4</span></span>
<span id="cb215-20"><a href="05-covariates.html#cb215-20" aria-hidden="true" tabindex="-1"></a><span class="st">              </span></span>
<span id="cb215-21"><a href="05-covariates.html#cb215-21" aria-hidden="true" tabindex="-1"></a><span class="st">         # Autoregressive and Cross-Regressive Effects</span></span>
<span id="cb215-22"><a href="05-covariates.html#cb215-22" aria-hidden="true" tabindex="-1"></a><span class="st">         ef2 ~ c1*ef1 + c3*dlpfc1</span></span>
<span id="cb215-23"><a href="05-covariates.html#cb215-23" aria-hidden="true" tabindex="-1"></a><span class="st">         ef3 ~ c1*ef2 + c3*dlpfc2</span></span>
<span id="cb215-24"><a href="05-covariates.html#cb215-24" aria-hidden="true" tabindex="-1"></a><span class="st">         ef4 ~ c1*ef3 + c3*dlpfc3</span></span>
<span id="cb215-25"><a href="05-covariates.html#cb215-25" aria-hidden="true" tabindex="-1"></a><span class="st">         dlpfc2 ~ c2*dlpfc1 + c4*ef1</span></span>
<span id="cb215-26"><a href="05-covariates.html#cb215-26" aria-hidden="true" tabindex="-1"></a><span class="st">         dlpfc3 ~ c2*dlpfc2 + c4*ef2</span></span>
<span id="cb215-27"><a href="05-covariates.html#cb215-27" aria-hidden="true" tabindex="-1"></a><span class="st">         dlpfc4 ~ c2*dlpfc3 + c4*ef3&quot;</span></span>
<span id="cb215-28"><a href="05-covariates.html#cb215-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-29"><a href="05-covariates.html#cb215-29" aria-hidden="true" tabindex="-1"></a>lcmsr.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(lcmsr,</span>
<span id="cb215-30"><a href="05-covariates.html#cb215-30" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> executive.function,</span>
<span id="cb215-31"><a href="05-covariates.html#cb215-31" aria-hidden="true" tabindex="-1"></a>                    <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb215-32"><a href="05-covariates.html#cb215-32" aria-hidden="true" tabindex="-1"></a>                    <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb215-33"><a href="05-covariates.html#cb215-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-34"><a href="05-covariates.html#cb215-34" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lcmsr.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>, </span>
<span id="cb215-35"><a href="05-covariates.html#cb215-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">FALSE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 57 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        38
##   Number of equality constraints                     8
## 
##   Number of observations                           342
##   Number of missing patterns                        28
## 
## Model Test User Model:
##                                                       
##   Test statistic                                 9.555
##   Degrees of freedom                                14
##   P-value (Chi-square)                           0.794
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int.ef =~                                           
##     ef1               1.000                           
##     ef2               1.000                           
##     ef3               1.000                           
##     ef4               1.000                           
##   slp.ef =~                                           
##     ef1               0.000                           
##     ef2               1.000                           
##     ef3               2.000                           
##     ef4               3.000                           
##   int.dlpfc =~                                        
##     dlpfc1            1.000                           
##     dlpfc2            1.000                           
##     dlpfc3            1.000                           
##     dlpfc4            1.000                           
##   slp.dlpfc =~                                        
##     dlpfc1            0.000                           
##     dlpfc2            1.000                           
##     dlpfc3            2.000                           
##     dlpfc4            3.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   ef2 ~                                               
##     ef1       (c1)   -0.020    0.020   -1.010    0.312
##     dlpfc1    (c3)    0.030    0.030    0.979    0.328
##   ef3 ~                                               
##     ef2       (c1)   -0.020    0.020   -1.010    0.312
##     dlpfc2    (c3)    0.030    0.030    0.979    0.328
##   ef4 ~                                               
##     ef3       (c1)   -0.020    0.020   -1.010    0.312
##     dlpfc3    (c3)    0.030    0.030    0.979    0.328
##   dlpfc2 ~                                            
##     dlpfc1    (c2)    0.026    0.061    0.419    0.675
##     ef1       (c4)    0.014    0.028    0.497    0.619
##   dlpfc3 ~                                            
##     dlpfc2    (c2)    0.026    0.061    0.419    0.675
##     ef2       (c4)    0.014    0.028    0.497    0.619
##   dlpfc4 ~                                            
##     dlpfc3    (c2)    0.026    0.061    0.419    0.675
##     ef3       (c4)    0.014    0.028    0.497    0.619
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int.ef ~~                                           
##     slp.ef           -0.012    0.016   -0.774    0.439
##     int.dlpfc         0.062    0.051    1.204    0.229
##     slp.dlpfc        -0.016    0.021   -0.801    0.423
##   slp.ef ~~                                           
##     int.dlpfc         0.013    0.017    0.739    0.460
##     slp.dlpfc         0.005    0.009    0.584    0.559
##   int.dlpfc ~~                                        
##     slp.dlpfc        -0.124    0.032   -3.849    0.000
##  .ef1 ~~                                              
##    .dlpfc1           -0.018    0.039   -0.447    0.655
##  .ef2 ~~                                              
##    .dlpfc2            0.049    0.027    1.775    0.076
##  .ef3 ~~                                              
##    .dlpfc3            0.031    0.030    1.020    0.308
##  .ef4 ~~                                              
##    .dlpfc4            0.001    0.039    0.018    0.985
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ef1               0.000                           
##    .ef2               0.000                           
##    .ef3               0.000                           
##    .ef4               0.000                           
##    .dlpfc1            0.000                           
##    .dlpfc2            0.000                           
##    .dlpfc3            0.000                           
##    .dlpfc4            0.000                           
##     int.ef            2.419    0.044   54.605    0.000
##     slp.ef            0.066    0.021    3.159    0.002
##     int.dlpfc         0.536    0.054    9.901    0.000
##     slp.dlpfc         0.102    0.032    3.178    0.001
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ef1               0.224    0.039    5.746    0.000
##    .ef2               0.261    0.027    9.571    0.000
##    .ef3               0.258    0.028    9.191    0.000
##    .ef4               0.115    0.035    3.342    0.001
##    .dlpfc1            0.253    0.085    2.969    0.003
##    .dlpfc2            0.566    0.055   10.214    0.000
##    .dlpfc3            0.592    0.064    9.304    0.000
##    .dlpfc4            0.413    0.088    4.677    0.000
##     int.ef            0.439    0.053    8.349    0.000
##     slp.ef            0.032    0.009    3.736    0.000
##     int.dlpfc         0.754    0.106    7.134    0.000
##     slp.dlpfc         0.077    0.021    3.668    0.000</code></pre>
<p>As always, we can extend this model in a number of ways that we won’t go into here for sake of time (ha ha ha you may say to yourself). While uncommon, we could impose functions on the cross-regressive paths, add additional outcome variables, and include both TIC and (true) TVCs to this model. The limitations are as always, proper theoretical models for that complexity, and sufficient data to estimate all of these effects uniquely.</p>
<p>Multivariate LCSMs have some additional peculiarities that we will explore since they diverge somewhat from the LCM we have mostly focused on. However, as with all SEMs, the problem is much more keeping track of the parameter syntax than it is an inability to estimate certain effects. The main point of divergence between the LCM and LCSM is the inclusion of proportional parameters in the multivariate model. Because of this, we will dive straight into that model instead of building up in the way we did with the LCM. Below we can see the syntax for this multivariate dual-change LCSM.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="05-covariates.html#cb217-1" aria-hidden="true" tabindex="-1"></a>multivar.dualchange <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb217-2"><a href="05-covariates.html#cb217-2" aria-hidden="true" tabindex="-1"></a><span class="st">        # Define Phantom Variables (p = phantom)</span></span>
<span id="cb217-3"><a href="05-covariates.html#cb217-3" aria-hidden="true" tabindex="-1"></a><span class="st">        pef1 =~ 1*ef1; ef1 ~ 0; ef1 ~~ ef1; pef1 ~~ 0*pef1</span></span>
<span id="cb217-4"><a href="05-covariates.html#cb217-4" aria-hidden="true" tabindex="-1"></a><span class="st">        pef2 =~ 1*ef2; ef2 ~ 0; ef2 ~~ ef2; pef2 ~~ 0*pef2</span></span>
<span id="cb217-5"><a href="05-covariates.html#cb217-5" aria-hidden="true" tabindex="-1"></a><span class="st">        pef3 =~ 1*ef3; ef3 ~ 0; ef3 ~~ ef3; pef3 ~~ 0*pef3</span></span>
<span id="cb217-6"><a href="05-covariates.html#cb217-6" aria-hidden="true" tabindex="-1"></a><span class="st">        pef4 =~ 1*ef4; ef4 ~ 0; ef4 ~~ ef4; pef4 ~~ 0*pef4</span></span>
<span id="cb217-7"><a href="05-covariates.html#cb217-7" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb217-8"><a href="05-covariates.html#cb217-8" aria-hidden="true" tabindex="-1"></a><span class="st">        pdlpfc1 =~ 1*dlpfc1; dlpfc1 ~ 0; dlpfc1 ~~ dlpfc1; pdlpfc1 ~~ 0*pdlpfc1</span></span>
<span id="cb217-9"><a href="05-covariates.html#cb217-9" aria-hidden="true" tabindex="-1"></a><span class="st">        pdlpfc2 =~ 1*dlpfc2; dlpfc2 ~ 0; dlpfc2 ~~ dlpfc2; pdlpfc2 ~~ 0*pdlpfc2</span></span>
<span id="cb217-10"><a href="05-covariates.html#cb217-10" aria-hidden="true" tabindex="-1"></a><span class="st">        pdlpfc3 =~ 1*dlpfc3; dlpfc3 ~ 0; dlpfc3 ~~ dlpfc3; pdlpfc3 ~~ 0*pdlpfc3</span></span>
<span id="cb217-11"><a href="05-covariates.html#cb217-11" aria-hidden="true" tabindex="-1"></a><span class="st">        pdlpfc4 =~ 1*dlpfc4; dlpfc4 ~ 0; dlpfc4 ~~ dlpfc4; pdlpfc4 ~~ 0*pdlpfc4</span></span>
<span id="cb217-12"><a href="05-covariates.html#cb217-12" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb217-13"><a href="05-covariates.html#cb217-13" aria-hidden="true" tabindex="-1"></a><span class="st">        # Regressions Between Adjacent Observations</span></span>
<span id="cb217-14"><a href="05-covariates.html#cb217-14" aria-hidden="true" tabindex="-1"></a><span class="st">        pef2 ~ 1*pef1</span></span>
<span id="cb217-15"><a href="05-covariates.html#cb217-15" aria-hidden="true" tabindex="-1"></a><span class="st">        pef3 ~ 1*pef2</span></span>
<span id="cb217-16"><a href="05-covariates.html#cb217-16" aria-hidden="true" tabindex="-1"></a><span class="st">        pef4 ~ 1*pef3</span></span>
<span id="cb217-17"><a href="05-covariates.html#cb217-17" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb217-18"><a href="05-covariates.html#cb217-18" aria-hidden="true" tabindex="-1"></a><span class="st">        pdlpfc2 ~ 1*pdlpfc1</span></span>
<span id="cb217-19"><a href="05-covariates.html#cb217-19" aria-hidden="true" tabindex="-1"></a><span class="st">        pdlpfc3 ~ 1*pdlpfc2</span></span>
<span id="cb217-20"><a href="05-covariates.html#cb217-20" aria-hidden="true" tabindex="-1"></a><span class="st">        pdlpfc4 ~ 1*pdlpfc3</span></span>
<span id="cb217-21"><a href="05-covariates.html#cb217-21" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb217-22"><a href="05-covariates.html#cb217-22" aria-hidden="true" tabindex="-1"></a><span class="st">        # Define Change Latent Variables (d)</span></span>
<span id="cb217-23"><a href="05-covariates.html#cb217-23" aria-hidden="true" tabindex="-1"></a><span class="st">        def21 =~ 1*pef2; def21 ~~ 0*def21</span></span>
<span id="cb217-24"><a href="05-covariates.html#cb217-24" aria-hidden="true" tabindex="-1"></a><span class="st">        def32 =~ 1*pef3; def32 ~~ 0*def32</span></span>
<span id="cb217-25"><a href="05-covariates.html#cb217-25" aria-hidden="true" tabindex="-1"></a><span class="st">        def43 =~ 1*pef4; def43 ~~ 0*def43</span></span>
<span id="cb217-26"><a href="05-covariates.html#cb217-26" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb217-27"><a href="05-covariates.html#cb217-27" aria-hidden="true" tabindex="-1"></a><span class="st">        ddlpfc21 =~ 1*pdlpfc2; ddlpfc21 ~~ 0*ddlpfc21</span></span>
<span id="cb217-28"><a href="05-covariates.html#cb217-28" aria-hidden="true" tabindex="-1"></a><span class="st">        ddlpfc32 =~ 1*pdlpfc3; ddlpfc32 ~~ 0*ddlpfc32</span></span>
<span id="cb217-29"><a href="05-covariates.html#cb217-29" aria-hidden="true" tabindex="-1"></a><span class="st">        ddlpfc43 =~ 1*pdlpfc4; ddlpfc43 ~~ 0*ddlpfc43</span></span>
<span id="cb217-30"><a href="05-covariates.html#cb217-30" aria-hidden="true" tabindex="-1"></a><span class="st">               </span></span>
<span id="cb217-31"><a href="05-covariates.html#cb217-31" aria-hidden="true" tabindex="-1"></a><span class="st">        # Define Proportional Change Regressions (beta = equality constraint)</span></span>
<span id="cb217-32"><a href="05-covariates.html#cb217-32" aria-hidden="true" tabindex="-1"></a><span class="st">        def21 ~ beta1*pef1 + beta3*pdlpfc1</span></span>
<span id="cb217-33"><a href="05-covariates.html#cb217-33" aria-hidden="true" tabindex="-1"></a><span class="st">        def32 ~ beta1*pef2 + beta3*pdlpfc2</span></span>
<span id="cb217-34"><a href="05-covariates.html#cb217-34" aria-hidden="true" tabindex="-1"></a><span class="st">        def43 ~ beta1*pef3 + beta3*pdlpfc3</span></span>
<span id="cb217-35"><a href="05-covariates.html#cb217-35" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb217-36"><a href="05-covariates.html#cb217-36" aria-hidden="true" tabindex="-1"></a><span class="st">        ddlpfc21 ~ beta2*pdlpfc1 + beta4*pef1</span></span>
<span id="cb217-37"><a href="05-covariates.html#cb217-37" aria-hidden="true" tabindex="-1"></a><span class="st">        ddlpfc32 ~ beta2*pdlpfc2 + beta4*pef2</span></span>
<span id="cb217-38"><a href="05-covariates.html#cb217-38" aria-hidden="true" tabindex="-1"></a><span class="st">        ddlpfc43 ~ beta2*pdlpfc3 + beta4*pef3</span></span>
<span id="cb217-39"><a href="05-covariates.html#cb217-39" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb217-40"><a href="05-covariates.html#cb217-40" aria-hidden="true" tabindex="-1"></a><span class="st">        # Define Intercept and Slope</span></span>
<span id="cb217-41"><a href="05-covariates.html#cb217-41" aria-hidden="true" tabindex="-1"></a><span class="st">        int.ef =~ 1*pef1</span></span>
<span id="cb217-42"><a href="05-covariates.html#cb217-42" aria-hidden="true" tabindex="-1"></a><span class="st">        slp.ef =~ 1*def21 + 1*def32 + 1*def43</span></span>
<span id="cb217-43"><a href="05-covariates.html#cb217-43" aria-hidden="true" tabindex="-1"></a><span class="st">        int.ef ~ 1; int.ef ~~ int.ef</span></span>
<span id="cb217-44"><a href="05-covariates.html#cb217-44" aria-hidden="true" tabindex="-1"></a><span class="st">        slp.ef ~ 1; slp.ef ~~ slp.ef</span></span>
<span id="cb217-45"><a href="05-covariates.html#cb217-45" aria-hidden="true" tabindex="-1"></a><span class="st">        int.ef ~~ slp.ef</span></span>
<span id="cb217-46"><a href="05-covariates.html#cb217-46" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb217-47"><a href="05-covariates.html#cb217-47" aria-hidden="true" tabindex="-1"></a><span class="st">        int.dlpfc =~ 1*pdlpfc1</span></span>
<span id="cb217-48"><a href="05-covariates.html#cb217-48" aria-hidden="true" tabindex="-1"></a><span class="st">        slp.dlpfc =~ 1*ddlpfc21 + 1*ddlpfc32 + 1*ddlpfc43</span></span>
<span id="cb217-49"><a href="05-covariates.html#cb217-49" aria-hidden="true" tabindex="-1"></a><span class="st">        int.dlpfc ~ 1; int.dlpfc ~~ int.dlpfc</span></span>
<span id="cb217-50"><a href="05-covariates.html#cb217-50" aria-hidden="true" tabindex="-1"></a><span class="st">        slp.dlpfc ~ 1; slp.dlpfc ~~ slp.dlpfc</span></span>
<span id="cb217-51"><a href="05-covariates.html#cb217-51" aria-hidden="true" tabindex="-1"></a><span class="st">        int.dlpfc ~~ slp.dlpfc</span></span>
<span id="cb217-52"><a href="05-covariates.html#cb217-52" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb217-53"><a href="05-covariates.html#cb217-53" aria-hidden="true" tabindex="-1"></a><span class="st">        # Cross-Construct Covariances</span></span>
<span id="cb217-54"><a href="05-covariates.html#cb217-54" aria-hidden="true" tabindex="-1"></a><span class="st">        int.ef ~~ int.dlpfc + slp.dlpfc</span></span>
<span id="cb217-55"><a href="05-covariates.html#cb217-55" aria-hidden="true" tabindex="-1"></a><span class="st">        slp.ef ~~ int.dlpfc + slp.dlpfc</span></span>
<span id="cb217-56"><a href="05-covariates.html#cb217-56" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb217-57"><a href="05-covariates.html#cb217-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-58"><a href="05-covariates.html#cb217-58" aria-hidden="true" tabindex="-1"></a>multivar.dualchange <span class="ot">&lt;-</span> <span class="fu">sem</span>(multivar.dualchange, </span>
<span id="cb217-59"><a href="05-covariates.html#cb217-59" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> executive.function, </span>
<span id="cb217-60"><a href="05-covariates.html#cb217-60" aria-hidden="true" tabindex="-1"></a>                           <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb217-61"><a href="05-covariates.html#cb217-61" aria-hidden="true" tabindex="-1"></a>                           <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb217-62"><a href="05-covariates.html#cb217-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-63"><a href="05-covariates.html#cb217-63" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multivar.dualchange, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>, </span>
<span id="cb217-64"><a href="05-covariates.html#cb217-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">FALSE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 122 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        34
##   Number of equality constraints                     8
## 
##   Number of observations                           342
##   Number of missing patterns                        28
## 
## Model Test User Model:
##                                                       
##   Test statistic                                14.490
##   Degrees of freedom                                18
##   P-value (Chi-square)                           0.697
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   pef1 =~                                             
##     ef1               1.000                           
##   pef2 =~                                             
##     ef2               1.000                           
##   pef3 =~                                             
##     ef3               1.000                           
##   pef4 =~                                             
##     ef4               1.000                           
##   pdlpfc1 =~                                          
##     dlpfc1            1.000                           
##   pdlpfc2 =~                                          
##     dlpfc2            1.000                           
##   pdlpfc3 =~                                          
##     dlpfc3            1.000                           
##   pdlpfc4 =~                                          
##     dlpfc4            1.000                           
##   def21 =~                                            
##     pef2              1.000                           
##   def32 =~                                            
##     pef3              1.000                           
##   def43 =~                                            
##     pef4              1.000                           
##   ddlpfc21 =~                                         
##     pdlpfc2           1.000                           
##   ddlpfc32 =~                                         
##     pdlpfc3           1.000                           
##   ddlpfc43 =~                                         
##     pdlpfc4           1.000                           
##   int.ef =~                                           
##     pef1              1.000                           
##   slp.ef =~                                           
##     def21             1.000                           
##     def32             1.000                           
##     def43             1.000                           
##   int.dlpfc =~                                        
##     pdlpfc1           1.000                           
##   slp.dlpfc =~                                        
##     ddlpfc21          1.000                           
##     ddlpfc32          1.000                           
##     ddlpfc43          1.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   pef2 ~                                              
##     pef1              1.000                           
##   pef3 ~                                              
##     pef2              1.000                           
##   pef4 ~                                              
##     pef3              1.000                           
##   pdlpfc2 ~                                           
##     pdlpfc1           1.000                           
##   pdlpfc3 ~                                           
##     pdlpfc2           1.000                           
##   pdlpfc4 ~                                           
##     pdlpfc3           1.000                           
##   def21 ~                                             
##     pef1    (bet1)    0.249    0.596    0.418    0.676
##     pdlpfc1 (bet3)    0.069    0.155    0.448    0.654
##   def32 ~                                             
##     pef2    (bet1)    0.249    0.596    0.418    0.676
##     pdlpfc2 (bet3)    0.069    0.155    0.448    0.654
##   def43 ~                                             
##     pef3    (bet1)    0.249    0.596    0.418    0.676
##     pdlpfc3 (bet3)    0.069    0.155    0.448    0.654
##   ddlpfc21 ~                                          
##     pdlpfc1 (bet2)   -0.077    0.379   -0.204    0.839
##     pef1    (bet4)    0.067    0.425    0.157    0.875
##   ddlpfc32 ~                                          
##     pdlpfc2 (bet2)   -0.077    0.379   -0.204    0.839
##     pef2    (bet4)    0.067    0.425    0.157    0.875
##   ddlpfc43 ~                                          
##     pdlpfc3 (bet2)   -0.077    0.379   -0.204    0.839
##     pef3    (bet4)    0.067    0.425    0.157    0.875
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int.ef ~~                                           
##     slp.ef           -0.118    0.244   -0.483    0.629
##   int.dlpfc ~~                                        
##     slp.dlpfc        -0.085    0.197   -0.430    0.667
##   int.ef ~~                                           
##     int.dlpfc         0.064    0.043    1.466    0.143
##     slp.dlpfc        -0.032    0.164   -0.193    0.847
##   slp.ef ~~                                           
##     int.dlpfc        -0.046    0.088   -0.525    0.600
##     slp.dlpfc         0.013    0.041    0.330    0.742
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ef1               0.000                           
##    .ef2               0.000                           
##    .ef3               0.000                           
##    .ef4               0.000                           
##    .dlpfc1            0.000                           
##    .dlpfc2            0.000                           
##    .dlpfc3            0.000                           
##    .dlpfc4            0.000                           
##     int.ef            2.417    0.043   56.656    0.000
##     slp.ef           -0.600    1.414   -0.424    0.671
##     int.dlpfc         0.541    0.054    9.978    0.000
##     slp.dlpfc         0.007    0.900    0.008    0.994
##    .pef1              0.000                           
##    .pef2              0.000                           
##    .pef3              0.000                           
##    .pef4              0.000                           
##    .pdlpfc1           0.000                           
##    .pdlpfc2           0.000                           
##    .pdlpfc3           0.000                           
##    .pdlpfc4           0.000                           
##    .def21             0.000                           
##    .def32             0.000                           
##    .def43             0.000                           
##    .ddlpfc21          0.000                           
##    .ddlpfc32          0.000                           
##    .ddlpfc43          0.000                           
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ef1               0.242    0.040    6.105    0.000
##    .pef1              0.000                           
##    .ef2               0.258    0.028    9.325    0.000
##    .pef2              0.000                           
##    .ef3               0.269    0.033    8.177    0.000
##    .pef3              0.000                           
##    .ef4               0.096    0.074    1.296    0.195
##    .pef4              0.000                           
##    .dlpfc1            0.219    0.130    1.689    0.091
##    .pdlpfc1           0.000                           
##    .dlpfc2            0.571    0.060    9.447    0.000
##    .pdlpfc2           0.000                           
##    .dlpfc3            0.573    0.060    9.489    0.000
##    .pdlpfc3           0.000                           
##    .dlpfc4            0.415    0.105    3.966    0.000
##    .pdlpfc4           0.000                           
##    .def21             0.000                           
##    .def32             0.000                           
##    .def43             0.000                           
##    .ddlpfc21          0.000                           
##    .ddlpfc32          0.000                           
##    .ddlpfc43          0.000                           
##     int.ef            0.427    0.048    8.873    0.000
##     slp.ef            0.053    0.114    0.462    0.644
##     int.dlpfc         0.788    0.136    5.791    0.000
##     slp.dlpfc         0.080    0.031    2.614    0.009</code></pre>
<p>This absolute wall of syntax specifies a really compelling model of change. Not only does change depend on the prior level within a variable, it also depends on the prior level of the other variable in the model. These non-linearities can provide a powerful and flexible tool to assess reciprocal relationships among variables as they travel together over time. Now that we have a taste of the power, we can turn to the process of fitting multivariate models in the MLM.</p>
<p>Unfortunately, the MLM is fundamentally a univariate model that we will need to trick in order to turn into a multivariate model. To do so, we need to do some data management to combine our two outcomes (<code>ef</code> and <code>dlpfc</code>) into a single column. However, to keep track of which values correspond to which outcome, we will also create a set of dummy codes that indicate the original variable. The easiest way to do this is to begin by stacking our data frame on top of itself and then generating these new variables.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="05-covariates.html#cb219-1" aria-hidden="true" tabindex="-1"></a>multivar.long <span class="ot">&lt;-</span> <span class="fu">rbind</span>(executive.function.long, executive.function.long)</span>
<span id="cb219-2"><a href="05-covariates.html#cb219-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-3"><a href="05-covariates.html#cb219-3" aria-hidden="true" tabindex="-1"></a>multivar.long<span class="sc">$</span>dv <span class="ot">&lt;-</span> <span class="fu">c</span>(executive.function.long<span class="sc">$</span>ef, executive.function.long<span class="sc">$</span>dlpfc)</span>
<span id="cb219-4"><a href="05-covariates.html#cb219-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-5"><a href="05-covariates.html#cb219-5" aria-hidden="true" tabindex="-1"></a>multivar.long<span class="sc">$</span>ef_dummy <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(executive.function.long)),</span>
<span id="cb219-6"><a href="05-covariates.html#cb219-6" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(executive.function.long)))</span>
<span id="cb219-7"><a href="05-covariates.html#cb219-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-8"><a href="05-covariates.html#cb219-8" aria-hidden="true" tabindex="-1"></a>multivar.long<span class="sc">$</span>dlpfc_dummy <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(executive.function.long)),</span>
<span id="cb219-9"><a href="05-covariates.html#cb219-9" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(executive.function.long)))</span>
<span id="cb219-10"><a href="05-covariates.html#cb219-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-11"><a href="05-covariates.html#cb219-11" aria-hidden="true" tabindex="-1"></a>multivar.long<span class="sc">$</span>dv_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(multivar.long<span class="sc">$</span>ef_dummy, </span>
<span id="cb219-12"><a href="05-covariates.html#cb219-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb219-13"><a href="05-covariates.html#cb219-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;DLPFC&quot;</span>, <span class="st">&quot;EF&quot;</span>))</span>
<span id="cb219-14"><a href="05-covariates.html#cb219-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-15"><a href="05-covariates.html#cb219-15" aria-hidden="true" tabindex="-1"></a>multivar.long <span class="ot">&lt;-</span> multivar.long <span class="sc">%&gt;%</span></span>
<span id="cb219-16"><a href="05-covariates.html#cb219-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(id)</span></code></pre></div>
<p>It’s helpful to visualize what this results in for our data. We can display the first three participants’ data below.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="05-covariates.html#cb220-1" aria-hidden="true" tabindex="-1"></a>multivar.long <span class="sc">%&gt;%</span> <span class="fu">filter</span>(id <span class="sc">&lt;=</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb220-2"><a href="05-covariates.html#cb220-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">label =</span> <span class="cn">NA</span>,</span>
<span id="cb220-3"><a href="05-covariates.html#cb220-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">format =</span> <span class="st">&quot;html&quot;</span>,</span>
<span id="cb220-4"><a href="05-covariates.html#cb220-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb220-5"><a href="05-covariates.html#cb220-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">booktabs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb220-6"><a href="05-covariates.html#cb220-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">escape =</span> <span class="cn">FALSE</span>,</span>
<span id="cb220-7"><a href="05-covariates.html#cb220-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">&quot;**Executive Function Multivariate Data**&quot;</span>,</span>
<span id="cb220-8"><a href="05-covariates.html#cb220-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="st">&quot;c&quot;</span>,</span>
<span id="cb220-9"><a href="05-covariates.html#cb220-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb220-10"><a href="05-covariates.html#cb220-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="at">row =</span> <span class="dv">0</span>, <span class="at">align =</span> <span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<table>
<caption>
<strong>Executive Function Multivariate Data</strong>
</caption>
<thead>
<tr>
<th style="text-align:center;text-align: center;">
id
</th>
<th style="text-align:center;text-align: center;">
sex
</th>
<th style="text-align:center;text-align: center;">
tx
</th>
<th style="text-align:center;text-align: center;">
wave
</th>
<th style="text-align:center;text-align: center;">
dlpfc
</th>
<th style="text-align:center;text-align: center;">
ef
</th>
<th style="text-align:center;text-align: center;">
age
</th>
<th style="text-align:center;text-align: center;">
dlpfc.lag
</th>
<th style="text-align:center;text-align: center;">
dv
</th>
<th style="text-align:center;text-align: center;">
ef_dummy
</th>
<th style="text-align:center;text-align: center;">
dlpfc_dummy
</th>
<th style="text-align:center;text-align: center;">
dv_factor
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
-0.184
</td>
<td style="text-align:center;">
2.167
</td>
<td style="text-align:center;">
0.285
</td>
<td style="text-align:center;">
0.000
</td>
<td style="text-align:center;">
2.167
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
EF
</td>
</tr>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1.129
</td>
<td style="text-align:center;">
1.806
</td>
<td style="text-align:center;">
1.316
</td>
<td style="text-align:center;">
-0.184
</td>
<td style="text-align:center;">
1.806
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
EF
</td>
</tr>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
-0.840
</td>
<td style="text-align:center;">
1.444
</td>
<td style="text-align:center;">
2.332
</td>
<td style="text-align:center;">
1.129
</td>
<td style="text-align:center;">
1.444
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
EF
</td>
</tr>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
0.472
</td>
<td style="text-align:center;">
2.889
</td>
<td style="text-align:center;">
3.370
</td>
<td style="text-align:center;">
-0.840
</td>
<td style="text-align:center;">
2.889
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
EF
</td>
</tr>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
-0.184
</td>
<td style="text-align:center;">
2.167
</td>
<td style="text-align:center;">
0.285
</td>
<td style="text-align:center;">
0.000
</td>
<td style="text-align:center;">
-0.184
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
DLPFC
</td>
</tr>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1.129
</td>
<td style="text-align:center;">
1.806
</td>
<td style="text-align:center;">
1.316
</td>
<td style="text-align:center;">
-0.184
</td>
<td style="text-align:center;">
1.129
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
DLPFC
</td>
</tr>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
-0.840
</td>
<td style="text-align:center;">
1.444
</td>
<td style="text-align:center;">
2.332
</td>
<td style="text-align:center;">
1.129
</td>
<td style="text-align:center;">
-0.840
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
DLPFC
</td>
</tr>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
0.472
</td>
<td style="text-align:center;">
2.889
</td>
<td style="text-align:center;">
3.370
</td>
<td style="text-align:center;">
-0.840
</td>
<td style="text-align:center;">
0.472
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
DLPFC
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.801
</td>
<td style="text-align:center;">
0.722
</td>
<td style="text-align:center;">
0.347
</td>
<td style="text-align:center;">
0.000
</td>
<td style="text-align:center;">
0.722
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
EF
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1.129
</td>
<td style="text-align:center;">
1.444
</td>
<td style="text-align:center;">
1.382
</td>
<td style="text-align:center;">
0.801
</td>
<td style="text-align:center;">
1.444
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
EF
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
0.801
</td>
<td style="text-align:center;">
1.806
</td>
<td style="text-align:center;">
2.256
</td>
<td style="text-align:center;">
1.129
</td>
<td style="text-align:center;">
1.806
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
EF
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
1.457
</td>
<td style="text-align:center;">
2.528
</td>
<td style="text-align:center;">
3.279
</td>
<td style="text-align:center;">
0.801
</td>
<td style="text-align:center;">
2.528
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
EF
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.801
</td>
<td style="text-align:center;">
0.722
</td>
<td style="text-align:center;">
0.347
</td>
<td style="text-align:center;">
0.000
</td>
<td style="text-align:center;">
0.801
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
DLPFC
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1.129
</td>
<td style="text-align:center;">
1.444
</td>
<td style="text-align:center;">
1.382
</td>
<td style="text-align:center;">
0.801
</td>
<td style="text-align:center;">
1.129
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
DLPFC
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
0.801
</td>
<td style="text-align:center;">
1.806
</td>
<td style="text-align:center;">
2.256
</td>
<td style="text-align:center;">
1.129
</td>
<td style="text-align:center;">
0.801
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
DLPFC
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
1.457
</td>
<td style="text-align:center;">
2.528
</td>
<td style="text-align:center;">
3.279
</td>
<td style="text-align:center;">
0.801
</td>
<td style="text-align:center;">
1.457
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
DLPFC
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.472
</td>
<td style="text-align:center;">
3.250
</td>
<td style="text-align:center;">
0.211
</td>
<td style="text-align:center;">
0.000
</td>
<td style="text-align:center;">
3.250
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
EF
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1.129
</td>
<td style="text-align:center;">
3.250
</td>
<td style="text-align:center;">
1.306
</td>
<td style="text-align:center;">
0.472
</td>
<td style="text-align:center;">
3.250
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
EF
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
0.144
</td>
<td style="text-align:center;">
2.528
</td>
<td style="text-align:center;">
2.079
</td>
<td style="text-align:center;">
1.129
</td>
<td style="text-align:center;">
2.528
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
EF
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
0.144
</td>
<td style="text-align:center;">
2.528
</td>
<td style="text-align:center;">
3.317
</td>
<td style="text-align:center;">
0.144
</td>
<td style="text-align:center;">
2.528
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
EF
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.472
</td>
<td style="text-align:center;">
3.250
</td>
<td style="text-align:center;">
0.211
</td>
<td style="text-align:center;">
0.000
</td>
<td style="text-align:center;">
0.472
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
DLPFC
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1.129
</td>
<td style="text-align:center;">
3.250
</td>
<td style="text-align:center;">
1.306
</td>
<td style="text-align:center;">
0.472
</td>
<td style="text-align:center;">
1.129
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
DLPFC
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
0.144
</td>
<td style="text-align:center;">
2.528
</td>
<td style="text-align:center;">
2.079
</td>
<td style="text-align:center;">
1.129
</td>
<td style="text-align:center;">
0.144
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
DLPFC
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
0.144
</td>
<td style="text-align:center;">
2.528
</td>
<td style="text-align:center;">
3.317
</td>
<td style="text-align:center;">
0.144
</td>
<td style="text-align:center;">
0.144
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
DLPFC
</td>
</tr>
</tbody>
</table>
<p>We’ve doubled the number of rows per participant and when <code>ef_dummy</code> <span class="math inline">\(= 1\)</span>, the value of <code>dv</code> is the same as <code>ef</code> and the same as <code>dlpfc</code> when <code>ef_dummy</code> <span class="math inline">\(= 0\)</span>. Creating the factor variable (<code>dv_factor</code>) is both to help us keep track of which value is which more easily and will play a role in structuring the covariance matrix in the model syntax.</p>
<p>In order to best approximate the full bivariate growth model we fit with the LCM, we need to fit a more-complex variance structure than is currently available in <strong>lmer</strong>. As such, we will return to <strong>nlme</strong> for this section. The syntax is a bit odd, so we will cover it in-depth before we fit the model. We will model the combined <code>dv</code> variable as a function of our constructed dummy variables and their interactions with <code>age</code>. We will not model an overall intercept (<code>dv ~ 0</code>) since <code>dv</code> is a combination of our two outcomes. Instead, our dummy codes (<code>ef_dummy</code> and <code>dlpfc_dummy</code>) will estimate our outcome-specific intercepts, and the interactions (<code>ef_dummy:age</code> and <code>dlpfc_dummy:age</code>) will estimate the outcome-specific slopes. We will include all of these effects in the <code>random</code> effects argument as well. We will estimate different residual variances for each outcome using the <code>weights</code> argument and nesting our estimates within our <code>dv_factor</code> (this must be a different variable than one that appears in our formula for some reason). We will updates some options in our <code>lmeControl()</code> function to aid in convergence.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="05-covariates.html#cb221-1" aria-hidden="true" tabindex="-1"></a>lmeCtlList <span class="ot">=</span> <span class="fu">lmeControl</span>(<span class="at">maxIter =</span> <span class="dv">10000</span>, <span class="at">msMaxIter =</span> <span class="dv">10000</span>, <span class="at">tolerance =</span> <span class="fl">1e-7</span>, <span class="at">niterEM =</span> <span class="dv">10000</span>,</span>
<span id="cb221-2"><a href="05-covariates.html#cb221-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">msMaxEval =</span> <span class="dv">10000</span>, <span class="at">msVerbose =</span> <span class="cn">FALSE</span>, <span class="at">returnObject =</span> <span class="cn">FALSE</span>,</span>
<span id="cb221-3"><a href="05-covariates.html#cb221-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">gradHess =</span> <span class="cn">TRUE</span>, <span class="at">opt =</span> <span class="st">&#39;optim&#39;</span>, <span class="at">optimMethod =</span> <span class="st">&#39;Nelder-Mead&#39;</span>)</span>
<span id="cb221-4"><a href="05-covariates.html#cb221-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-5"><a href="05-covariates.html#cb221-5" aria-hidden="true" tabindex="-1"></a>bivar.mod <span class="ot">=</span> <span class="fu">lme</span>(dv <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> ef_dummy <span class="sc">+</span> ef_dummy<span class="sc">:</span>age <span class="sc">+</span> dlpfc_dummy <span class="sc">+</span> dlpfc_dummy<span class="sc">:</span>age,</span>
<span id="cb221-6"><a href="05-covariates.html#cb221-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">random =</span> <span class="fu">list</span>(<span class="at">id =</span> <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> ef_dummy <span class="sc">+</span> ef_dummy<span class="sc">:</span>age <span class="sc">+</span> </span>
<span id="cb221-7"><a href="05-covariates.html#cb221-7" aria-hidden="true" tabindex="-1"></a>                                dlpfc_dummy <span class="sc">+</span> dlpfc_dummy<span class="sc">:</span>age),</span>
<span id="cb221-8"><a href="05-covariates.html#cb221-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> dv_factor),</span>
<span id="cb221-9"><a href="05-covariates.html#cb221-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">na.action =</span> na.omit,</span>
<span id="cb221-10"><a href="05-covariates.html#cb221-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">method =</span> <span class="st">&#39;REML&#39;</span>,</span>
<span id="cb221-11"><a href="05-covariates.html#cb221-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> multivar.long,</span>
<span id="cb221-12"><a href="05-covariates.html#cb221-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">control =</span> lmeCtlList)</span>
<span id="cb221-13"><a href="05-covariates.html#cb221-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-14"><a href="05-covariates.html#cb221-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bivar.mod, <span class="at">correlation =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed-effects model fit by REML
##   Data: multivar.long 
##        AIC      BIC    logLik
##   6096.803 6190.317 -3032.401
## 
## Random effects:
##  Formula: ~0 + ef_dummy + ef_dummy:age + dlpfc_dummy + dlpfc_dummy:age | id
##  Structure: General positive-definite, Log-Cholesky parametrization
##                 StdDev     Corr                
## ef_dummy        0.60518018 ef_dmm dlpfc_ ef_dm:
## dlpfc_dummy     0.84810498  0.164              
## ef_dummy:age    0.06661496  0.603  0.228       
## age:dlpfc_dummy 0.23083480 -0.162 -0.441  0.544
## Residual        0.51369758                     
## 
## Variance function:
##  Structure: Different standard deviations per stratum
##  Formula: ~1 | dv_factor 
##  Parameter estimates:
##       EF    DLPFC 
## 1.000000 1.359233 
## Fixed effects:  dv ~ 0 + ef_dummy + ef_dummy:age + dlpfc_dummy + dlpfc_dummy:age 
##                     Value  Std.Error   DF  t-value p-value
## ef_dummy        2.3978105 0.04222929 2211 56.78075   0e+00
## dlpfc_dummy     0.5165680 0.05809525 2211  8.89174   0e+00
## ef_dummy:age    0.0524502 0.01389671 2211  3.77429   2e-04
## age:dlpfc_dummy 0.1180178 0.02152941 2211  5.48170   0e+00
##  Correlation: 
##                 ef_dmm dlpfc_ ef_dm:
## dlpfc_dummy      0.101              
## ef_dummy:age    -0.383  0.045       
## age:dlpfc_dummy -0.074 -0.619  0.087
## 
## Standardized Within-Group Residuals:
##           Min            Q1           Med            Q3           Max 
## -3.2972806148 -0.5072575404  0.0006136973  0.5483199752  2.9557944969 
## 
## Number of Observations: 2556
## Number of Groups: 342</code></pre>
<p>While we do get the effects of interest with this model, there is an important remaining mis-specification. With the model above, we have to assume that the time-specific residuals are independent (covariances set to zero). This is a very untenable assumption, so we need to add a new argument to our model. The <code>correlation</code> argument in <strong>nlme</strong> allows us to correlate observations within a given <code>age</code>. Note that we nest that correlation within individual (<code>id</code>) and then age.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="05-covariates.html#cb223-1" aria-hidden="true" tabindex="-1"></a>bivar.mod <span class="ot">=</span> <span class="fu">lme</span>(dv <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> ef_dummy <span class="sc">+</span> ef_dummy<span class="sc">:</span>age <span class="sc">+</span> dlpfc_dummy <span class="sc">+</span> dlpfc_dummy<span class="sc">:</span>age,</span>
<span id="cb223-2"><a href="05-covariates.html#cb223-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">random =</span> <span class="fu">list</span>(<span class="at">id =</span> <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> ef_dummy <span class="sc">+</span> ef_dummy<span class="sc">:</span>age <span class="sc">+</span> </span>
<span id="cb223-3"><a href="05-covariates.html#cb223-3" aria-hidden="true" tabindex="-1"></a>                                dlpfc_dummy <span class="sc">+</span> dlpfc_dummy<span class="sc">:</span>age),</span>
<span id="cb223-4"><a href="05-covariates.html#cb223-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> dv_factor),</span>
<span id="cb223-5"><a href="05-covariates.html#cb223-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">correlation =</span> <span class="fu">corSymm</span>(<span class="at">form=</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> id <span class="sc">/</span> age),</span>
<span id="cb223-6"><a href="05-covariates.html#cb223-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">na.action =</span> na.omit,</span>
<span id="cb223-7"><a href="05-covariates.html#cb223-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">method =</span> <span class="st">&#39;REML&#39;</span>,</span>
<span id="cb223-8"><a href="05-covariates.html#cb223-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> multivar.long,</span>
<span id="cb223-9"><a href="05-covariates.html#cb223-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">control =</span> lmeCtlList)</span>
<span id="cb223-10"><a href="05-covariates.html#cb223-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-11"><a href="05-covariates.html#cb223-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bivar.mod, <span class="at">correlation =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed-effects model fit by REML
##   Data: multivar.long 
##        AIC      BIC   logLik
##   6098.521 6197.879 -3032.26
## 
## Random effects:
##  Formula: ~0 + ef_dummy + ef_dummy:age + dlpfc_dummy + dlpfc_dummy:age | id
##  Structure: General positive-definite, Log-Cholesky parametrization
##                 StdDev     Corr                
## ef_dummy        0.61734102 ef_dmm dlpfc_ ef_dm:
## dlpfc_dummy     0.84412177  0.124              
## ef_dummy:age    0.05911848  0.521  0.411       
## age:dlpfc_dummy 0.22681712 -0.121 -0.436  0.481
## Residual        0.51539308                     
## 
## Correlation Structure: General
##  Formula: ~1 | id/age 
##  Parameter estimate(s):
##  Correlation: 
##   1    
## 2 0.034
## Variance function:
##  Structure: Different standard deviations per stratum
##  Formula: ~1 | dv_factor 
##  Parameter estimates:
##       EF    DLPFC 
## 1.000000 1.359071 
## Fixed effects:  dv ~ 0 + ef_dummy + ef_dummy:age + dlpfc_dummy + dlpfc_dummy:age 
##                     Value  Std.Error   DF  t-value p-value
## ef_dummy        2.3968681 0.04279496 2211 56.00819   0e+00
## dlpfc_dummy     0.5166041 0.05799390 2211  8.90790   0e+00
## ef_dummy:age    0.0535814 0.01381578 2211  3.87827   1e-04
## age:dlpfc_dummy 0.1179464 0.02144521 2211  5.49989   0e+00
##  Correlation: 
##                 ef_dmm dlpfc_ ef_dm:
## dlpfc_dummy      0.089              
## ef_dummy:age    -0.409  0.058       
## age:dlpfc_dummy -0.069 -0.618  0.094
## 
## Standardized Within-Group Residuals:
##          Min           Q1          Med           Q3          Max 
## -3.313960152 -0.505059042  0.008674745  0.546833154  2.948330769 
## 
## Number of Observations: 2556
## Number of Groups: 342</code></pre>
<p>With this specification we do allow the residuals to correlate, but they are constrained to be equal across all of the time points in our model. Freeing this residual constraint to allow for unique correlations is possible, but requires us to fit the model in <strong>SAS</strong>. This model syntax will be provided in the downloadable files.</p>
</div>
<div id="within--and-betwen-person-variance" class="section level3">
<h3>Within- and Betwen-Person Variance</h3>
<p>In longitudinal models, we are deeply interested in understanding within-person processes (i.e., how individuals change over time). However, we need to be on guard against <em>between</em>-person differences masquerading as these within-person effects. For instance, there is a substantively different understanding of adolescent substance use if it is guided by within-person effects (e.g., adolescent are more likely to use illicit drugs when they are with their peers) versus between-person effects (e.g., adolescents with more friends are more likely to use illicit drugs). Unfortunately, we can often unintentionally conflate these two types of effects in our models. This happens because variables at level <span class="math inline">\(1\)</span> (e.g., TVCs) contain information about both within- (level <span class="math inline">\(1\)</span>) and between- (level <span class="math inline">\(2\)</span>) person differences. To take our example thus far, individuals might show higher or lower DLPFC activation relative to the last time they played the task (i.e., within-person differences) but also some individuals might consistently show higher (or lower) than average DLFPC activation relative to other individuals in the sample (i.e., between-person differences). We can return to our contemporaneous TVC model to demonstrate this principle. Below is the model we fit before.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="05-covariates.html#cb225-1" aria-hidden="true" tabindex="-1"></a>uncens.mlm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(ef <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> dlpfc <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> age <span class="sc">|</span> id),</span>
<span id="cb225-2"><a href="05-covariates.html#cb225-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">na.action =</span> na.omit,</span>
<span id="cb225-3"><a href="05-covariates.html#cb225-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">REML =</span> <span class="cn">TRUE</span>,</span>
<span id="cb225-4"><a href="05-covariates.html#cb225-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> executive.function.long,</span>
<span id="cb225-5"><a href="05-covariates.html#cb225-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>,</span>
<span id="cb225-6"><a href="05-covariates.html#cb225-6" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>)))</span>
<span id="cb225-7"><a href="05-covariates.html#cb225-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-8"><a href="05-covariates.html#cb225-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(uncens.mlm, <span class="at">correlation =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [&#39;lmerModLmerTest&#39;]
## Formula: ef ~ 1 + age + dlpfc + (1 + age | id)
##    Data: executive.function.long
## Control: lmerControl(optimizer = &quot;bobyqa&quot;, optCtrl = list(maxfun = 2e+05))
## 
## REML criterion at convergence: 2550
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.2978 -0.4809  0.0377  0.5297  3.1320 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr 
##  id       (Intercept) 0.42998  0.6557        
##           age         0.01877  0.1370   -0.10
##  Residual             0.23913  0.4890        
## Number of obs: 1241, groups:  id, 342
## 
## Fixed effects:
##              Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept) 2.371e+00  4.505e-02 3.626e+02  52.623  &lt; 2e-16 ***
## age         4.610e-02  1.516e-02 2.951e+02   3.041  0.00257 ** 
## dlpfc       5.633e-02  2.062e-02 1.197e+03   2.732  0.00638 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>So now we know that the coefficient associated with the <code>dlpfc</code> predictor is a weighted combination of the within- and between-person effect. We can apply well-known principles of variable centering in the MLM in order to separate out these effects. For a more in-depth treatment of these approaches, see <a href="">Curran &amp; Bauer (2011)</a>. The first approach is called <strong>grand-mean</strong> centering. Here we do something relatively intuitive and simply subtract the mean of all of the observations of <code>dlpfc</code> across individuals to create <code>dlpfc.grdcent</code>. This simply makes the zero-point of <code>dlpfc</code> represent the mean of the variable. Unsurprisingly, this simple linear transformation of our model will not change the model results except to change the interpretation of the intercept (i.e., the expected value of the outcome when all predictors are zero will change because the zero-point of <code>dlpfc.grdcent</code> has changed). However, the effect of <code>dlpfc.grdcent</code> will still confound the within- and between-person effects.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="05-covariates.html#cb227-1" aria-hidden="true" tabindex="-1"></a>executive.function.long <span class="ot">&lt;-</span> executive.function.long <span class="sc">%&gt;%</span></span>
<span id="cb227-2"><a href="05-covariates.html#cb227-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dlpfc.grdcent =</span> dlpfc <span class="sc">-</span> </span>
<span id="cb227-3"><a href="05-covariates.html#cb227-3" aria-hidden="true" tabindex="-1"></a>           <span class="fu">mean</span>(executive.function.long<span class="sc">$</span>dlpfc, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb227-4"><a href="05-covariates.html#cb227-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-5"><a href="05-covariates.html#cb227-5" aria-hidden="true" tabindex="-1"></a>grdcent.mlm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(ef <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> dlpfc.grdcent <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> age <span class="sc">|</span> id),</span>
<span id="cb227-6"><a href="05-covariates.html#cb227-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">na.action =</span> na.omit,</span>
<span id="cb227-7"><a href="05-covariates.html#cb227-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">REML =</span> <span class="cn">TRUE</span>,</span>
<span id="cb227-8"><a href="05-covariates.html#cb227-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> executive.function.long,</span>
<span id="cb227-9"><a href="05-covariates.html#cb227-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>,</span>
<span id="cb227-10"><a href="05-covariates.html#cb227-10" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>)))</span>
<span id="cb227-11"><a href="05-covariates.html#cb227-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-12"><a href="05-covariates.html#cb227-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(grdcent.mlm, <span class="at">correlation =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [&#39;lmerModLmerTest&#39;]
## Formula: ef ~ 1 + age + dlpfc.grdcent + (1 + age | id)
##    Data: executive.function.long
## Control: lmerControl(optimizer = &quot;bobyqa&quot;, optCtrl = list(maxfun = 2e+05))
## 
## REML criterion at convergence: 2550
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.2978 -0.4809  0.0377  0.5297  3.1320 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr 
##  id       (Intercept) 0.42998  0.6557        
##           age         0.01877  0.1370   -0.10
##  Residual             0.23913  0.4890        
## Number of obs: 1241, groups:  id, 342
## 
## Fixed effects:
##                Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)   2.411e+00  4.393e-02 3.372e+02  54.886  &lt; 2e-16 ***
## age           4.610e-02  1.516e-02 2.951e+02   3.041  0.00257 ** 
## dlpfc.grdcent 5.633e-02  2.062e-02 1.197e+03   2.732  0.00638 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>In order to disaggregate these effects, we need to include the person-specific means of <code>dlpfc</code> as an additional predictor. Creating this variable is straightforward, we will just need to remember to do the mean operation <em>within-person</em> by using the <code>group_by(id)</code> function. The syntax for this model is below.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="05-covariates.html#cb229-1" aria-hidden="true" tabindex="-1"></a>executive.function.long <span class="ot">&lt;-</span> executive.function.long <span class="sc">%&gt;%</span></span>
<span id="cb229-2"><a href="05-covariates.html#cb229-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb229-3"><a href="05-covariates.html#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dlpfc.mean =</span> <span class="fu">mean</span>(dlpfc, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb229-4"><a href="05-covariates.html#cb229-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-5"><a href="05-covariates.html#cb229-5" aria-hidden="true" tabindex="-1"></a>grdcent.mlm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(ef <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> dlpfc.grdcent <span class="sc">+</span> dlpfc.mean <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> age <span class="sc">|</span> id),</span>
<span id="cb229-6"><a href="05-covariates.html#cb229-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">na.action =</span> na.omit,</span>
<span id="cb229-7"><a href="05-covariates.html#cb229-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">REML =</span> <span class="cn">TRUE</span>,</span>
<span id="cb229-8"><a href="05-covariates.html#cb229-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> executive.function.long,</span>
<span id="cb229-9"><a href="05-covariates.html#cb229-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>,</span>
<span id="cb229-10"><a href="05-covariates.html#cb229-10" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>)))</span>
<span id="cb229-11"><a href="05-covariates.html#cb229-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-12"><a href="05-covariates.html#cb229-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(grdcent.mlm, <span class="at">correlation =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [&#39;lmerModLmerTest&#39;]
## Formula: ef ~ 1 + age + dlpfc.grdcent + dlpfc.mean + (1 + age | id)
##    Data: executive.function.long
## Control: lmerControl(optimizer = &quot;bobyqa&quot;, optCtrl = list(maxfun = 2e+05))
## 
## REML criterion at convergence: 2551.5
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.2992 -0.4855  0.0375  0.5286  3.1170 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr 
##  id       (Intercept) 0.43366  0.6585        
##           age         0.01899  0.1378   -0.13
##  Residual             0.23880  0.4887        
## Number of obs: 1241, groups:  id, 342
## 
## Fixed effects:
##                Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)     2.34839    0.05851 472.22497  40.136  &lt; 2e-16 ***
## age             0.04825    0.01522 295.72959   3.171  0.00168 ** 
## dlpfc.grdcent   0.03965    0.02308 889.69637   1.718  0.08613 .  
## dlpfc.mean      0.08332    0.05105 507.67410   1.632  0.10328    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>By conditioning the effect of <code>dlpfc.grdcent</code> on the effect of <code>dlpfc.mean</code>, we get a pure estimate of the within-person effect of DLPFC activation on executive function scores. The effect of <code>dlpfc.mean</code> itself is a little harder to interpret. With grand-mean centering, the effect of <code>dlpfc.mean</code> represents the <em>difference</em> between the within- and between-person effect. If we wish to compute the between-person effect itself, we can linearly combine the parameter estimates using the <code>contest1D()</code> function from the <strong>lmerTest</strong> package. This function will compute both the point estimate and inferential test for the computed parameter. The vector of weights (<code>c(0, 0, 1, 1)</code>) tells the function to ignore the <code>(Intercept)</code> and <code>age</code> coefficients and to add the <code>dlpfc.grdcent</code> (within-person effect) and <code>dlpfc.mean</code> (between- minus within-person effect) coefficients together. Since the within-person effects cancel each other out in this equation, we are left with the pure between-person effect.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="05-covariates.html#cb231-1" aria-hidden="true" tabindex="-1"></a>lmerTest<span class="sc">::</span><span class="fu">contest1D</span>(grdcent.mlm, <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<pre><code>##    Estimate Std. Error       df  t value    Pr(&gt;|t|)
## 1 0.1229694 0.04560471 330.8157 2.696419 0.007367606</code></pre>
<p>We can see that the between-person effect (<span class="math inline">\(\gamma = 0.123\)</span>) is substantially larger than the within-person effect (<span class="math inline">\(\gamma = 0.040\)</span>).</p>
<p>While the grand-mean centering approach is relatively intuitive in the centering process (simply subtract a single value from all observations), the effects it produces are less intuitive. We must include the person-specific means in the model to get de-confounded effects, and the effect of the person-specific means is not always what we wish to interpret and we run the risk of mis-interpreting it as the between-person effect itself rather than the difference in effects. Thus, we might wish to consider an alternative centering approach.</p>
<p>This alternative is group-mean centering. Unlike grand-mean centering, here we will subtract a <em>different</em> value (namely the person-mean) from each person’s observations. As such, our new predictor (<code>dlpfc.grpcent</code>) is fundamentally different from the original <code>dlpfc</code> variable because we have removed all mean differences between individuals from the new variable. Because we have discarded this information, the group-mean centered variable can give us a pure estimate of the within-person effect even if we do not include the group means in the model. As such, if we only care about the within-person effect, we can obtain that effect without needing to include the additional predictor in the model. We can see this model below.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="05-covariates.html#cb233-1" aria-hidden="true" tabindex="-1"></a>executive.function.long <span class="ot">&lt;-</span> executive.function.long <span class="sc">%&gt;%</span></span>
<span id="cb233-2"><a href="05-covariates.html#cb233-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dlpfc.grpcent =</span> dlpfc <span class="sc">-</span> dlpfc.mean)</span>
<span id="cb233-3"><a href="05-covariates.html#cb233-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-4"><a href="05-covariates.html#cb233-4" aria-hidden="true" tabindex="-1"></a>grpcent.mlm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(ef <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> dlpfc.grpcent <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> age <span class="sc">|</span> id),</span>
<span id="cb233-5"><a href="05-covariates.html#cb233-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">na.action =</span> na.omit,</span>
<span id="cb233-6"><a href="05-covariates.html#cb233-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">REML =</span> <span class="cn">TRUE</span>,</span>
<span id="cb233-7"><a href="05-covariates.html#cb233-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> executive.function.long,</span>
<span id="cb233-8"><a href="05-covariates.html#cb233-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>,</span>
<span id="cb233-9"><a href="05-covariates.html#cb233-9" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>)))</span>
<span id="cb233-10"><a href="05-covariates.html#cb233-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-11"><a href="05-covariates.html#cb233-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(grpcent.mlm, <span class="at">correlation =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [&#39;lmerModLmerTest&#39;]
## Formula: ef ~ 1 + age + dlpfc.grpcent + (1 + age | id)
##    Data: executive.function.long
## Control: lmerControl(optimizer = &quot;bobyqa&quot;, optCtrl = list(maxfun = 2e+05))
## 
## REML criterion at convergence: 2554.3
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.3069 -0.4910  0.0335  0.5368  3.1355 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr 
##  id       (Intercept) 0.43351  0.6584        
##           age         0.01883  0.1372   -0.08
##  Residual             0.23884  0.4887        
## Number of obs: 1241, groups:  id, 342
## 
## Fixed effects:
##                Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)     2.40789    0.04407 338.52746  54.639  &lt; 2e-16 ***
## age             0.04769    0.01521 296.02312   3.136  0.00188 ** 
## dlpfc.grpcent   0.03948    0.02305 888.90401   1.713  0.08710 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>If we are interested in both the within- and between-person effects; however, we can include the person-specific means (<code>dlpfc.mean</code>) as we did before. As an added bonus, the effect of <code>dlpfc.mean</code> is a pure estimate of the between-person effect without needing to do any additional transformations.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="05-covariates.html#cb235-1" aria-hidden="true" tabindex="-1"></a>grpcent.mlm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(ef <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> dlpfc.grpcent <span class="sc">+</span> dlpfc.mean <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> age <span class="sc">|</span> id),</span>
<span id="cb235-2"><a href="05-covariates.html#cb235-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">na.action =</span> na.omit,</span>
<span id="cb235-3"><a href="05-covariates.html#cb235-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">REML =</span> <span class="cn">TRUE</span>,</span>
<span id="cb235-4"><a href="05-covariates.html#cb235-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> executive.function.long,</span>
<span id="cb235-5"><a href="05-covariates.html#cb235-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>,</span>
<span id="cb235-6"><a href="05-covariates.html#cb235-6" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>)))</span>
<span id="cb235-7"><a href="05-covariates.html#cb235-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-8"><a href="05-covariates.html#cb235-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(grpcent.mlm, <span class="at">correlation =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [&#39;lmerModLmerTest&#39;]
## Formula: ef ~ 1 + age + dlpfc.grpcent + dlpfc.mean + (1 + age | id)
##    Data: executive.function.long
## Control: lmerControl(optimizer = &quot;bobyqa&quot;, optCtrl = list(maxfun = 2e+05))
## 
## REML criterion at convergence: 2551.5
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.2992 -0.4855  0.0375  0.5286  3.1170 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr 
##  id       (Intercept) 0.43366  0.6585        
##           age         0.01899  0.1378   -0.13
##  Residual             0.23880  0.4887        
## Number of obs: 1241, groups:  id, 342
## 
## Fixed effects:
##                Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)     2.31971    0.05478 377.98608  42.345  &lt; 2e-16 ***
## age             0.04825    0.01522 295.72959   3.171  0.00168 ** 
## dlpfc.grpcent   0.03965    0.02308 889.69639   1.718  0.08613 .  
## dlpfc.mean      0.12297    0.04560 330.81567   2.696  0.00737 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Of course, if we wished to get the difference in effects, we can compute it from this model (essentially the inverse of what we did previously). Here we subtract the within-person effect from the between-person effect.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="05-covariates.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contest1D</span>(grpcent.mlm, <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<pre><code>##     Estimate Std. Error      df  t value Pr(&gt;|t|)
## 1 0.08332361 0.05105263 507.674 1.632112 0.103276</code></pre>
<p>Fortunately for us, we have already seen one of the primary methods for separating within- versus between-person effects in the SEM: the LCM-SR. In these models, all of the between-person effects are isolated to the level of the latent factors, while the within-person effects are isolated to the residuals of the repeated measures. If we have a TVC model, our grand- or group-mean centered variables enter as preditors of the repeated measure residuals, while the person-specific means enter as predictors of the latent factors. While this is equivalent to the MLM in the case of TVCs, the expanded capacity of the SEM allows us to include multiple outcomes and reciprocal effects between different constructs traveling together across time. With the growth factors isolating the between-person effects, these reciprocal effects represent pure estimates of within-person effects.</p>
</div>
</div>
<div id="distal-outcomes" class="section level2">
<h2>Distal Outcomes</h2>
<p>Up until this point, we have considered how to include predictors in our growth models to explain individual differences in patterns of change over time. However, if we think that these differences in developmental trajectories <em>mean anything</em> (and we’d like to think they do), we might wish to predict some future outcome that is meaningful for our theoretical question of interest. For instance, do greater increases in executive function scores during adolescence predict greater education attainment, lifetime earnings, or reduced contact with criminal-legal institutions? Such questions are uncomfortably rare in developmental cognitive neuroscience, leaving a big opening for questions of “<strong>so what?</strong>” for our programs of research. Commensurate with their relative scarcity in substantive research, much less work has gone into the development of quantitative methods and best-practices for distal outcome prediction. As such, readers should take the methods presented in this section as a work-in-progress, awaiting further developments (some of which we can confidently say are in the works).</p>
<p>For this section, we will draw the <code>externalizing</code> data from our <code>external.math</code> data set. However, here we have included data from a follow-up study on lifetime incarceration as of age <span class="math inline">\(35\)</span>. As such, we can predict the likelihood of an individual experiencing incarceration as an adult based on trajectory information from when they were in early adolescence.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="05-covariates.html#cb239-1" aria-hidden="true" tabindex="-1"></a>externalizing <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/externalizing-outcome.csv&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb239-2"><a href="05-covariates.html#cb239-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-3"><a href="05-covariates.html#cb239-3" aria-hidden="true" tabindex="-1"></a>externalizing.long <span class="ot">&lt;-</span> externalizing <span class="sc">%&gt;%</span> </span>
<span id="cb239-4"><a href="05-covariates.html#cb239-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;ext&quot;</span>), </span>
<span id="cb239-5"><a href="05-covariates.html#cb239-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;.value&quot;</span>, <span class="st">&quot;age&quot;</span>), </span>
<span id="cb239-6"><a href="05-covariates.html#cb239-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_pattern =</span> <span class="st">&quot;(ext)(.+)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb239-7"><a href="05-covariates.html#cb239-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> <span class="fu">as.numeric</span>(age))</span></code></pre></div>
<p>In the MEMs, outcome prediction usually proceeds via a two-step procedure (with <strong>Mplus</strong> again being an exception for reasons we have already discussed). As such, we fit the growth model to the repeated measures data, obtain individual estimates of the random effects, and then predict the distal outcome in a second regression analysis. The linear model we fit will be familiar to use, and then we can use the <code>ranef()</code> function from <strong>lme4</strong> to obtain our estimates of the random effects. Note that these are Empirical Bayes (EB) estimates of the random effects, which have som enice statistical properties. For our purposes, we should know that EB estimates are “shrunken” meaning that individuals with more extreme values and those individuals with that contribute fewer data points to the model are shrunk towards the mean effect. This helps to reduce outliers and differences in reliability for individual estimates based on smaller numbers of repeated measures. We can see the code to obtain these effects below.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="05-covariates.html#cb240-1" aria-hidden="true" tabindex="-1"></a>distal.mlm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(ext <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> age <span class="sc">|</span> id),</span>
<span id="cb240-2"><a href="05-covariates.html#cb240-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">na.action =</span> na.omit,</span>
<span id="cb240-3"><a href="05-covariates.html#cb240-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">REML =</span> <span class="cn">TRUE</span>,</span>
<span id="cb240-4"><a href="05-covariates.html#cb240-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> externalizing.long,</span>
<span id="cb240-5"><a href="05-covariates.html#cb240-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>,</span>
<span id="cb240-6"><a href="05-covariates.html#cb240-6" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>)))</span>
<span id="cb240-7"><a href="05-covariates.html#cb240-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-8"><a href="05-covariates.html#cb240-8" aria-hidden="true" tabindex="-1"></a>random.effs <span class="ot">&lt;-</span> <span class="fu">ranef</span>(distal.mlm)<span class="sc">$</span>id</span>
<span id="cb240-9"><a href="05-covariates.html#cb240-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(random.effs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;int&quot;</span>, <span class="st">&quot;slp&quot;</span>)</span>
<span id="cb240-10"><a href="05-covariates.html#cb240-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-11"><a href="05-covariates.html#cb240-11" aria-hidden="true" tabindex="-1"></a>externalizing <span class="ot">&lt;-</span> <span class="fu">cbind</span>(externalizing, random.effs)</span></code></pre></div>
<p>Now that we have obtained these EB estimates, we can bring them into the secondary regression analysis. Here our outcome of lifetime incarceration (<code>incarc</code>) is binary ($0 = $ “never incarcerated”, $1 = $ “ever incarcerated”), so we will utilize the <code>glm()</code> function (“generalized linear model”) instead of <code>lm()</code> (“general linear model”) to deal with the discrete nature of our outcome. While we won’t spend much time on the distinctions between linear and nonlinear models, see <a href="https://quantdev.ssri.psu.edu/tutorials/regression-continuous-count-and-binary-outcomes">here</a> for a great general review of the topic in R.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="05-covariates.html#cb241-1" aria-hidden="true" tabindex="-1"></a>distal.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(incarc <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> int <span class="sc">+</span> slp,</span>
<span id="cb241-2"><a href="05-covariates.html#cb241-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb241-3"><a href="05-covariates.html#cb241-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> externalizing)</span>
<span id="cb241-4"><a href="05-covariates.html#cb241-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-5"><a href="05-covariates.html#cb241-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(distal.glm)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = incarc ~ 1 + int + slp, family = &quot;binomial&quot;, data = externalizing)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.7151  -0.3186  -0.2004  -0.1445   2.8305  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   -3.391      0.318 -10.666   &lt;2e-16 ***
## int            2.875      1.270   2.263   0.0236 *  
## slp            5.710      3.274   1.744   0.0811 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 203.63  on 404  degrees of freedom
## Residual deviance: 149.99  on 402  degrees of freedom
## AIC: 155.99
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="05-covariates.html#cb243-1" aria-hidden="true" tabindex="-1"></a>externalizing <span class="ot">&lt;-</span> externalizing <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(int, slp))</span></code></pre></div>
<p>We can see that while the intercept of the trajectory has a significant positive prospective effect on the propensity for individuals to experience lifetime incarceration, the slope is not significant (so close; more on that in a bit). Essentially, those adolescents who show higher initial levels of antisocial behavior are more likely to report being incarcerated at some point in their lifetime. The coefficients we see in this model represent the log-odds parameters. You might see these reported in the odds scale, which just involves the exponentiation of these parameters. We can see this below and generate confidence intervals on the odds parameters.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="05-covariates.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">cbind</span>(<span class="fu">coef</span>(distal.glm), <span class="fu">confint</span>(distal.glm)))</span></code></pre></div>
<pre><code>##                               2.5 %       97.5 %
## (Intercept)   0.03366191 0.01685404 5.927967e-02
## int          17.72246349 1.49556757 2.248848e+02
## slp         301.85964003 0.51755237 2.085331e+05</code></pre>
<p>So for a one unit increase in the trajectory intercept, we expect a 17.72 change in the odds of being incarcerated, and a substantial increase of 301.85 in the odds for a per-unit change in the slope of the trajectory (again not significant but we can play out this exercise). One reason we often need to be careful about these “per one unit” changes in the trajectory parameters, especially for the slope, is that often the parameters do not have large ranges. Indeed, often the full range of the slope parameter will not extend over an entire unit because of the way it is scaled (in per time-unit change). We can see this when we plot the predicted probabilities of incarceration against the trajectory parameters. Note that to get the predicted probabilities, we simply divide the odds by <span class="math inline">\(1\)</span> plus the odds. So <span class="math inline">\(P(incarc_{i} = 1) = e^{log-odds} / 1 + e^{log-odds}\)</span>. We can see this below.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="05-covariates.html#cb246-1" aria-hidden="true" tabindex="-1"></a>random.effs <span class="ot">&lt;-</span> random.effs <span class="sc">%&gt;%</span></span>
<span id="cb246-2"><a href="05-covariates.html#cb246-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">incarc =</span> externalizing<span class="sc">$</span>incarc,</span>
<span id="cb246-3"><a href="05-covariates.html#cb246-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">pred =</span> stats<span class="sc">::</span><span class="fu">predict.glm</span>(distal.glm)) <span class="sc">%&gt;%</span></span>
<span id="cb246-4"><a href="05-covariates.html#cb246-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred.prob =</span> <span class="fu">exp</span>(pred) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(pred)))</span>
<span id="cb246-5"><a href="05-covariates.html#cb246-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(random.effs)</span></code></pre></div>
<pre><code>##           int         slp incarc      pred   pred.prob
## 1 -0.08707305 -0.10376294      0 -4.234191 0.014284520
## 2 -0.10130152 -0.03397105      0 -3.876587 0.020300771
## 3 -0.29188615 -0.08666453      0 -4.725364 0.008789548
## 4  0.42109753  0.13725150      0 -1.397103 0.198276302
## 5  0.26380031  0.20359046      1 -1.470513 0.186864687
## 6  0.21702008  0.10030029      0 -2.194781 0.100220132</code></pre>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="05-covariates.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(random.effs, <span class="fu">aes</span>(<span class="at">x =</span> int, <span class="at">y =</span> incarc)) <span class="sc">+</span></span>
<span id="cb248-2"><a href="05-covariates.html#cb248-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(incarc)), <span class="at">shape =</span> <span class="st">&quot;|&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  </span>
<span id="cb248-3"><a href="05-covariates.html#cb248-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> random.effs, </span>
<span id="cb248-4"><a href="05-covariates.html#cb248-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> int, <span class="at">y =</span> pred.prob, <span class="at">color =</span> <span class="fu">factor</span>(incarc))) <span class="sc">+</span>  </span>
<span id="cb248-5"><a href="05-covariates.html#cb248-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb248-6"><a href="05-covariates.html#cb248-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>), <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb248-7"><a href="05-covariates.html#cb248-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Plotting Predicted Probabilities of Lifetime Incarceration&quot;</span>,</span>
<span id="cb248-8"><a href="05-covariates.html#cb248-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Intercept (Wave 1) of Adolescent Antisocial Behavior&quot;</span>,</span>
<span id="cb248-9"><a href="05-covariates.html#cb248-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Predicted Probability of Incarceration&quot;</span>) <span class="sc">+</span> </span>
<span id="cb248-10"><a href="05-covariates.html#cb248-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="longitudinal_primer_files/figure-html/outcomes%2004-1.png" width="672" /></p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="05-covariates.html#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(random.effs, <span class="fu">aes</span>(<span class="at">x =</span> slp, <span class="at">y =</span> incarc)) <span class="sc">+</span></span>
<span id="cb249-2"><a href="05-covariates.html#cb249-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(incarc)), <span class="at">shape =</span> <span class="st">&quot;|&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  </span>
<span id="cb249-3"><a href="05-covariates.html#cb249-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> random.effs, </span>
<span id="cb249-4"><a href="05-covariates.html#cb249-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> slp, <span class="at">y =</span> pred.prob, <span class="at">color =</span> <span class="fu">factor</span>(incarc))) <span class="sc">+</span>  </span>
<span id="cb249-5"><a href="05-covariates.html#cb249-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb249-6"><a href="05-covariates.html#cb249-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>), <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb249-7"><a href="05-covariates.html#cb249-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Plotting Predicted Probabilities of Lifetime Incarceration&quot;</span>,</span>
<span id="cb249-8"><a href="05-covariates.html#cb249-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Slope of Adolescent Antisocial Behavior&quot;</span>,</span>
<span id="cb249-9"><a href="05-covariates.html#cb249-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Predicted Probability of Incarceration&quot;</span>) <span class="sc">+</span> </span>
<span id="cb249-10"><a href="05-covariates.html#cb249-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="longitudinal_primer_files/figure-html/outcomes%2004-2.png" width="672" /></p>
<p>As we can see, the slope parameter in particular does not cover a full 1 unit range, and most of the observations are between <span class="math inline">\(-0.2\)</span> and <span class="math inline">\(0.2\)</span>. Here we have plotted the predicted probabilities of incarceration (dots) against each of the parameters, color-coded by their observed response on the incarceration item (red = “No”, green = “Yes”). Note that there is some mismatch, especially in the middle-zones of the plots, where some of those who have <em>actually</em> experienced incarceration have low model-implied probabilities, and vice versa. This is perfectly normal and means we simply haven’t included all of the multitude of relevant predictors for lifetime incarceration (which is completely unsurprising given what we know about incarceration patterns in the population). We will not go much further on diagnostics here, but just to note: there is a single point at the very high end of the graph that seems to be anchoring the curve fairly strongly. It would be a great idea to test the model sensitivity to excluding this person from the analysis.</p>
<p>Of course, it was a bit of a bummer that the slope term wasn’t quite significant (and yes of course we shouldn’t care, but <strong>of course</strong> we do). Slope effects are often very interesting from an intervention perspective, with the idea that if we could just bend those curves down during adolescence, perhaps we could avoid some of these negative life outcomes. Well tough cookies in this model, but one of the reasons that we do not get a slope effect for this data in particular is because of the high degree of correlation between the EB estimates of the random effects, which is quite high (<span class="math inline">\(r =\)</span> 0.847). Similar to the ideas outlined in <a href="https://mccormickneuro.github.io/publication/2021-multilevel-multigrowth/">multi-growth models</a>, the correlation in predictors here isn’t doing us any favors. We can check the variance inflation factor for this model below using the <code>vif()</code> function from the <a href="https://cran.r-project.org/web/packages/car/index.html"><strong>car</strong></a> package.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="05-covariates.html#cb250-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(distal.glm)</span></code></pre></div>
<pre><code>##      int      slp 
## 2.772259 2.772259</code></pre>
<p>Which indicates that our standard errors are approximately <span class="math inline">\(2.77\)</span> larger than if we had uncorrelated predictors. While this isn’t enormous, it likely contributes to a non-significant slope effect. This type of correlation between the random effects is not uncommon and is one of the challenges associated with these kinds of questions (although there are some developments that I am currently working on that might help with this, so stay tuned if interested).</p>
<p>We can do a very similar 2-step approach with the LCM by generating factor scores. Here we will use the <code>lavPredict()</code> function from <strong>lavaan</strong> with <code>method = "regression"</code>. The other option is to use <code>method = "Bartlett"</code>. In general, regression factor scores perform better as predictors (which is what we want here), while Bartlett scores are better as outcomes (<a href="https://psycnet.apa.org/record/2001-10245-007">Skrondal &amp; Laak, 2001</a>).</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="05-covariates.html#cb252-1" aria-hidden="true" tabindex="-1"></a>lin.lcm <span class="ot">&lt;-</span> <span class="st">&quot;int =~ 1*ext6 + 1*ext8 + 1*ext10 + 1*ext12 + 1*ext14</span></span>
<span id="cb252-2"><a href="05-covariates.html#cb252-2" aria-hidden="true" tabindex="-1"></a><span class="st">            slp =~ 0*ext6 + 2*ext8 + 4*ext10 + 6*ext12 + 8*ext14</span></span>
<span id="cb252-3"><a href="05-covariates.html#cb252-3" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb252-4"><a href="05-covariates.html#cb252-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-5"><a href="05-covariates.html#cb252-5" aria-hidden="true" tabindex="-1"></a>lin.lcm.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(lin.lcm, </span>
<span id="cb252-6"><a href="05-covariates.html#cb252-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> externalizing,</span>
<span id="cb252-7"><a href="05-covariates.html#cb252-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb252-8"><a href="05-covariates.html#cb252-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb252-9"><a href="05-covariates.html#cb252-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-10"><a href="05-covariates.html#cb252-10" aria-hidden="true" tabindex="-1"></a>factor.scores <span class="ot">&lt;-</span> <span class="fu">lavPredict</span>(lin.lcm.fit, </span>
<span id="cb252-11"><a href="05-covariates.html#cb252-11" aria-hidden="true" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&quot;lv&quot;</span>,</span>
<span id="cb252-12"><a href="05-covariates.html#cb252-12" aria-hidden="true" tabindex="-1"></a>                            <span class="at">method =</span> <span class="st">&quot;regression&quot;</span>)</span>
<span id="cb252-13"><a href="05-covariates.html#cb252-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-14"><a href="05-covariates.html#cb252-14" aria-hidden="true" tabindex="-1"></a>externalizing <span class="ot">&lt;-</span> <span class="fu">cbind</span>(externalizing, factor.scores)</span></code></pre></div>
<p>We can then perform the same regression for step <span class="math inline">\(2\)</span>.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="05-covariates.html#cb253-1" aria-hidden="true" tabindex="-1"></a>distal.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(incarc <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> int <span class="sc">+</span> slp,</span>
<span id="cb253-2"><a href="05-covariates.html#cb253-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb253-3"><a href="05-covariates.html#cb253-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> externalizing)</span>
<span id="cb253-4"><a href="05-covariates.html#cb253-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-5"><a href="05-covariates.html#cb253-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(distal.glm)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = incarc ~ 1 + int + slp, family = &quot;binomial&quot;, data = externalizing)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.7234  -0.3135  -0.1990  -0.1407   2.8590  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -6.3940     0.9079  -7.043 1.89e-12 ***
## int           1.9245     0.5964   3.227  0.00125 ** 
## slp          -3.0144     4.4679  -0.675  0.49988    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 203.63  on 404  degrees of freedom
## Residual deviance: 149.13  on 402  degrees of freedom
## AIC: 155.13
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="05-covariates.html#cb255-1" aria-hidden="true" tabindex="-1"></a>externalizing <span class="ot">&lt;-</span> externalizing <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(int, slp))</span></code></pre></div>
<p>Now our slope effect is no-where near significance. The correlation between the factor scores here is even higher (<span class="math inline">\(r =\)</span> 0.929) so our VIF is 5.817 which might contribute to that. However, part of it is that factor scores and EM estimates are different ways of estimating an unobserved quantity so we will get different results depending on our approach. One common alternative in SEMs is to go ahead and include the distal outcome into the same model that estimates the trajectory and estimate everything simultaneously we can see the syntax for this model below. The inclusion of the new parameters are trivial from a syntax perspective; we just add the regression directly. However, because <code>incarc</code> is a binary variable, we need to include new options in the <code>growth()</code> function. Specifically, we change the estimator to <code>"WLSMV"</code> (see <a href="https://lavaan.ugent.be/tutorial/est.html">here</a> for details on different estimator options) and indicate that <code>incarc</code> is a categorical variable with <code>ordered = "incarc"</code>.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="05-covariates.html#cb256-1" aria-hidden="true" tabindex="-1"></a>sim.lcm <span class="ot">&lt;-</span> <span class="st">&quot;int =~ 1*ext6 + 1*ext8 + 1*ext10 + 1*ext12 + 1*ext14</span></span>
<span id="cb256-2"><a href="05-covariates.html#cb256-2" aria-hidden="true" tabindex="-1"></a><span class="st">            slp =~ 0*ext6 + 2*ext8 + 4*ext10 + 6*ext12 + 8*ext14</span></span>
<span id="cb256-3"><a href="05-covariates.html#cb256-3" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb256-4"><a href="05-covariates.html#cb256-4" aria-hidden="true" tabindex="-1"></a><span class="st">            incarc ~ 1 + int + slp</span></span>
<span id="cb256-5"><a href="05-covariates.html#cb256-5" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb256-6"><a href="05-covariates.html#cb256-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-7"><a href="05-covariates.html#cb256-7" aria-hidden="true" tabindex="-1"></a>sim.lcm.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(sim.lcm, </span>
<span id="cb256-8"><a href="05-covariates.html#cb256-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> externalizing,</span>
<span id="cb256-9"><a href="05-covariates.html#cb256-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimator =</span> <span class="st">&quot;WLSMV&quot;</span>,</span>
<span id="cb256-10"><a href="05-covariates.html#cb256-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ordered =</span> <span class="st">&quot;incarc&quot;</span>)</span></code></pre></div>
<p>Unfortunately, when we try to estimate this model, we get an error message <code>lavaan ERROR: data contains no observations</code>, which should be slighly concerning… What is happening here is that in this dataset, because no one person is observed on adjacent measures (e.g., <code>ext6</code> &amp; <code>ext7</code>), everyone has missing data. This was not an issue in the linear versions of the model because we could use Maximum Likelihood, however, currently <strong>lavaan</strong> does not support categorical ML, and WLSMV will listwise delete individuals with missing data. Unfortunately for us, that’s <span class="math inline">\(100\)</span> percent of adolescents in our sample. We would need to turn to <strong>Mplus</strong> or another program for results from this model.</p>
<p>As we mentioned, this area of methodological research is still relatively under-developed and awaits solutions to many of the limitations we have run into here.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="04-shape.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="06-nesting.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["twitter", "facebook", "linkedin", "google", "weibo", "instapaper"],
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/McCormickNeuro/longitudinal-primer/edit/main/05-covariates.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"depth": 2,
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
