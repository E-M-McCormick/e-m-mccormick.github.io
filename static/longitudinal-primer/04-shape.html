<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>The Shape of Development | The Hitchhiker’s Guide to Longitudinal Models</title>
  <meta name="description" content="This is a code companion for The Hitchhiker’s Guide to Longitudinal Models." />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="The Shape of Development | The Hitchhiker’s Guide to Longitudinal Models" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a code companion for The Hitchhiker’s Guide to Longitudinal Models." />
  <meta name="github-repo" content="McCormickNeuro/longitudinal-primer" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="The Shape of Development | The Hitchhiker’s Guide to Longitudinal Models" />
  
  <meta name="twitter:description" content="This is a code companion for The Hitchhiker’s Guide to Longitudinal Models." />
  

<meta name="author" content="Ethan M. McCormick" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="03-time.html"/>
<link rel="next" href="05-covariates.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/font-awesome-5.13.0/js/script.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The Hitchhiker’s Guide to Longitudinal Models</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="" data-path="01-introduction.html"><a href="01-introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="02-canonical.html"><a href="02-canonical.html"><i class="fa fa-check"></i>Canonical Models</a>
<ul>
<li class="chapter" data-level="" data-path="02-canonical.html"><a href="02-canonical.html#multilevel-model"><i class="fa fa-check"></i>Multilevel Model</a>
<ul>
<li class="chapter" data-level="" data-path="02-canonical.html"><a href="02-canonical.html#nlme"><i class="fa fa-check"></i>nlme</a></li>
<li class="chapter" data-level="" data-path="02-canonical.html"><a href="02-canonical.html#lme4"><i class="fa fa-check"></i>lme4</a></li>
<li class="chapter" data-level="" data-path="02-canonical.html"><a href="02-canonical.html#lmertest"><i class="fa fa-check"></i>lmerTest</a></li>
<li class="chapter" data-level="" data-path="02-canonical.html"><a href="02-canonical.html#mlm-outputs"><i class="fa fa-check"></i>MLM Outputs</a></li>
<li class="chapter" data-level="" data-path="02-canonical.html"><a href="02-canonical.html#mlm-plotting-model-implied-trajectories"><i class="fa fa-check"></i>MLM Plotting Model-Implied Trajectories</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="02-canonical.html"><a href="02-canonical.html#generalized-additive-mixed-model"><i class="fa fa-check"></i>Generalized Additive Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="02-canonical.html"><a href="02-canonical.html#gamm-outputs"><i class="fa fa-check"></i>GAMM Outputs</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="02-canonical.html"><a href="02-canonical.html#latent-curve-model"><i class="fa fa-check"></i>Latent Curve Model</a>
<ul>
<li class="chapter" data-level="" data-path="02-canonical.html"><a href="02-canonical.html#lcm-syntax-and-model-fitting"><i class="fa fa-check"></i>LCM Syntax and Model Fitting</a></li>
<li class="chapter" data-level="" data-path="02-canonical.html"><a href="02-canonical.html#lcm-outputs"><i class="fa fa-check"></i>LCM Outputs</a></li>
<li class="chapter" data-level="" data-path="02-canonical.html"><a href="02-canonical.html#lcm-path-diagrams"><i class="fa fa-check"></i>LCM Path Diagrams</a></li>
<li class="chapter" data-level="" data-path="02-canonical.html"><a href="02-canonical.html#lcm-plotting-model-implied-trajectories"><i class="fa fa-check"></i>LCM Plotting Model-Implied Trajectories</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="02-canonical.html"><a href="02-canonical.html#latent-change-score-model"><i class="fa fa-check"></i>Latent Change Score Model</a>
<ul>
<li class="chapter" data-level="" data-path="02-canonical.html"><a href="02-canonical.html#linear-lcsm"><i class="fa fa-check"></i>Linear LCSM</a></li>
<li class="chapter" data-level="" data-path="02-canonical.html"><a href="02-canonical.html#linear-lcsm-with-proportional-change"><i class="fa fa-check"></i>Linear LCSM with Proportional Change</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="03-time.html"><a href="03-time.html"><i class="fa fa-check"></i>Time Structure</a>
<ul>
<li class="chapter" data-level="" data-path="03-time.html"><a href="03-time.html#assessment-schedules"><i class="fa fa-check"></i>Assessment Schedules</a>
<ul>
<li class="chapter" data-level="" data-path="03-time.html"><a href="03-time.html#single-cohort-data"><i class="fa fa-check"></i>Single Cohort Data</a></li>
<li class="chapter" data-level="" data-path="03-time.html"><a href="03-time.html#multiple-cohort-data"><i class="fa fa-check"></i>Multiple Cohort Data</a></li>
<li class="chapter" data-level="" data-path="03-time.html"><a href="03-time.html#accelerated-design"><i class="fa fa-check"></i>Accelerated Design</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="03-time.html"><a href="03-time.html#time-coding"><i class="fa fa-check"></i>Time Coding</a></li>
<li class="chapter" data-level="" data-path="03-time.html"><a href="03-time.html#additional-considerations"><i class="fa fa-check"></i>Additional Considerations</a>
<ul>
<li class="chapter" data-level="" data-path="03-time.html"><a href="03-time.html#alternative-metrics-of-time"><i class="fa fa-check"></i>Alternative Metrics of Time</a></li>
<li class="chapter" data-level="" data-path="03-time.html"><a href="03-time.html#residual-estimates"><i class="fa fa-check"></i>Residual Estimates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="04-shape.html"><a href="04-shape.html"><i class="fa fa-check"></i>The Shape of Development</a>
<ul>
<li class="chapter" data-level="" data-path="04-shape.html"><a href="04-shape.html#polynomial-trajectories"><i class="fa fa-check"></i>Polynomial Trajectories</a>
<ul>
<li class="chapter" data-level="" data-path="04-shape.html"><a href="04-shape.html#intercept-only-model"><i class="fa fa-check"></i>Intercept-Only Model</a></li>
<li class="chapter" data-level="" data-path="04-shape.html"><a href="04-shape.html#linear-model"><i class="fa fa-check"></i>Linear Model</a></li>
<li class="chapter" data-level="" data-path="04-shape.html"><a href="04-shape.html#quadratic-model"><i class="fa fa-check"></i>Quadratic Model</a></li>
<li class="chapter" data-level="" data-path="04-shape.html"><a href="04-shape.html#inverse-model"><i class="fa fa-check"></i>Inverse Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="04-shape.html"><a href="04-shape.html#piecewise-trajectories"><i class="fa fa-check"></i>Piecewise Trajectories</a></li>
<li class="chapter" data-level="" data-path="04-shape.html"><a href="04-shape.html#nonlinear-trajectories"><i class="fa fa-check"></i>Nonlinear Trajectories</a></li>
<li class="chapter" data-level="" data-path="04-shape.html"><a href="04-shape.html#fixed-and-random-effects"><i class="fa fa-check"></i>Fixed and Random Effects</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="05-covariates.html"><a href="05-covariates.html"><i class="fa fa-check"></i>Covariates and Distal Outcomes</a>
<ul>
<li class="chapter" data-level="" data-path="05-covariates.html"><a href="05-covariates.html#covariates-1"><i class="fa fa-check"></i>Covariates</a>
<ul>
<li class="chapter" data-level="" data-path="05-covariates.html"><a href="05-covariates.html#time-invariant-covariates"><i class="fa fa-check"></i>Time Invariant Covariates</a></li>
<li class="chapter" data-level="" data-path="05-covariates.html"><a href="05-covariates.html#cross-level-interactions"><i class="fa fa-check"></i>Cross-Level Interactions</a></li>
<li class="chapter" data-level="" data-path="05-covariates.html"><a href="05-covariates.html#time-varying-covariates"><i class="fa fa-check"></i>Time Varying Covariates</a></li>
<li class="chapter" data-level="" data-path="05-covariates.html"><a href="05-covariates.html#multivariate-models"><i class="fa fa-check"></i>Multivariate Models</a></li>
<li class="chapter" data-level="" data-path="05-covariates.html"><a href="05-covariates.html#within--and-betwen-person-variance"><i class="fa fa-check"></i>Within- and Betwen-Person Variance</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="05-covariates.html"><a href="05-covariates.html#distal-outcomes"><i class="fa fa-check"></i>Distal Outcomes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="06-nesting.html"><a href="06-nesting.html"><i class="fa fa-check"></i>Nested Data</a>
<ul>
<li class="chapter" data-level="" data-path="06-nesting.html"><a href="06-nesting.html#unconditional-model"><i class="fa fa-check"></i>Unconditional Model</a></li>
<li class="chapter" data-level="" data-path="06-nesting.html"><a href="06-nesting.html#categorical-predictors"><i class="fa fa-check"></i>Categorical Predictors</a></li>
<li class="chapter" data-level="" data-path="06-nesting.html"><a href="06-nesting.html#multiple-groups-models"><i class="fa fa-check"></i>Multiple Groups Models</a></li>
<li class="chapter" data-level="" data-path="06-nesting.html"><a href="06-nesting.html#fixed-effect-approach"><i class="fa fa-check"></i>Fixed Effect Approach</a></li>
<li class="chapter" data-level="" data-path="06-nesting.html"><a href="06-nesting.html#random-effect-approach"><i class="fa fa-check"></i>Random Effect Approach</a></li>
<li class="chapter" data-level="" data-path="06-nesting.html"><a href="06-nesting.html#cluster-correction"><i class="fa fa-check"></i>Cluster Correction</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="07-datasets.html"><a href="07-datasets.html"><i class="fa fa-check"></i>Datasets</a>
<ul>
<li class="chapter" data-level="" data-path="07-datasets.html"><a href="07-datasets.html#descriptions"><i class="fa fa-check"></i>Descriptions</a>
<ul>
<li class="chapter" data-level="" data-path="07-datasets.html"><a href="07-datasets.html#executive-function"><i class="fa fa-check"></i>Executive Function</a></li>
<li class="chapter" data-level="" data-path="07-datasets.html"><a href="07-datasets.html#feedback-learning"><i class="fa fa-check"></i>Feedback Learning</a></li>
<li class="chapter" data-level="" data-path="07-datasets.html"><a href="07-datasets.html#externalizing-and-math"><i class="fa fa-check"></i>Externalizing and Math</a></li>
<li class="chapter" data-level="" data-path="07-datasets.html"><a href="07-datasets.html#adversity"><i class="fa fa-check"></i>Adversity</a></li>
<li class="chapter" data-level="" data-path="07-datasets.html"><a href="07-datasets.html#trials"><i class="fa fa-check"></i>Trials</a></li>
<li class="chapter" data-level="" data-path="07-datasets.html"><a href="07-datasets.html#achieve"><i class="fa fa-check"></i>Achieve</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Hitchhiker’s Guide to Longitudinal Models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="shape" class="section level1 hasAnchor">
<h1>The Shape of Development<a href="04-shape.html#shape" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>However, we define the underlying metric of time to structure our longitudinal model, one of the key substantive questions often underlying work in developmental science is to characterize the course that a given construct takes over time. Here we will highlight many of the different developmental trajectories that we can fit to our data, starting with relatively simple polynomial shapes and working our way up to modeling fully nonlinear trends. In addition to the <code>feedback.learning</code> data we have used thus far, we will also use data drawn from the <code>external-math.csv</code> and <code>adversity.csv</code> files. The <code>external.math</code> data contains up to <span class="math inline">\(5\)</span> repeated observations from <span class="math inline">\(405\)</span> children aged <span class="math inline">\(6\)</span> to <span class="math inline">\(14\)</span>, measured once every <span class="math inline">\(2\)</span> years. Here we will focus on measures of externalizing behavior and math proficiency. The <code>adversity</code> data contains fractional anisotropy (FA) measures from <span class="math inline">\(398\)</span> children measured up to <span class="math inline">\(4\)</span> times across ages <span class="math inline">\(4\)</span> to <span class="math inline">\(11\)</span>. We previously used a subset of this data in the <a href="03-time.html#time">Time</a> chapter, but here we will utilize the entire sample.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="04-shape.html#cb96-1" aria-hidden="true" tabindex="-1"></a>external.math <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/external-math.csv&quot;</span>)</span>
<span id="cb96-2"><a href="04-shape.html#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="04-shape.html#cb96-3" aria-hidden="true" tabindex="-1"></a>adversity <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/adversity.csv&quot;</span>)</span>
<span id="cb96-4"><a href="04-shape.html#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a href="04-shape.html#cb96-5" aria-hidden="true" tabindex="-1"></a>feedback.learning <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/feedback-learning.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb96-6"><a href="04-shape.html#cb96-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, age, modularity, learning.rate)</span></code></pre></div>
<div id="polynomial-trajectories" class="section level2 hasAnchor">
<h2>Polynomial Trajectories<a href="04-shape.html#polynomial-trajectories" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Like we discussed in the main text, polynomial trajectories are far and away the most common trajectories modeled with longitudinal data. They require relatively few unique timepoints, are straightforward to model, and offer easily-interpretable parameter estimates.</p>
<div id="intercept-only-model" class="section level3 hasAnchor">
<h3>Intercept-Only Model<a href="04-shape.html#intercept-only-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can first consider the simplest polynomial model, one without even a slope. The intercept-only model simply models person-specific differences in average level across time. We can start here with the LCM, which makes the various specifications easiest to see, but we will also build syntax for models in the other frameworks.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="04-shape.html#cb97-1" aria-hidden="true" tabindex="-1"></a>int.lcm <span class="ot">&lt;-</span> <span class="st">&quot;int =~ 1*ext6 + 1*ext8 + 1*ext10 + 1*ext12 + 1*ext14&quot;</span></span>
<span id="cb97-2"><a href="04-shape.html#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="04-shape.html#cb97-3" aria-hidden="true" tabindex="-1"></a>int.lcm.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(int.lcm, </span>
<span id="cb97-4"><a href="04-shape.html#cb97-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> external.math,</span>
<span id="cb97-5"><a href="04-shape.html#cb97-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb97-6"><a href="04-shape.html#cb97-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb97-7"><a href="04-shape.html#cb97-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-8"><a href="04-shape.html#cb97-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(int.lcm.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>, </span>
<span id="cb97-9"><a href="04-shape.html#cb97-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">FALSE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 25 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                         7
## 
##   Number of observations                           405
##   Number of missing patterns                        21
## 
## Model Test User Model:
##                                                       
##   Test statistic                                71.246
##   Degrees of freedom                                13
##   P-value (Chi-square)                           0.000
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int =~                                              
##     ext6              1.000                           
##     ext8              1.000                           
##     ext10             1.000                           
##     ext12             1.000                           
##     ext14             1.000                           
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ext6              0.000                           
##    .ext8              0.000                           
##    .ext10             0.000                           
##    .ext12             0.000                           
##    .ext14             0.000                           
##     int               1.882    0.077   24.397    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ext6              1.761    0.203    8.690    0.000
##    .ext8              1.771    0.189    9.384    0.000
##    .ext10             2.023    0.208    9.730    0.000
##    .ext12             2.243    0.230    9.758    0.000
##    .ext14             2.049    0.348    5.891    0.000
##     int               1.752    0.172   10.161    0.000</code></pre>
<p>We can see that there is significant variance in the intercept factor, suggesting meaningful person-to-person variability in level of externalizing behavior during late childhood and early adolescence. While this might seem a somewhat silly model to fit to these data, this is one half of a random-intercept cross-lag panel model and might be appropriate if we do not expect systematic change over time. However, these intercept-only models are admittedly more plausible for intensive longitudinal data. The MLM specification for this model can be seen below. We will first transform the data into long format before fitting the model.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="04-shape.html#cb99-1" aria-hidden="true" tabindex="-1"></a>external.math.long <span class="ot">&lt;-</span> external.math <span class="sc">%&gt;%</span> </span>
<span id="cb99-2"><a href="04-shape.html#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="fu">c</span>(<span class="st">&quot;ext&quot;</span>, <span class="st">&quot;math&quot;</span>)), </span>
<span id="cb99-3"><a href="04-shape.html#cb99-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;.value&quot;</span>, <span class="st">&quot;age&quot;</span>), </span>
<span id="cb99-4"><a href="04-shape.html#cb99-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_pattern =</span> <span class="st">&quot;(ext|math)(.+)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb99-5"><a href="04-shape.html#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> <span class="fu">as.numeric</span>(age))</span>
<span id="cb99-6"><a href="04-shape.html#cb99-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-7"><a href="04-shape.html#cb99-7" aria-hidden="true" tabindex="-1"></a>int.mlm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(ext <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id),</span>
<span id="cb99-8"><a href="04-shape.html#cb99-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">na.action =</span> na.omit,</span>
<span id="cb99-9"><a href="04-shape.html#cb99-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">REML =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-10"><a href="04-shape.html#cb99-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> external.math.long)</span>
<span id="cb99-11"><a href="04-shape.html#cb99-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-12"><a href="04-shape.html#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(int.mlm, <span class="at">correlation =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: ext ~ 1 + (1 | id)
##    Data: external.math.long
## 
## REML criterion at convergence: 5316.7
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.2539 -0.5600 -0.2063  0.4736  4.5276 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  id       (Intercept) 1.799    1.341   
##  Residual             1.944    1.394   
## Number of obs: 1357, groups:  id, 405
## 
## Fixed effects:
##              Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)   1.89455    0.07736 399.24978   24.49   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Note that this is just a random-effects ANOVA model with no predictors.</p>
</div>
<div id="linear-model" class="section level3 hasAnchor">
<h3>Linear Model<a href="04-shape.html#linear-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will move quickly through the linear polynomial models because we have covered them extensively thus far. Below is the syntax for the linear LCM. Remember that assessments are biannual so factor loadings should increase by two for each wave.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="04-shape.html#cb101-1" aria-hidden="true" tabindex="-1"></a>lin.lcm <span class="ot">&lt;-</span> <span class="st">&quot;int =~ 1*ext6 + 1*ext8 + 1*ext10 + 1*ext12 + 1*ext14</span></span>
<span id="cb101-2"><a href="04-shape.html#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="st">            slp =~ 0*ext6 + 2*ext8 + 4*ext10 + 6*ext12 + 8*ext14&quot;</span></span>
<span id="cb101-3"><a href="04-shape.html#cb101-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-4"><a href="04-shape.html#cb101-4" aria-hidden="true" tabindex="-1"></a>lin.lcm.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(lin.lcm, </span>
<span id="cb101-5"><a href="04-shape.html#cb101-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> external.math,</span>
<span id="cb101-6"><a href="04-shape.html#cb101-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb101-7"><a href="04-shape.html#cb101-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb101-8"><a href="04-shape.html#cb101-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-9"><a href="04-shape.html#cb101-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lin.lcm.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>, </span>
<span id="cb101-10"><a href="04-shape.html#cb101-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">FALSE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 36 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        10
## 
##   Number of observations                           405
##   Number of missing patterns                        21
## 
## Model Test User Model:
##                                                       
##   Test statistic                                19.507
##   Degrees of freedom                                10
##   P-value (Chi-square)                           0.034
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int =~                                              
##     ext6              1.000                           
##     ext8              1.000                           
##     ext10             1.000                           
##     ext12             1.000                           
##     ext14             1.000                           
##   slp =~                                              
##     ext6              0.000                           
##     ext8              2.000                           
##     ext10             4.000                           
##     ext12             6.000                           
##     ext14             8.000                           
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int ~~                                              
##     slp               0.084    0.042    2.003    0.045
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ext6              0.000                           
##    .ext8              0.000                           
##    .ext10             0.000                           
##    .ext12             0.000                           
##    .ext14             0.000                           
##     int               1.664    0.081   20.459    0.000
##     slp               0.074    0.018    4.135    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ext6              1.653    0.239    6.914    0.000
##    .ext8              1.844    0.188    9.807    0.000
##    .ext10             1.910    0.199    9.593    0.000
##    .ext12             1.592    0.227    7.007    0.000
##    .ext14             1.618    0.372    4.346    0.000
##     int               1.068    0.227    4.710    0.000
##     slp               0.024    0.011    2.066    0.039</code></pre>
<p>While we have ignored model fit for most models, one nice thing about many of these models, is that they are nested and allow for formal model comparison with likelihood ratio tests, similar to those we saw with hetero- vs. homoscedastic residuals. For instance, we can compare the intercept-only with a linear model.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="04-shape.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lavTestLRT</span>(int.lcm.fit, lin.lcm.fit)</span></code></pre></div>
<pre><code>## Chi-Squared Difference Test
## 
##             Df    AIC    BIC  Chisq Chisq diff Df diff Pr(&gt;Chisq)    
## lin.lcm.fit 10 5278.2 5318.3 19.506                                  
## int.lcm.fit 13 5324.0 5352.0 71.246      51.74       3  3.403e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Remember that we compare whether the more constrained model (here the intercept-only) induces a significant <em>decrease</em> in model fit. Here this is true, suggesting that we should retain the linear model over the intercept-only model. If we take a peak at the model fit, this is because the linear model fits the data reasonably well, while the intercept-only model is quite poor in terms of fit.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="04-shape.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(int.lcm.fit, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">estimates =</span> <span class="cn">FALSE</span>, </span>
<span id="cb105-2"><a href="04-shape.html#cb105-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">FALSE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 25 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                         7
## 
##   Number of observations                           405
##   Number of missing patterns                        21
## 
## Model Test User Model:
##                                                       
##   Test statistic                                71.246
##   Degrees of freedom                                13
##   P-value (Chi-square)                           0.000
## 
## Model Test Baseline Model:
## 
##   Test statistic                               361.048
##   Degrees of freedom                                10
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.834
##   Tucker-Lewis Index (TLI)                       0.872
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -2654.990
##   Loglikelihood unrestricted model (H1)      -2619.367
##                                                       
##   Akaike (AIC)                                5323.980
##   Bayesian (BIC)                              5352.007
##   Sample-size adjusted Bayesian (BIC)         5329.795
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.105
##   90 Percent confidence interval - lower         0.082
##   90 Percent confidence interval - upper         0.130
##   P-value RMSEA &lt;= 0.05                          0.000
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.156</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="04-shape.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lin.lcm.fit, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">estimates =</span> <span class="cn">FALSE</span>, </span>
<span id="cb107-2"><a href="04-shape.html#cb107-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">FALSE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 36 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        10
## 
##   Number of observations                           405
##   Number of missing patterns                        21
## 
## Model Test User Model:
##                                                       
##   Test statistic                                19.507
##   Degrees of freedom                                10
##   P-value (Chi-square)                           0.034
## 
## Model Test Baseline Model:
## 
##   Test statistic                               361.048
##   Degrees of freedom                                10
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.973
##   Tucker-Lewis Index (TLI)                       0.973
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -2629.120
##   Loglikelihood unrestricted model (H1)      -2619.367
##                                                       
##   Akaike (AIC)                                5278.240
##   Bayesian (BIC)                              5318.279
##   Sample-size adjusted Bayesian (BIC)         5286.547
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.048
##   90 Percent confidence interval - lower         0.013
##   90 Percent confidence interval - upper         0.080
##   P-value RMSEA &lt;= 0.05                          0.486
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.082</code></pre>
<p>To fit the corresponding MLM, we first need to generate our linear predictor as an observed variable in our data frame (and will need to do so each time we increase the order of the model). Here we will generate the linear predictor by simply subtracting <span class="math inline">\(6\)</span> from the <code>age</code> variable.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="04-shape.html#cb109-1" aria-hidden="true" tabindex="-1"></a>external.math.long<span class="sc">$</span>age <span class="ot">&lt;-</span> external.math.long<span class="sc">$</span>age <span class="sc">-</span> <span class="fu">min</span>(external.math.long<span class="sc">$</span>age)</span>
<span id="cb109-2"><a href="04-shape.html#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="04-shape.html#cb109-3" aria-hidden="true" tabindex="-1"></a>lin.mlm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(ext <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> age <span class="sc">|</span> id),</span>
<span id="cb109-4"><a href="04-shape.html#cb109-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">na.action =</span> na.omit,</span>
<span id="cb109-5"><a href="04-shape.html#cb109-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">REML =</span> <span class="cn">TRUE</span>,</span>
<span id="cb109-6"><a href="04-shape.html#cb109-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> external.math.long,</span>
<span id="cb109-7"><a href="04-shape.html#cb109-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>,</span>
<span id="cb109-8"><a href="04-shape.html#cb109-8" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>)))</span>
<span id="cb109-9"><a href="04-shape.html#cb109-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-10"><a href="04-shape.html#cb109-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lin.mlm, <span class="at">correlation =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: ext ~ 1 + age + (1 + age | id)
##    Data: external.math.long
## Control: lmerControl(optimizer = &quot;bobyqa&quot;, optCtrl = list(maxfun = 2e+05))
## 
## REML criterion at convergence: 5269.3
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.1375 -0.5422 -0.1737  0.4491  3.9389 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr
##  id       (Intercept) 1.02975  1.0148       
##           age         0.01778  0.1334   0.75
##  Residual             1.78241  1.3351       
## Number of obs: 1357, groups:  id, 405
## 
## Fixed effects:
##              Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)   1.66939    0.08114 372.83569  20.574  &lt; 2e-16 ***
## age           0.07235    0.01758 288.52755   4.116 5.03e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>And the model comparison reveals the same preference for the linear model. Note that the model is re-estimated with ML [FIML] because the two models contain different fixed effects. REML models can be compared when the models differ only in the variance structure. Fortunately this will be done automatically so we don’t have to “manually” re-estimate the models.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="04-shape.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(int.mlm, lin.mlm)</span></code></pre></div>
<pre><code>## Data: external.math.long
## Models:
## int.mlm: ext ~ 1 + (1 | id)
## lin.mlm: ext ~ 1 + age + (1 + age | id)
##         npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
## int.mlm    3 5319.5 5335.1 -2656.7   5313.5                         
## lin.mlm    6 5271.7 5303.0 -2629.9   5259.7 53.736  3  1.277e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Finally, we can see a version of the linear LCSM for the <code>external.math</code> data below. Note again that biannual observations mean that we need to set the factor loadings for the slope factor to <span class="math inline">\(2\)</span> instead of <span class="math inline">\(1\)</span> to indicate the spacing appropriately.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="04-shape.html#cb113-1" aria-hidden="true" tabindex="-1"></a>lin.lcsm <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb113-2"><a href="04-shape.html#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="st">            # Define Phantom Variables (p = phantom)</span></span>
<span id="cb113-3"><a href="04-shape.html#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="st">            pext6 =~ 1*ext6; ext6 ~ 0; ext6 ~~ ext6; pext6 ~~ 0*pext6</span></span>
<span id="cb113-4"><a href="04-shape.html#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="st">            pext8 =~ 1*ext8; ext8 ~ 0; ext8 ~~ ext8; pext8 ~~ 0*pext8</span></span>
<span id="cb113-5"><a href="04-shape.html#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="st">            pext10 =~ 1*ext10; ext10 ~ 0; ext10 ~~ ext10; pext10 ~~ 0*pext10</span></span>
<span id="cb113-6"><a href="04-shape.html#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="st">            pext12 =~ 1*ext12; ext12 ~ 0; ext12 ~~ ext12; pext12 ~~ 0*pext12</span></span>
<span id="cb113-7"><a href="04-shape.html#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="st">            pext14 =~ 1*ext14; ext14 ~ 0; ext14 ~~ ext14; pext14 ~~ 0*pext14</span></span>
<span id="cb113-8"><a href="04-shape.html#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb113-9"><a href="04-shape.html#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="st">            # Regressions Between Adjacent Observations</span></span>
<span id="cb113-10"><a href="04-shape.html#cb113-10" aria-hidden="true" tabindex="-1"></a><span class="st">            pext8 ~ 1*pext6</span></span>
<span id="cb113-11"><a href="04-shape.html#cb113-11" aria-hidden="true" tabindex="-1"></a><span class="st">            pext10 ~ 1*pext8</span></span>
<span id="cb113-12"><a href="04-shape.html#cb113-12" aria-hidden="true" tabindex="-1"></a><span class="st">            pext12 ~ 1*pext10</span></span>
<span id="cb113-13"><a href="04-shape.html#cb113-13" aria-hidden="true" tabindex="-1"></a><span class="st">            pext14 ~ 1*pext12</span></span>
<span id="cb113-14"><a href="04-shape.html#cb113-14" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb113-15"><a href="04-shape.html#cb113-15" aria-hidden="true" tabindex="-1"></a><span class="st">            # Define Change Latent Variables (delta)</span></span>
<span id="cb113-16"><a href="04-shape.html#cb113-16" aria-hidden="true" tabindex="-1"></a><span class="st">            delta21 =~ 1*pext8;  delta21 ~~ 0*delta21</span></span>
<span id="cb113-17"><a href="04-shape.html#cb113-17" aria-hidden="true" tabindex="-1"></a><span class="st">            delta32 =~ 1*pext10; delta32 ~~ 0*delta32</span></span>
<span id="cb113-18"><a href="04-shape.html#cb113-18" aria-hidden="true" tabindex="-1"></a><span class="st">            delta43 =~ 1*pext12; delta43 ~~ 0*delta43</span></span>
<span id="cb113-19"><a href="04-shape.html#cb113-19" aria-hidden="true" tabindex="-1"></a><span class="st">            delta54 =~ 1*pext14; delta54 ~~ 0*delta54</span></span>
<span id="cb113-20"><a href="04-shape.html#cb113-20" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb113-21"><a href="04-shape.html#cb113-21" aria-hidden="true" tabindex="-1"></a><span class="st">            # Define Intercept and Slope</span></span>
<span id="cb113-22"><a href="04-shape.html#cb113-22" aria-hidden="true" tabindex="-1"></a><span class="st">            int =~ 1*pext6</span></span>
<span id="cb113-23"><a href="04-shape.html#cb113-23" aria-hidden="true" tabindex="-1"></a><span class="st">            slp =~ 2*delta21 + 2*delta32 + 2*delta43 + 2*delta54</span></span>
<span id="cb113-24"><a href="04-shape.html#cb113-24" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb113-25"><a href="04-shape.html#cb113-25" aria-hidden="true" tabindex="-1"></a><span class="st">            int ~ 1</span></span>
<span id="cb113-26"><a href="04-shape.html#cb113-26" aria-hidden="true" tabindex="-1"></a><span class="st">            slp ~ 1</span></span>
<span id="cb113-27"><a href="04-shape.html#cb113-27" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb113-28"><a href="04-shape.html#cb113-28" aria-hidden="true" tabindex="-1"></a><span class="st">            int ~~ slp</span></span>
<span id="cb113-29"><a href="04-shape.html#cb113-29" aria-hidden="true" tabindex="-1"></a><span class="st">            slp ~~ slp</span></span>
<span id="cb113-30"><a href="04-shape.html#cb113-30" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb113-31"><a href="04-shape.html#cb113-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-32"><a href="04-shape.html#cb113-32" aria-hidden="true" tabindex="-1"></a>lin.lcsm.fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(lin.lcsm, </span>
<span id="cb113-33"><a href="04-shape.html#cb113-33" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> external.math, </span>
<span id="cb113-34"><a href="04-shape.html#cb113-34" aria-hidden="true" tabindex="-1"></a>                    <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb113-35"><a href="04-shape.html#cb113-35" aria-hidden="true" tabindex="-1"></a>                    <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb113-36"><a href="04-shape.html#cb113-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-37"><a href="04-shape.html#cb113-37" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lin.lcsm.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>, </span>
<span id="cb113-38"><a href="04-shape.html#cb113-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">FALSE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 36 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        10
## 
##   Number of observations                           405
##   Number of missing patterns                        21
## 
## Model Test User Model:
##                                                       
##   Test statistic                                19.507
##   Degrees of freedom                                10
##   P-value (Chi-square)                           0.034
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   pext6 =~                                            
##     ext6              1.000                           
##   pext8 =~                                            
##     ext8              1.000                           
##   pext10 =~                                           
##     ext10             1.000                           
##   pext12 =~                                           
##     ext12             1.000                           
##   pext14 =~                                           
##     ext14             1.000                           
##   delta21 =~                                          
##     pext8             1.000                           
##   delta32 =~                                          
##     pext10            1.000                           
##   delta43 =~                                          
##     pext12            1.000                           
##   delta54 =~                                          
##     pext14            1.000                           
##   int =~                                              
##     pext6             1.000                           
##   slp =~                                              
##     delta21           2.000                           
##     delta32           2.000                           
##     delta43           2.000                           
##     delta54           2.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   pext8 ~                                             
##     pext6             1.000                           
##   pext10 ~                                            
##     pext8             1.000                           
##   pext12 ~                                            
##     pext10            1.000                           
##   pext14 ~                                            
##     pext12            1.000                           
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int ~~                                              
##     slp               0.084    0.042    2.003    0.045
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ext6              0.000                           
##    .ext8              0.000                           
##    .ext10             0.000                           
##    .ext12             0.000                           
##    .ext14             0.000                           
##     int               1.664    0.081   20.459    0.000
##     slp               0.074    0.018    4.135    0.000
##    .pext6             0.000                           
##    .pext8             0.000                           
##    .pext10            0.000                           
##    .pext12            0.000                           
##    .pext14            0.000                           
##    .delta21           0.000                           
##    .delta32           0.000                           
##    .delta43           0.000                           
##    .delta54           0.000                           
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .ext6              1.653    0.239    6.914    0.000
##    .pext6             0.000                           
##    .ext8              1.844    0.188    9.807    0.000
##    .pext8             0.000                           
##    .ext10             1.910    0.199    9.593    0.000
##    .pext10            0.000                           
##    .ext12             1.592    0.227    7.007    0.000
##    .pext12            0.000                           
##    .ext14             1.618    0.372    4.346    0.000
##    .pext14            0.000                           
##    .delta21           0.000                           
##    .delta32           0.000                           
##    .delta43           0.000                           
##    .delta54           0.000                           
##     slp               0.024    0.011    2.066    0.039
##     int               1.068    0.227    4.710    0.000</code></pre>
</div>
<div id="quadratic-model" class="section level3 hasAnchor">
<h3>Quadratic Model<a href="04-shape.html#quadratic-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next, we can add an additional factor to capture quadratic curvature in our data. Below is the LCM syntax for this model. Note that this is an extremely straightforward expansion of the syntax we have seen thus far. While this won’t be the case here, sometimes we need to worry about numerically large factor loadings causing some estimation issues in practice (nothing theoretical is wrong with large factor loadings). In those instances, we could divide our factor loadings by some constant to control those values from getting to large (although this will change the interpretation of a per-unit change).</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="04-shape.html#cb115-1" aria-hidden="true" tabindex="-1"></a>quad.lcm <span class="ot">&lt;-</span> <span class="st">&quot;int  =~ 1*ext6 + 1*ext8 + 1*ext10 + 1*ext12 + 1*ext14</span></span>
<span id="cb115-2"><a href="04-shape.html#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="st">             slp  =~ 0*ext6 + 2*ext8 + 4*ext10 + 6*ext12 + 8*ext14</span></span>
<span id="cb115-3"><a href="04-shape.html#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="st">             quad =~ 0*ext6 + 4*ext8 + 16*ext10 + 36*ext12 + 64*ext14&quot;</span></span>
<span id="cb115-4"><a href="04-shape.html#cb115-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-5"><a href="04-shape.html#cb115-5" aria-hidden="true" tabindex="-1"></a>quad.lcm.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(quad.lcm, </span>
<span id="cb115-6"><a href="04-shape.html#cb115-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> external.math,</span>
<span id="cb115-7"><a href="04-shape.html#cb115-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb115-8"><a href="04-shape.html#cb115-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb115-9"><a href="04-shape.html#cb115-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-10"><a href="04-shape.html#cb115-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(quad.lcm.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>, </span>
<span id="cb115-11"><a href="04-shape.html#cb115-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">TRUE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 95 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        14
## 
##   Number of observations                           405
##   Number of missing patterns                        21
## 
## Model Test User Model:
##                                                       
##   Test statistic                                 5.437
##   Degrees of freedom                                 6
##   P-value (Chi-square)                           0.489
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   int =~                                                                
##     ext6              1.000                               1.166    0.731
##     ext8              1.000                               1.166    0.625
##     ext10             1.000                               1.166    0.566
##     ext12             1.000                               1.166    0.546
##     ext14             1.000                               1.166    0.551
##   slp =~                                                                
##     ext6              0.000                               0.000    0.000
##     ext8              2.000                               1.040    0.558
##     ext10             4.000                               2.079    1.010
##     ext12             6.000                               3.119    1.461
##     ext14             8.000                               4.159    1.964
##   quad =~                                                               
##     ext6              0.000                               0.000    0.000
##     ext8              4.000                               0.228    0.122
##     ext10            16.000                               0.912    0.443
##     ext12            36.000                               2.051    0.961
##     ext14            64.000                               3.647    1.722
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   int ~~                                                                
##     slp              -0.108    0.209   -0.514    0.607   -0.177   -0.177
##     quad              0.018    0.023    0.772    0.440    0.270    0.270
##   slp ~~                                                                
##     quad             -0.029    0.015   -1.933    0.053   -0.970   -0.970
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .ext6              0.000                               0.000    0.000
##    .ext8              0.000                               0.000    0.000
##    .ext10             0.000                               0.000    0.000
##    .ext12             0.000                               0.000    0.000
##    .ext14             0.000                               0.000    0.000
##     int               1.567    0.088   17.809    0.000    1.344    1.344
##     slp               0.182    0.051    3.535    0.000    0.349    0.349
##     quad             -0.015    0.007   -2.300    0.021   -0.271   -0.271
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .ext6              1.188    0.431    2.758    0.006    1.188    0.466
##    .ext8              1.731    0.191    9.076    0.000    1.731    0.498
##    .ext10             1.691    0.215    7.858    0.000    1.691    0.399
##    .ext12             1.672    0.227    7.379    0.000    1.672    0.367
##    .ext14             1.381    0.649    2.128    0.033    1.381    0.308
##     int               1.360    0.431    3.159    0.002    1.000    1.000
##     slp               0.270    0.124    2.175    0.030    1.000    1.000
##     quad              0.003    0.002    1.705    0.088    1.000    1.000</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="04-shape.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lavTestLRT</span>(lin.lcm.fit, quad.lcm.fit)</span></code></pre></div>
<pre><code>## Chi-Squared Difference Test
## 
##              Df    AIC    BIC   Chisq Chisq diff Df diff Pr(&gt;Chisq)   
## quad.lcm.fit  6 5272.2 5328.2  5.4373                                 
## lin.lcm.fit  10 5278.2 5318.3 19.5065     14.069       4   0.007077 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The MLM syntax is similarly straightforward. To add a powered term, we can use the <code>I()</code> function, or the <code>poly()</code> function if we wished to use orthogonal polynomials.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="04-shape.html#cb119-1" aria-hidden="true" tabindex="-1"></a>quad.mlm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(ext <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> <span class="fu">I</span>(age<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> <span class="fu">I</span>(age<span class="sc">^</span><span class="dv">2</span>) <span class="sc">|</span> id),</span>
<span id="cb119-2"><a href="04-shape.html#cb119-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">na.action =</span> na.omit,</span>
<span id="cb119-3"><a href="04-shape.html#cb119-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">REML =</span> <span class="cn">TRUE</span>,</span>
<span id="cb119-4"><a href="04-shape.html#cb119-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> external.math.long,</span>
<span id="cb119-5"><a href="04-shape.html#cb119-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>,</span>
<span id="cb119-6"><a href="04-shape.html#cb119-6" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>)))</span>
<span id="cb119-7"><a href="04-shape.html#cb119-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-8"><a href="04-shape.html#cb119-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(quad.mlm, <span class="at">correlation =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: ext ~ 1 + age + I(age^2) + (1 + age + I(age^2) | id)
##    Data: external.math.long
## Control: lmerControl(optimizer = &quot;bobyqa&quot;, optCtrl = list(maxfun = 2e+05))
## 
## REML criterion at convergence: 5263.6
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.2948 -0.5378 -0.1802  0.4328  4.1605 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr       
##  id       (Intercept) 0.942815 0.97099             
##           age         0.162809 0.40350   0.27      
##           I(age^2)    0.001871 0.04326  -0.12 -0.96
##  Residual             1.684812 1.29800             
## Number of obs: 1357, groups:  id, 405
## 
## Fixed effects:
##               Estimate Std. Error         df t value Pr(&gt;|t|)    
## (Intercept)   1.574441   0.087961 345.812177  17.899  &lt; 2e-16 ***
## age           0.178332   0.051186 357.023423   3.484 0.000555 ***
## I(age^2)     -0.015107   0.006678 299.946134  -2.262 0.024398 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>While these models converge without too much issue here, note the strong correlation between the linear and quadratic terms, suggesting that the quadratic term is largely redundant. This is often the case with low numbers of repeated measures. We can technically fit some non-linearities, but they may not be particularly well-specified.</p>
<p>The LCSM syntax requires a bit more explanation. The quadratic model is shown below.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="04-shape.html#cb121-1" aria-hidden="true" tabindex="-1"></a>quad.lcsm <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb121-2"><a href="04-shape.html#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="st">             # Define Phantom Variables (p = phantom)</span></span>
<span id="cb121-3"><a href="04-shape.html#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="st">             pext6 =~ 1*ext6; ext6 ~ 0; ext6 ~~ ext6; pext6 ~~ 0*pext6</span></span>
<span id="cb121-4"><a href="04-shape.html#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="st">             pext8 =~ 1*ext8; ext8 ~ 0; ext8 ~~ ext8; pext8 ~~ 0*pext8</span></span>
<span id="cb121-5"><a href="04-shape.html#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="st">             pext10 =~ 1*ext10; ext10 ~ 0; ext10 ~~ ext10; pext10 ~~ 0*pext10</span></span>
<span id="cb121-6"><a href="04-shape.html#cb121-6" aria-hidden="true" tabindex="-1"></a><span class="st">             pext12 =~ 1*ext12; ext12 ~ 0; ext12 ~~ ext12; pext12 ~~ 0*pext12</span></span>
<span id="cb121-7"><a href="04-shape.html#cb121-7" aria-hidden="true" tabindex="-1"></a><span class="st">             pext14 =~ 1*ext14; ext14 ~ 0; ext14 ~~ ext14; pext14 ~~ 0*pext14</span></span>
<span id="cb121-8"><a href="04-shape.html#cb121-8" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb121-9"><a href="04-shape.html#cb121-9" aria-hidden="true" tabindex="-1"></a><span class="st">             # Regressions Between Adjacent Observations</span></span>
<span id="cb121-10"><a href="04-shape.html#cb121-10" aria-hidden="true" tabindex="-1"></a><span class="st">             pext8 ~ 1*pext6</span></span>
<span id="cb121-11"><a href="04-shape.html#cb121-11" aria-hidden="true" tabindex="-1"></a><span class="st">             pext10 ~ 1*pext8</span></span>
<span id="cb121-12"><a href="04-shape.html#cb121-12" aria-hidden="true" tabindex="-1"></a><span class="st">             pext12 ~ 1*pext10</span></span>
<span id="cb121-13"><a href="04-shape.html#cb121-13" aria-hidden="true" tabindex="-1"></a><span class="st">             pext14 ~ 1*pext12</span></span>
<span id="cb121-14"><a href="04-shape.html#cb121-14" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb121-15"><a href="04-shape.html#cb121-15" aria-hidden="true" tabindex="-1"></a><span class="st">             # Define Change Latent Variables (delta)</span></span>
<span id="cb121-16"><a href="04-shape.html#cb121-16" aria-hidden="true" tabindex="-1"></a><span class="st">             delta21 =~ 1*pext8;  delta21 ~~ 0*delta21</span></span>
<span id="cb121-17"><a href="04-shape.html#cb121-17" aria-hidden="true" tabindex="-1"></a><span class="st">             delta32 =~ 1*pext10; delta32 ~~ 0*delta32</span></span>
<span id="cb121-18"><a href="04-shape.html#cb121-18" aria-hidden="true" tabindex="-1"></a><span class="st">             delta43 =~ 1*pext12; delta43 ~~ 0*delta43</span></span>
<span id="cb121-19"><a href="04-shape.html#cb121-19" aria-hidden="true" tabindex="-1"></a><span class="st">             delta54 =~ 1*pext14; delta54 ~~ 0*delta54</span></span>
<span id="cb121-20"><a href="04-shape.html#cb121-20" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb121-21"><a href="04-shape.html#cb121-21" aria-hidden="true" tabindex="-1"></a><span class="st">             # Define Intercept and Slope</span></span>
<span id="cb121-22"><a href="04-shape.html#cb121-22" aria-hidden="true" tabindex="-1"></a><span class="st">             int  =~ 1*pext6</span></span>
<span id="cb121-23"><a href="04-shape.html#cb121-23" aria-hidden="true" tabindex="-1"></a><span class="st">             slp  =~ 2*delta21 + 2*delta32 + 2*delta43 + 2*delta54</span></span>
<span id="cb121-24"><a href="04-shape.html#cb121-24" aria-hidden="true" tabindex="-1"></a><span class="st">             quad =~ 4*delta21 + 12*delta32 + 20*delta43 + 28*delta54 </span></span>
<span id="cb121-25"><a href="04-shape.html#cb121-25" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb121-26"><a href="04-shape.html#cb121-26" aria-hidden="true" tabindex="-1"></a><span class="st">             int  ~ 1</span></span>
<span id="cb121-27"><a href="04-shape.html#cb121-27" aria-hidden="true" tabindex="-1"></a><span class="st">             slp  ~ 1</span></span>
<span id="cb121-28"><a href="04-shape.html#cb121-28" aria-hidden="true" tabindex="-1"></a><span class="st">             quad ~ 1</span></span>
<span id="cb121-29"><a href="04-shape.html#cb121-29" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb121-30"><a href="04-shape.html#cb121-30" aria-hidden="true" tabindex="-1"></a><span class="st">             int ~~ slp</span></span>
<span id="cb121-31"><a href="04-shape.html#cb121-31" aria-hidden="true" tabindex="-1"></a><span class="st">             int ~~ quad</span></span>
<span id="cb121-32"><a href="04-shape.html#cb121-32" aria-hidden="true" tabindex="-1"></a><span class="st">             slp ~~ slp</span></span>
<span id="cb121-33"><a href="04-shape.html#cb121-33" aria-hidden="true" tabindex="-1"></a><span class="st">             slp ~~ quad</span></span>
<span id="cb121-34"><a href="04-shape.html#cb121-34" aria-hidden="true" tabindex="-1"></a><span class="st">             quad ~~ quad</span></span>
<span id="cb121-35"><a href="04-shape.html#cb121-35" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span></code></pre></div>
<p>We talked in the <a href="02-canonical.html#canon">Canonical</a> chapter about how the loadings for the linear factor were all <span class="math inline">\(1\)</span>, and this could be thought of as summing across the difference factors. Another way to think of this specification is that the factor loadings for the LCSM are the <em>differences</em> between successive loadings for the LCM. In the standard linear case, these are all <span class="math inline">\(1\)</span>s to indicate a constant effect across units of time, whereas in our example in this chapter, they are all differences of <span class="math inline">\(2\)</span> to reflect biannual observations. The same principle can be applied to the loadings for higher-order factors in the LCSM. For a quadratic factor, the LCM loadings are [<span class="math inline">\(0\)</span>, <span class="math inline">\(4\)</span>, <span class="math inline">\(16\)</span>, <span class="math inline">\(36\)</span>, <span class="math inline">\(64\)</span>], and therefore the LCSM loadings should be [(<span class="math inline">\(4 - 0\)</span>), (<span class="math inline">\(16 - 4\)</span>), (<span class="math inline">\(36 - 16\)</span>), (<span class="math inline">\(64 - 36\)</span>)] = [<span class="math inline">\(4\)</span>, <span class="math inline">\(12\)</span>, <span class="math inline">\(20\)</span>, <span class="math inline">\(28\)</span>]. As a sanity check, we can fit this model and the parameter estimates should match the LCM results exactly.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="04-shape.html#cb122-1" aria-hidden="true" tabindex="-1"></a>quad.lcsm.fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(quad.lcsm,</span>
<span id="cb122-2"><a href="04-shape.html#cb122-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> external.math, </span>
<span id="cb122-3"><a href="04-shape.html#cb122-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb122-4"><a href="04-shape.html#cb122-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb122-5"><a href="04-shape.html#cb122-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-6"><a href="04-shape.html#cb122-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(quad.lcsm.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>, </span>
<span id="cb122-7"><a href="04-shape.html#cb122-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">TRUE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 95 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        14
## 
##   Number of observations                           405
##   Number of missing patterns                        21
## 
## Model Test User Model:
##                                                       
##   Test statistic                                 5.437
##   Degrees of freedom                                 6
##   P-value (Chi-square)                           0.489
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   pext6 =~                                                              
##     ext6              1.000                               1.166    0.731
##   pext8 =~                                                              
##     ext8              1.000                               1.322    0.709
##   pext10 =~                                                             
##     ext10             1.000                               1.597    0.775
##   pext12 =~                                                             
##     ext12             1.000                               1.698    0.796
##   pext14 =~                                                             
##     ext14             1.000                               1.761    0.832
##   delta21 =~                                                            
##     pext8             1.000                               0.621    0.621
##   delta32 =~                                                            
##     pext10            1.000                               0.257    0.257
##   delta43 =~                                                            
##     pext12            1.000                               0.167    0.167
##   delta54 =~                                                            
##     pext14            1.000                               0.362    0.362
##   int =~                                                                
##     pext6             1.000                               1.000    1.000
##   slp =~                                                                
##     delta21           2.000                               1.267    1.267
##     delta32           2.000                               2.529    2.529
##     delta43           2.000                               3.665    3.665
##     delta54           2.000                               1.629    1.629
##   quad =~                                                               
##     delta21           4.000                               0.278    0.278
##     delta32          12.000                               1.663    1.663
##     delta43          20.000                               4.017    4.017
##     delta54          28.000                               2.499    2.499
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   pext8 ~                                                               
##     pext6             1.000                               0.882    0.882
##   pext10 ~                                                              
##     pext8             1.000                               0.828    0.828
##   pext12 ~                                                              
##     pext10            1.000                               0.941    0.941
##   pext14 ~                                                              
##     pext12            1.000                               0.964    0.964
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   int ~~                                                                
##     slp              -0.108    0.209   -0.514    0.607   -0.177   -0.177
##     quad              0.018    0.023    0.772    0.440    0.270    0.270
##   slp ~~                                                                
##     quad             -0.029    0.015   -1.933    0.053   -0.970   -0.970
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .ext6              0.000                               0.000    0.000
##    .ext8              0.000                               0.000    0.000
##    .ext10             0.000                               0.000    0.000
##    .ext12             0.000                               0.000    0.000
##    .ext14             0.000                               0.000    0.000
##     int               1.567    0.088   17.809    0.000    1.344    1.344
##     slp               0.182    0.051    3.535    0.000    0.349    0.349
##     quad             -0.015    0.007   -2.300    0.021   -0.271   -0.271
##    .pext6             0.000                               0.000    0.000
##    .pext8             0.000                               0.000    0.000
##    .pext10            0.000                               0.000    0.000
##    .pext12            0.000                               0.000    0.000
##    .pext14            0.000                               0.000    0.000
##    .delta21           0.000                               0.000    0.000
##    .delta32           0.000                               0.000    0.000
##    .delta43           0.000                               0.000    0.000
##    .delta54           0.000                               0.000    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .ext6              1.188    0.431    2.758    0.006    1.188    0.466
##    .pext6             0.000                               0.000    0.000
##    .ext8              1.731    0.191    9.076    0.000    1.731    0.498
##    .pext8             0.000                               0.000    0.000
##    .ext10             1.691    0.215    7.858    0.000    1.691    0.399
##    .pext10            0.000                               0.000    0.000
##    .ext12             1.672    0.227    7.379    0.000    1.672    0.367
##    .pext12            0.000                               0.000    0.000
##    .ext14             1.381    0.649    2.128    0.033    1.381    0.308
##    .pext14            0.000                               0.000    0.000
##    .delta21           0.000                               0.000    0.000
##    .delta32           0.000                               0.000    0.000
##    .delta43           0.000                               0.000    0.000
##    .delta54           0.000                               0.000    0.000
##     slp               0.270    0.124    2.175    0.030    1.000    1.000
##     quad              0.003    0.002    1.705    0.088    1.000    1.000
##     int               1.360    0.431    3.159    0.002    1.000    1.000</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="04-shape.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lavTestLRT</span>(lin.lcsm.fit, quad.lcsm.fit)</span></code></pre></div>
<pre><code>## Chi-Squared Difference Test
## 
##               Df    AIC    BIC   Chisq Chisq diff Df diff Pr(&gt;Chisq)   
## quad.lcsm.fit  6 5272.2 5328.2  5.4373                                 
## lin.lcsm.fit  10 5278.2 5318.3 19.5065     14.069       4   0.007077 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="inverse-model" class="section level3 hasAnchor">
<h3>Inverse Model<a href="04-shape.html#inverse-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The final polynomial model we will consider is the inverse model. Unlike the quadratic curvature which reverses, the inverse curve approaches a plateau asymptotically. We can do a quick algebraic transformation to make the factor loadings tractable by inverting the original (i.e., not centered) values and subtracting them from <span class="math inline">\(1\)</span>. So for linear loadings [<span class="math inline">\(1\)</span>, <span class="math inline">\(3\)</span>, <span class="math inline">\(5\)</span>, <span class="math inline">\(7\)</span>, <span class="math inline">\(9\)</span>], we would have inverse factor loadings [<span class="math inline">\(1 - (1/1)\)</span>, <span class="math inline">\(1 - (1/3)\)</span>, <span class="math inline">\(1 - (1/5)\)</span>, <span class="math inline">\(1 - (1/7)\)</span>, <span class="math inline">\(1 - (1/9)\)</span>] or [<span class="math inline">\(0\)</span>, <span class="math inline">\(2/3\)</span>, <span class="math inline">\(4/5\)</span>, <span class="math inline">\(6/7\)</span>, <span class="math inline">\(8/9\)</span>]. Inverting the original loadings avoids trying to take the reciprocal of 0 (which results in 6 more weeks of COVID variants) and subtracting from one specifies an upper rather than lower bound effect (this won’t change the nature of the effect, it just makes the sign easier to interpret).</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="04-shape.html#cb126-1" aria-hidden="true" tabindex="-1"></a>inv.lcm <span class="ot">&lt;-</span> <span class="st">&quot;int =~ 1*ext6 + 1*ext8 + 1*ext10 + 1*ext12 + 1*ext14</span></span>
<span id="cb126-2"><a href="04-shape.html#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="st">            slp =~ 0*ext6 + 2*ext8 + 4*ext10 + 6*ext12 + 8*ext14</span></span>
<span id="cb126-3"><a href="04-shape.html#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="st">            inv =~ 0*ext6 + (2/3)*ext8 + (4/5)*ext10 + (6/7)*ext12 + (7/8)*ext14&quot;</span></span>
<span id="cb126-4"><a href="04-shape.html#cb126-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-5"><a href="04-shape.html#cb126-5" aria-hidden="true" tabindex="-1"></a>inv.lcm.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(inv.lcm, </span>
<span id="cb126-6"><a href="04-shape.html#cb126-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> external.math,</span>
<span id="cb126-7"><a href="04-shape.html#cb126-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb126-8"><a href="04-shape.html#cb126-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb126-9"><a href="04-shape.html#cb126-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-10"><a href="04-shape.html#cb126-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(inv.lcm.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>, </span>
<span id="cb126-11"><a href="04-shape.html#cb126-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">TRUE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 64 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        14
## 
##   Number of observations                           405
##   Number of missing patterns                        21
## 
## Model Test User Model:
##                                                       
##   Test statistic                                 5.839
##   Degrees of freedom                                 6
##   P-value (Chi-square)                           0.442
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   int =~                                                                
##     ext6              1.000                               1.747    1.099
##     ext8              1.000                               1.747    0.925
##     ext10             1.000                               1.747    0.855
##     ext12             1.000                               1.747    0.830
##     ext14             1.000                               1.747    0.799
##   slp =~                                                                
##     ext6              0.000                               0.000    0.000
##     ext8              2.000                               0.358    0.189
##     ext10             4.000                               0.716    0.350
##     ext12             6.000                               1.073    0.510
##     ext14             8.000                               1.431    0.654
##   inv =~                                                                
##     ext6              0.000                               0.000    0.000
##     ext8              0.667                               1.816    0.962
##     ext10             0.800                               2.179    1.066
##     ext12             0.857                               2.335    1.109
##     ext14             0.875                               2.384    1.090
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   int ~~                                                                
##     slp               0.175    0.141    1.240    0.215    0.560    0.560
##     inv              -3.251    3.076   -1.057    0.290   -0.683   -0.683
##   slp ~~                                                                
##     inv              -0.335    0.302   -1.109    0.267   -0.688   -0.688
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .ext6              0.000                               0.000    0.000
##    .ext8              0.000                               0.000    0.000
##    .ext10             0.000                               0.000    0.000
##    .ext12             0.000                               0.000    0.000
##    .ext14             0.000                               0.000    0.000
##     int               1.551    0.091   17.075    0.000    0.887    0.887
##     slp               0.014    0.030    0.458    0.647    0.076    0.076
##     inv               0.513    0.217    2.368    0.018    0.188    0.188
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .ext6             -0.523    1.838   -0.285    0.776   -0.523   -0.207
##    .ext8              1.617    0.240    6.739    0.000    1.617    0.453
##    .ext10             1.811    0.203    8.939    0.000    1.811    0.433
##    .ext12             1.696    0.227    7.461    0.000    1.696    0.383
##    .ext14             1.582    0.447    3.541    0.000    1.582    0.331
##     int               3.052    1.850    1.650    0.099    1.000    1.000
##     slp               0.032    0.033    0.978    0.328    1.000    1.000
##     inv               7.422    5.288    1.404    0.160    1.000    1.000</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="04-shape.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lavTestLRT</span>(lin.lcm.fit, inv.lcm.fit)</span></code></pre></div>
<pre><code>## Chi-Squared Difference Test
## 
##             Df    AIC    BIC   Chisq Chisq diff Df diff Pr(&gt;Chisq)   
## inv.lcm.fit  6 5272.6 5328.6  5.8386                                 
## lin.lcm.fit 10 5278.2 5318.3 19.5065     13.668       4   0.008434 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Note that we are comparing the inverse and linear models, not the inverse and quadratic. This is because while the linear model is nested within both quadratic and inverse models, the two are not nested with respect to one another. However, we might graphically examine the trends implied by the model for a moment.</p>
<p><img src="longitudinal_primer_files/figure-html/polynomials%2014-1.png" width="672" /><img src="longitudinal_primer_files/figure-html/polynomials%2014-2.png" width="672" /></p>
<p>What should be visually apparent is that we get quite a few flips in the direction of curvature in the inverse compared to the quadratic model. Indeed the quadratic effect is negative (<span class="math inline">\(-0.015\)</span>) and the inverse effect is positive (<span class="math inline">\(0.513\)</span>). This sensitivity is likely another indication that curvature is really over-fitting noise in these data rather than reflecting some true non-linearity. Below are how to achieve this model with the MLM:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="04-shape.html#cb130-1" aria-hidden="true" tabindex="-1"></a>external.math.long<span class="sc">$</span>age_inv <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (external.math.long<span class="sc">$</span>age <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb130-2"><a href="04-shape.html#cb130-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-3"><a href="04-shape.html#cb130-3" aria-hidden="true" tabindex="-1"></a>inv.mlm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(ext <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> age_inv <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> age_inv <span class="sc">|</span> id),</span>
<span id="cb130-4"><a href="04-shape.html#cb130-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">na.action =</span> na.omit,</span>
<span id="cb130-5"><a href="04-shape.html#cb130-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">REML =</span> <span class="cn">TRUE</span>,</span>
<span id="cb130-6"><a href="04-shape.html#cb130-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> external.math.long,</span>
<span id="cb130-7"><a href="04-shape.html#cb130-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>,</span>
<span id="cb130-8"><a href="04-shape.html#cb130-8" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>)))</span>
<span id="cb130-9"><a href="04-shape.html#cb130-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-10"><a href="04-shape.html#cb130-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(inv.mlm, <span class="at">correlation =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: ext ~ 1 + age + age_inv + (1 + age + age_inv | id)
##    Data: external.math.long
## Control: lmerControl(optimizer = &quot;bobyqa&quot;, optCtrl = list(maxfun = 2e+05))
## 
## REML criterion at convergence: 5257.8
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.2607 -0.5446 -0.1801  0.4579  4.1099 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr       
##  id       (Intercept) 0.83374  0.9131              
##           age         0.01219  0.1104    0.20      
##           age_inv     0.90851  0.9532    0.51 -0.17
##  Residual             1.72231  1.3124              
## Number of obs: 1357, groups:  id, 405
## 
## Fixed effects:
##              Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)   1.56085    0.09081 319.40910  17.188   &lt;2e-16 ***
## age           0.01432    0.02980 283.40395   0.480   0.6313    
## age_inv       0.49152    0.21733 353.11560   2.262   0.0243 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="04-shape.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lin.mlm, inv.mlm)</span></code></pre></div>
<pre><code>## Data: external.math.long
## Models:
## lin.mlm: ext ~ 1 + age + (1 + age | id)
## inv.mlm: ext ~ 1 + age + age_inv + (1 + age + age_inv | id)
##         npar    AIC  BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)  
## lin.mlm    6 5271.7 5303 -2629.9   5259.7                       
## inv.mlm   10 5266.9 5319 -2623.4   5246.9 12.825  4    0.01216 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>and LCSM (note that the subtraction method gets a little messy for the slope loadings):</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="04-shape.html#cb134-1" aria-hidden="true" tabindex="-1"></a>inv.lcsm <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb134-2"><a href="04-shape.html#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="st">            # Define Phantom Variables (p = phantom)</span></span>
<span id="cb134-3"><a href="04-shape.html#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="st">            pext6 =~ 1*ext6; ext6 ~ 0; ext6 ~~ ext6; pext6 ~~ 0*pext6</span></span>
<span id="cb134-4"><a href="04-shape.html#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="st">            pext8 =~ 1*ext8; ext8 ~ 0; ext8 ~~ ext8; pext8 ~~ 0*pext8</span></span>
<span id="cb134-5"><a href="04-shape.html#cb134-5" aria-hidden="true" tabindex="-1"></a><span class="st">            pext10 =~ 1*ext10; ext10 ~ 0; ext10 ~~ ext10; pext10 ~~ 0*pext10</span></span>
<span id="cb134-6"><a href="04-shape.html#cb134-6" aria-hidden="true" tabindex="-1"></a><span class="st">            pext12 =~ 1*ext12; ext12 ~ 0; ext12 ~~ ext12; pext12 ~~ 0*pext12</span></span>
<span id="cb134-7"><a href="04-shape.html#cb134-7" aria-hidden="true" tabindex="-1"></a><span class="st">            pext14 =~ 1*ext14; ext14 ~ 0; ext14 ~~ ext14; pext14 ~~ 0*pext14</span></span>
<span id="cb134-8"><a href="04-shape.html#cb134-8" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb134-9"><a href="04-shape.html#cb134-9" aria-hidden="true" tabindex="-1"></a><span class="st">            # Regressions Between Adjacent Observations</span></span>
<span id="cb134-10"><a href="04-shape.html#cb134-10" aria-hidden="true" tabindex="-1"></a><span class="st">            pext8 ~ 1*pext6</span></span>
<span id="cb134-11"><a href="04-shape.html#cb134-11" aria-hidden="true" tabindex="-1"></a><span class="st">            pext10 ~ 1*pext8</span></span>
<span id="cb134-12"><a href="04-shape.html#cb134-12" aria-hidden="true" tabindex="-1"></a><span class="st">            pext12 ~ 1*pext10</span></span>
<span id="cb134-13"><a href="04-shape.html#cb134-13" aria-hidden="true" tabindex="-1"></a><span class="st">            pext14 ~ 1*pext12</span></span>
<span id="cb134-14"><a href="04-shape.html#cb134-14" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb134-15"><a href="04-shape.html#cb134-15" aria-hidden="true" tabindex="-1"></a><span class="st">            # Define Change Latent Variables (delta)</span></span>
<span id="cb134-16"><a href="04-shape.html#cb134-16" aria-hidden="true" tabindex="-1"></a><span class="st">            delta21 =~ 1*pext8;  delta21 ~~ 0*delta21</span></span>
<span id="cb134-17"><a href="04-shape.html#cb134-17" aria-hidden="true" tabindex="-1"></a><span class="st">            delta32 =~ 1*pext10; delta32 ~~ 0*delta32</span></span>
<span id="cb134-18"><a href="04-shape.html#cb134-18" aria-hidden="true" tabindex="-1"></a><span class="st">            delta43 =~ 1*pext12; delta43 ~~ 0*delta43</span></span>
<span id="cb134-19"><a href="04-shape.html#cb134-19" aria-hidden="true" tabindex="-1"></a><span class="st">            delta54 =~ 1*pext14; delta54 ~~ 0*delta54</span></span>
<span id="cb134-20"><a href="04-shape.html#cb134-20" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb134-21"><a href="04-shape.html#cb134-21" aria-hidden="true" tabindex="-1"></a><span class="st">            # Define Intercept and Slope</span></span>
<span id="cb134-22"><a href="04-shape.html#cb134-22" aria-hidden="true" tabindex="-1"></a><span class="st">            int =~ 1*pext6</span></span>
<span id="cb134-23"><a href="04-shape.html#cb134-23" aria-hidden="true" tabindex="-1"></a><span class="st">            slp =~ 2*delta21 + 2*delta32 + 2*delta43 + 2*delta54</span></span>
<span id="cb134-24"><a href="04-shape.html#cb134-24" aria-hidden="true" tabindex="-1"></a><span class="st">            inv =~ (2/3)*delta21 + (2/15)*delta32 + (2/35)*delta43 + (1/56)*delta54 </span></span>
<span id="cb134-25"><a href="04-shape.html#cb134-25" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb134-26"><a href="04-shape.html#cb134-26" aria-hidden="true" tabindex="-1"></a><span class="st">            int ~ 1</span></span>
<span id="cb134-27"><a href="04-shape.html#cb134-27" aria-hidden="true" tabindex="-1"></a><span class="st">            slp ~ 1</span></span>
<span id="cb134-28"><a href="04-shape.html#cb134-28" aria-hidden="true" tabindex="-1"></a><span class="st">            inv ~ 1</span></span>
<span id="cb134-29"><a href="04-shape.html#cb134-29" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb134-30"><a href="04-shape.html#cb134-30" aria-hidden="true" tabindex="-1"></a><span class="st">            int ~~ slp</span></span>
<span id="cb134-31"><a href="04-shape.html#cb134-31" aria-hidden="true" tabindex="-1"></a><span class="st">            int ~~ inv</span></span>
<span id="cb134-32"><a href="04-shape.html#cb134-32" aria-hidden="true" tabindex="-1"></a><span class="st">            slp ~~ slp</span></span>
<span id="cb134-33"><a href="04-shape.html#cb134-33" aria-hidden="true" tabindex="-1"></a><span class="st">            slp ~~ inv</span></span>
<span id="cb134-34"><a href="04-shape.html#cb134-34" aria-hidden="true" tabindex="-1"></a><span class="st">            inv ~~ inv</span></span>
<span id="cb134-35"><a href="04-shape.html#cb134-35" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb134-36"><a href="04-shape.html#cb134-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-37"><a href="04-shape.html#cb134-37" aria-hidden="true" tabindex="-1"></a>inv.lcsm.fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(inv.lcsm,</span>
<span id="cb134-38"><a href="04-shape.html#cb134-38" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> external.math, </span>
<span id="cb134-39"><a href="04-shape.html#cb134-39" aria-hidden="true" tabindex="-1"></a>                    <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb134-40"><a href="04-shape.html#cb134-40" aria-hidden="true" tabindex="-1"></a>                    <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb134-41"><a href="04-shape.html#cb134-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-42"><a href="04-shape.html#cb134-42" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(inv.lcsm.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>, </span>
<span id="cb134-43"><a href="04-shape.html#cb134-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">TRUE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 64 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        14
## 
##   Number of observations                           405
##   Number of missing patterns                        21
## 
## Model Test User Model:
##                                                       
##   Test statistic                                 5.839
##   Degrees of freedom                                 6
##   P-value (Chi-square)                           0.442
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   pext6 =~                                                              
##     ext6              1.000                               1.747    1.099
##   pext8 =~                                                              
##     ext8              1.000                               1.397    0.739
##   pext10 =~                                                             
##     ext10             1.000                               1.539    0.753
##   pext12 =~                                                             
##     ext12             1.000                               1.655    0.786
##   pext14 =~                                                             
##     ext14             1.000                               1.790    0.818
##   delta21 =~                                                            
##     pext8             1.000                               1.140    1.140
##   delta32 =~                                                            
##     pext10            1.000                               0.185    0.185
##   delta43 =~                                                            
##     pext12            1.000                               0.166    0.166
##   delta54 =~                                                            
##     pext14            1.000                               0.182    0.182
##   int =~                                                                
##     pext6             1.000                               1.000    1.000
##   slp =~                                                                
##     delta21           2.000                               0.225    0.225
##     delta32           2.000                               1.255    1.255
##     delta43           2.000                               1.301    1.301
##     delta54           2.000                               1.097    1.097
##   inv =~                                                                
##     delta21           0.667                               1.141    1.141
##     delta32           0.133                               1.274    1.274
##     delta43           0.057                               0.566    0.566
##     delta54           0.018                               0.149    0.149
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   pext8 ~                                                               
##     pext6             1.000                               1.251    1.251
##   pext10 ~                                                              
##     pext8             1.000                               0.908    0.908
##   pext12 ~                                                              
##     pext10            1.000                               0.930    0.930
##   pext14 ~                                                              
##     pext12            1.000                               0.925    0.925
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   int ~~                                                                
##     slp               0.175    0.141    1.240    0.215    0.560    0.560
##     inv              -3.251    3.076   -1.057    0.290   -0.683   -0.683
##   slp ~~                                                                
##     inv              -0.335    0.302   -1.109    0.267   -0.688   -0.688
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .ext6              0.000                               0.000    0.000
##    .ext8              0.000                               0.000    0.000
##    .ext10             0.000                               0.000    0.000
##    .ext12             0.000                               0.000    0.000
##    .ext14             0.000                               0.000    0.000
##     int               1.551    0.091   17.075    0.000    0.887    0.887
##     slp               0.014    0.030    0.458    0.647    0.076    0.076
##     inv               0.513    0.217    2.368    0.018    0.188    0.188
##    .pext6             0.000                               0.000    0.000
##    .pext8             0.000                               0.000    0.000
##    .pext10            0.000                               0.000    0.000
##    .pext12            0.000                               0.000    0.000
##    .pext14            0.000                               0.000    0.000
##    .delta21           0.000                               0.000    0.000
##    .delta32           0.000                               0.000    0.000
##    .delta43           0.000                               0.000    0.000
##    .delta54           0.000                               0.000    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .ext6             -0.523    1.838   -0.285    0.776   -0.523   -0.207
##    .pext6             0.000                               0.000    0.000
##    .ext8              1.617    0.240    6.739    0.000    1.617    0.453
##    .pext8             0.000                               0.000    0.000
##    .ext10             1.811    0.203    8.939    0.000    1.811    0.433
##    .pext10            0.000                               0.000    0.000
##    .ext12             1.696    0.227    7.461    0.000    1.696    0.383
##    .pext12            0.000                               0.000    0.000
##    .ext14             1.582    0.447    3.541    0.000    1.582    0.331
##    .pext14            0.000                               0.000    0.000
##    .delta21           0.000                               0.000    0.000
##    .delta32           0.000                               0.000    0.000
##    .delta43           0.000                               0.000    0.000
##    .delta54           0.000                               0.000    0.000
##     slp               0.032    0.033    0.978    0.328    1.000    1.000
##     inv               7.422    5.288    1.404    0.160    1.000    1.000
##     int               3.052    1.850    1.650    0.099    1.000    1.000</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="04-shape.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lavTestLRT</span>(lin.lcsm.fit, inv.lcsm.fit)</span></code></pre></div>
<pre><code>## Chi-Squared Difference Test
## 
##              Df    AIC    BIC   Chisq Chisq diff Df diff Pr(&gt;Chisq)   
## inv.lcsm.fit  6 5272.6 5328.6  5.8386                                 
## lin.lcsm.fit 10 5278.2 5318.3 19.5065     13.668       4   0.008434 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
</div>
<div id="piecewise-trajectories" class="section level2 hasAnchor">
<h2>Piecewise Trajectories<a href="04-shape.html#piecewise-trajectories" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If we do not think that a single polynomial function can sufficiently capture a complex trajectory, we might consider bolting two (or more) polynomial functions together using a piecewise approach. Here we will use the <code>adversity</code> data which covers <span class="math inline">\(8\)</span> years of childhood (ages <span class="math inline">\(4-11\)</span>). The simplest piecewise trajectory can be constructed two distinct linear pieces joined at a knot point. We need at least 3 time points to specify a line but the pieces can share a time point at the knot point. This means we need a minimum of <span class="math inline">\(5\)</span> time points in order to fit even the simplest piecewise model. Note that with this minimum, the knot point is constrained to be at the middle time point, and the knot can never be placed at the first or last two time points because of the 3 time point requirement to estimate the linear slope. Note that as we discussed before, these time point requirements can be accomodated at the group level, and no one individual need be observed <span class="math inline">\(5\)</span> or more times. Indeed this is the case here, where no individual is measured more than <span class="math inline">\(4\)</span> times.</p>
<p>There are two general approaches for specifying piecewise models. The first, and more common, approach is the two-rate specification, where each effect can be interpreted in isolation like a regular linear model. We specify the two-rate LCM using the syntax below. Note that we code the factor loadings in such a way that the intercept is at the knot point (age 8).</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="04-shape.html#cb138-1" aria-hidden="true" tabindex="-1"></a>two.rate <span class="ot">&lt;-</span> <span class="st">&quot;int  =~ 1*fmin4 + 1*fmin5 + 1*fmin6 + 1*fmin7 + </span></span>
<span id="cb138-2"><a href="04-shape.html#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="st">                     1*fmin8 + 1*fmin9 + 1*fmin10 + 1*fmin11</span></span>
<span id="cb138-3"><a href="04-shape.html#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="st">             slp1 =~ -3*fmin4 + -2*fmin5 + -1*fmin6 + 0*fmin7 + </span></span>
<span id="cb138-4"><a href="04-shape.html#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="st">                     0*fmin8 + 0*fmin9 + 0*fmin10 + 0*fmin11</span></span>
<span id="cb138-5"><a href="04-shape.html#cb138-5" aria-hidden="true" tabindex="-1"></a><span class="st">             slp2 =~ 0*fmin4 + 0*fmin5 + 0*fmin6 + 0*fmin7 + </span></span>
<span id="cb138-6"><a href="04-shape.html#cb138-6" aria-hidden="true" tabindex="-1"></a><span class="st">                     1*fmin8 + 2*fmin9 + 3*fmin10 + 4*fmin11</span></span>
<span id="cb138-7"><a href="04-shape.html#cb138-7" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb138-8"><a href="04-shape.html#cb138-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-9"><a href="04-shape.html#cb138-9" aria-hidden="true" tabindex="-1"></a>two.rate.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(two.rate,</span>
<span id="cb138-10"><a href="04-shape.html#cb138-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> adversity,</span>
<span id="cb138-11"><a href="04-shape.html#cb138-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb138-12"><a href="04-shape.html#cb138-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb138-13"><a href="04-shape.html#cb138-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-14"><a href="04-shape.html#cb138-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(two.rate.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>,</span>
<span id="cb138-15"><a href="04-shape.html#cb138-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">TRUE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 50 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        17
## 
##   Number of observations                           398
##   Number of missing patterns                        40
## 
## Model Test User Model:
##                                                       
##   Test statistic                                35.322
##   Degrees of freedom                                27
##   P-value (Chi-square)                           0.131
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   int =~                                                                
##     fmin4             1.000                               0.886    0.888
##     fmin5             1.000                               0.886    0.942
##     fmin6             1.000                               0.886    0.824
##     fmin7             1.000                               0.886    0.761
##     fmin8             1.000                               0.886    0.706
##     fmin9             1.000                               0.886    0.720
##     fmin10            1.000                               0.886    0.739
##     fmin11            1.000                               0.886    0.661
##   slp1 =~                                                               
##     fmin4            -3.000                              -0.985   -0.987
##     fmin5            -2.000                              -0.657   -0.698
##     fmin6            -1.000                              -0.328   -0.305
##     fmin7             0.000                               0.000    0.000
##     fmin8             0.000                               0.000    0.000
##     fmin9             0.000                               0.000    0.000
##     fmin10            0.000                               0.000    0.000
##     fmin11            0.000                               0.000    0.000
##   slp2 =~                                                               
##     fmin4             0.000                               0.000    0.000
##     fmin5             0.000                               0.000    0.000
##     fmin6             0.000                               0.000    0.000
##     fmin7             0.000                               0.000    0.000
##     fmin8             1.000                               0.068    0.054
##     fmin9             2.000                               0.136    0.111
##     fmin10            3.000                               0.204    0.170
##     fmin11            4.000                               0.272    0.203
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   int ~~                                                                
##     slp1              0.138    0.062    2.233    0.026    0.475    0.475
##     slp2              0.027    0.045    0.602    0.547    0.449    0.449
##   slp1 ~~                                                               
##     slp2              0.011    0.019    0.548    0.584    0.475    0.475
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .fmin4             0.000                               0.000    0.000
##    .fmin5             0.000                               0.000    0.000
##    .fmin6             0.000                               0.000    0.000
##    .fmin7             0.000                               0.000    0.000
##    .fmin8             0.000                               0.000    0.000
##    .fmin9             0.000                               0.000    0.000
##    .fmin10            0.000                               0.000    0.000
##    .fmin11            0.000                               0.000    0.000
##     int               0.216    0.062    3.495    0.000    0.244    0.244
##     slp1              0.079    0.029    2.741    0.006    0.239    0.239
##     slp2              0.031    0.020    1.576    0.115    0.455    0.455
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .fmin4             0.069    0.388    0.178    0.859    0.069    0.069
##    .fmin5             0.221    0.190    1.161    0.246    0.221    0.250
##    .fmin6             0.539    0.103    5.231    0.000    0.539    0.466
##    .fmin7             0.570    0.156    3.653    0.000    0.570    0.420
##    .fmin8             0.731    0.129    5.671    0.000    0.731    0.464
##    .fmin9             0.605    0.099    6.108    0.000    0.605    0.399
##    .fmin10            0.450    0.123    3.664    0.000    0.450    0.312
##    .fmin11            0.722    0.172    4.191    0.000    0.722    0.401
##     int               0.786    0.151    5.215    0.000    1.000    1.000
##     slp1              0.108    0.056    1.919    0.055    1.000    1.000
##     slp2              0.005    0.019    0.240    0.810    1.000    1.000</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="04-shape.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">id=</span>two.rate.fit<span class="sc">@</span>Data<span class="sc">@</span>case.idx[[<span class="dv">1</span>]], </span>
<span id="cb140-2"><a href="04-shape.html#cb140-2" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">lavPredict</span>(two.rate.fit,<span class="at">type=</span><span class="st">&quot;ov&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb140-3"><a href="04-shape.html#cb140-3" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;fmin&quot;</span>), </span>
<span id="cb140-4"><a href="04-shape.html#cb140-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;.value&quot;</span>, <span class="st">&quot;age&quot;</span>), </span>
<span id="cb140-5"><a href="04-shape.html#cb140-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">names_pattern =</span> <span class="st">&quot;(fmin)(.+)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb140-6"><a href="04-shape.html#cb140-6" aria-hidden="true" tabindex="-1"></a>                  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age =</span> <span class="fu">as.numeric</span>(age)), </span>
<span id="cb140-7"><a href="04-shape.html#cb140-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> age, </span>
<span id="cb140-8"><a href="04-shape.html#cb140-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> fmin, </span>
<span id="cb140-9"><a href="04-shape.html#cb140-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">group =</span> id, </span>
<span id="cb140-10"><a href="04-shape.html#cb140-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> <span class="fu">factor</span>(id))) <span class="sc">+</span></span>
<span id="cb140-11"><a href="04-shape.html#cb140-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb140-12"><a href="04-shape.html#cb140-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;2-Rate Piecewise LCM Trajectories&quot;</span>,</span>
<span id="cb140-13"><a href="04-shape.html#cb140-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Age&quot;</span>,</span>
<span id="cb140-14"><a href="04-shape.html#cb140-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Predicted Forceps Minor Microstructure&quot;</span>) <span class="sc">+</span></span>
<span id="cb140-15"><a href="04-shape.html#cb140-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) </span></code></pre></div>
<p><img src="longitudinal_primer_files/figure-html/piecewise%2001-1.png" width="672" /></p>
<p>The second approach is the added-rate approach where the second slope is defined as the deflection from the original trajectory. We can see this approach below.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="04-shape.html#cb141-1" aria-hidden="true" tabindex="-1"></a>add.rate <span class="ot">&lt;-</span> <span class="st">&quot;int  =~ 1*fmin4 + 1*fmin5 + 1*fmin6 + 1*fmin7 + </span></span>
<span id="cb141-2"><a href="04-shape.html#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="st">                     1*fmin8 + 1*fmin9 + 1*fmin10 + 1*fmin11</span></span>
<span id="cb141-3"><a href="04-shape.html#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="st">             slp1 =~ -3*fmin4 + -2*fmin5 + -1*fmin6 + 0*fmin7 + </span></span>
<span id="cb141-4"><a href="04-shape.html#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="st">                     1*fmin8 + 2*fmin9 + 3*fmin10 + 4*fmin11</span></span>
<span id="cb141-5"><a href="04-shape.html#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="st">             slp2 =~ 0*fmin4 + 0*fmin5 + 0*fmin6 + 0*fmin7 + </span></span>
<span id="cb141-6"><a href="04-shape.html#cb141-6" aria-hidden="true" tabindex="-1"></a><span class="st">                     1*fmin8 + 2*fmin9 + 3*fmin10 + 4*fmin11</span></span>
<span id="cb141-7"><a href="04-shape.html#cb141-7" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb141-8"><a href="04-shape.html#cb141-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-9"><a href="04-shape.html#cb141-9" aria-hidden="true" tabindex="-1"></a>add.rate.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(add.rate,</span>
<span id="cb141-10"><a href="04-shape.html#cb141-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> adversity,</span>
<span id="cb141-11"><a href="04-shape.html#cb141-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb141-12"><a href="04-shape.html#cb141-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb141-13"><a href="04-shape.html#cb141-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-14"><a href="04-shape.html#cb141-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(add.rate.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>,</span>
<span id="cb141-15"><a href="04-shape.html#cb141-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">TRUE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 44 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        17
## 
##   Number of observations                           398
##   Number of missing patterns                        40
## 
## Model Test User Model:
##                                                       
##   Test statistic                                35.322
##   Degrees of freedom                                27
##   P-value (Chi-square)                           0.131
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   int =~                                                                
##     fmin4             1.000                               0.886    0.888
##     fmin5             1.000                               0.886    0.942
##     fmin6             1.000                               0.886    0.824
##     fmin7             1.000                               0.886    0.761
##     fmin8             1.000                               0.886    0.706
##     fmin9             1.000                               0.886    0.720
##     fmin10            1.000                               0.886    0.739
##     fmin11            1.000                               0.886    0.661
##   slp1 =~                                                               
##     fmin4            -3.000                              -0.985   -0.987
##     fmin5            -2.000                              -0.657   -0.698
##     fmin6            -1.000                              -0.328   -0.305
##     fmin7             0.000                               0.000    0.000
##     fmin8             1.000                               0.328    0.262
##     fmin9             2.000                               0.657    0.533
##     fmin10            3.000                               0.985    0.821
##     fmin11            4.000                               1.314    0.980
##   slp2 =~                                                               
##     fmin4             0.000                               0.000    0.000
##     fmin5             0.000                               0.000    0.000
##     fmin6             0.000                               0.000    0.000
##     fmin7             0.000                               0.000    0.000
##     fmin8             1.000                               0.302    0.241
##     fmin9             2.000                               0.604    0.491
##     fmin10            3.000                               0.906    0.755
##     fmin11            4.000                               1.209    0.901
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   int ~~                                                                
##     slp1              0.138    0.062    2.233    0.026    0.475    0.475
##     slp2             -0.111    0.101   -1.099    0.272   -0.415   -0.415
##   slp1 ~~                                                               
##     slp2             -0.097    0.067   -1.441    0.149   -0.980   -0.980
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .fmin4             0.000                               0.000    0.000
##    .fmin5             0.000                               0.000    0.000
##    .fmin6             0.000                               0.000    0.000
##    .fmin7             0.000                               0.000    0.000
##    .fmin8             0.000                               0.000    0.000
##    .fmin9             0.000                               0.000    0.000
##    .fmin10            0.000                               0.000    0.000
##    .fmin11            0.000                               0.000    0.000
##     int               0.216    0.062    3.495    0.000    0.244    0.244
##     slp1              0.079    0.029    2.741    0.006    0.239    0.239
##     slp2             -0.048    0.041   -1.150    0.250   -0.157   -0.157
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .fmin4             0.069    0.388    0.178    0.859    0.069    0.069
##    .fmin5             0.221    0.190    1.161    0.246    0.221    0.250
##    .fmin6             0.539    0.103    5.231    0.000    0.539    0.466
##    .fmin7             0.570    0.156    3.653    0.000    0.570    0.420
##    .fmin8             0.731    0.129    5.671    0.000    0.731    0.464
##    .fmin9             0.605    0.099    6.108    0.000    0.605    0.399
##    .fmin10            0.450    0.123    3.664    0.000    0.450    0.312
##    .fmin11            0.722    0.172    4.191    0.000    0.722    0.401
##     int               0.786    0.151    5.215    0.000    1.000    1.000
##     slp1              0.108    0.056    1.919    0.055    1.000    1.000
##     slp2              0.091    0.094    0.968    0.333    1.000    1.000</code></pre>
<p>Note that whichever approach we take, the models fit the data identically. This means that the choice between these two specifications should be guided by theoretical considerations of which type of effect you would prefer to interpret.</p>
<p>Of course, the models we have seen thus far in this section are the simplest linear-linear piecewise functions we can specify. We could even better specify these linear pieces with additional time points, or we could potentially increase the polynomial order of one or more of the pieces. This could be a great way to model nonlinear growth followed by a plateau for instance. Below, we demonstrate a quadratic-linear piecewise function that could capture this type of growth pattern. To identify this model, we can use trial-level data from the <code>feedback.learning</code> dataset source, with 4 trials specifying the quadratic initial piece, and the remaining trials specifying the second linear slope. Below we show the code to fit and visualize this model.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="04-shape.html#cb143-1" aria-hidden="true" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/trials.csv&quot;</span>)</span>
<span id="cb143-2"><a href="04-shape.html#cb143-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-3"><a href="04-shape.html#cb143-3" aria-hidden="true" tabindex="-1"></a>quad.rate <span class="ot">&lt;-</span> <span class="st">&quot;int =~ 1*trial.1 + 1*trial.2 + 1*trial.3 + 1*trial.4 + </span></span>
<span id="cb143-4"><a href="04-shape.html#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="st">                     1*trial.5 + 1*trial.6 + 1*trial.7</span></span>
<span id="cb143-5"><a href="04-shape.html#cb143-5" aria-hidden="true" tabindex="-1"></a><span class="st">             slp1 =~ -3*trial.1 + -2*trial.2 + -1*trial.3 + 0*trial.4 + </span></span>
<span id="cb143-6"><a href="04-shape.html#cb143-6" aria-hidden="true" tabindex="-1"></a><span class="st">                     0*trial.5 + 0*trial.6 + 0*trial.7</span></span>
<span id="cb143-7"><a href="04-shape.html#cb143-7" aria-hidden="true" tabindex="-1"></a><span class="st">             quad =~ 9*trial.1 + 4*trial.2 + 1*trial.3 + 0*trial.4 + </span></span>
<span id="cb143-8"><a href="04-shape.html#cb143-8" aria-hidden="true" tabindex="-1"></a><span class="st">                     0*trial.5 + 0*trial.6 + 0*trial.7        </span></span>
<span id="cb143-9"><a href="04-shape.html#cb143-9" aria-hidden="true" tabindex="-1"></a><span class="st">             slp2 =~ 0*trial.1 + 0*trial.2 + 0*trial.3 + 0*trial.4 + </span></span>
<span id="cb143-10"><a href="04-shape.html#cb143-10" aria-hidden="true" tabindex="-1"></a><span class="st">                     1*trial.5 + 2*trial.6 + 3*trial.7</span></span>
<span id="cb143-11"><a href="04-shape.html#cb143-11" aria-hidden="true" tabindex="-1"></a><span class="st">             </span></span>
<span id="cb143-12"><a href="04-shape.html#cb143-12" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb143-13"><a href="04-shape.html#cb143-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-14"><a href="04-shape.html#cb143-14" aria-hidden="true" tabindex="-1"></a>quad.rate.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(quad.rate,</span>
<span id="cb143-15"><a href="04-shape.html#cb143-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> trials,</span>
<span id="cb143-16"><a href="04-shape.html#cb143-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb143-17"><a href="04-shape.html#cb143-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb143-18"><a href="04-shape.html#cb143-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-19"><a href="04-shape.html#cb143-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(quad.rate.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>,</span>
<span id="cb143-20"><a href="04-shape.html#cb143-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">TRUE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 55 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        21
## 
##   Number of observations                           297
##   Number of missing patterns                         2
## 
## Model Test User Model:
##                                                       
##   Test statistic                                46.778
##   Degrees of freedom                                14
##   P-value (Chi-square)                           0.000
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   int =~                                                                
##     trial.1           1.000                               0.900    0.904
##     trial.2           1.000                               0.900    0.866
##     trial.3           1.000                               0.900    0.821
##     trial.4           1.000                               0.900    0.830
##     trial.5           1.000                               0.900    0.819
##     trial.6           1.000                               0.900    0.780
##     trial.7           1.000                               0.900    0.718
##   slp1 =~                                                               
##     trial.1          -3.000                              -0.846   -0.851
##     trial.2          -2.000                              -0.564   -0.543
##     trial.3          -1.000                              -0.282   -0.257
##     trial.4           0.000                               0.000    0.000
##     trial.5           0.000                               0.000    0.000
##     trial.6           0.000                               0.000    0.000
##     trial.7           0.000                               0.000    0.000
##   quad =~                                                               
##     trial.1           9.000                               1.028    1.033
##     trial.2           4.000                               0.457    0.440
##     trial.3           1.000                               0.114    0.104
##     trial.4           0.000                               0.000    0.000
##     trial.5           0.000                               0.000    0.000
##     trial.6           0.000                               0.000    0.000
##     trial.7           0.000                               0.000    0.000
##   slp2 =~                                                               
##     trial.1           0.000                               0.000    0.000
##     trial.2           0.000                               0.000    0.000
##     trial.3           0.000                               0.000    0.000
##     trial.4           0.000                               0.000    0.000
##     trial.5           1.000                               0.167    0.152
##     trial.6           2.000                               0.333    0.289
##     trial.7           3.000                               0.500    0.399
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   int ~~                                                                
##     slp1             -0.067    0.061   -1.099    0.272   -0.264   -0.264
##     quad             -0.044    0.019   -2.275    0.023   -0.426   -0.426
##     slp2             -0.001    0.024   -0.042    0.967   -0.007   -0.007
##   slp1 ~~                                                               
##     quad              0.029    0.027    1.060    0.289    0.895    0.895
##     slp2              0.007    0.023    0.292    0.770    0.140    0.140
##   quad ~~                                                               
##     slp2              0.003    0.007    0.393    0.694    0.140    0.140
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .trial.1           0.000                               0.000    0.000
##    .trial.2           0.000                               0.000    0.000
##    .trial.3           0.000                               0.000    0.000
##    .trial.4           0.000                               0.000    0.000
##    .trial.5           0.000                               0.000    0.000
##    .trial.6           0.000                               0.000    0.000
##    .trial.7           0.000                               0.000    0.000
##     int               0.416    0.060    6.956    0.000    0.463    0.463
##     slp1             -0.052    0.052   -1.006    0.314   -0.184   -0.184
##     quad             -0.065    0.017   -3.709    0.000   -0.566   -0.566
##     slp2              0.164    0.020    8.193    0.000    0.983    0.983
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .trial.1           0.350    0.115    3.047    0.002    0.350    0.354
##    .trial.2           0.285    0.036    7.954    0.000    0.285    0.265
##    .trial.3           0.311    0.039    7.983    0.000    0.311    0.259
##    .trial.4           0.365    0.049    7.506    0.000    0.365    0.311
##    .trial.5           0.370    0.037    9.896    0.000    0.370    0.307
##    .trial.6           0.414    0.044    9.298    0.000    0.414    0.311
##    .trial.7           0.517    0.071    7.249    0.000    0.517    0.329
##     int               0.810    0.091    8.930    0.000    1.000    1.000
##     slp1              0.080    0.079    1.010    0.312    1.000    1.000
##     quad              0.013    0.011    1.193    0.233    1.000    1.000
##     slp2              0.028    0.012    2.334    0.020    1.000    1.000</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="04-shape.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">id=</span>quad.rate.fit<span class="sc">@</span>Data<span class="sc">@</span>case.idx[[<span class="dv">1</span>]], </span>
<span id="cb145-2"><a href="04-shape.html#cb145-2" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">lavPredict</span>(quad.rate.fit,<span class="at">type=</span><span class="st">&quot;ov&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb145-3"><a href="04-shape.html#cb145-3" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;trial&quot;</span>), </span>
<span id="cb145-4"><a href="04-shape.html#cb145-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;.value&quot;</span>, <span class="st">&quot;num&quot;</span>), </span>
<span id="cb145-5"><a href="04-shape.html#cb145-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">names_pattern =</span> <span class="st">&quot;(trial).(.)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb145-6"><a href="04-shape.html#cb145-6" aria-hidden="true" tabindex="-1"></a>                  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">num =</span> <span class="fu">as.numeric</span>(num)), </span>
<span id="cb145-7"><a href="04-shape.html#cb145-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> num, </span>
<span id="cb145-8"><a href="04-shape.html#cb145-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> trial, </span>
<span id="cb145-9"><a href="04-shape.html#cb145-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">group =</span> id, </span>
<span id="cb145-10"><a href="04-shape.html#cb145-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> <span class="fu">factor</span>(id))) <span class="sc">+</span></span>
<span id="cb145-11"><a href="04-shape.html#cb145-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb145-12"><a href="04-shape.html#cb145-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Quadradic-Linear Piecewise LCM Trajectories&quot;</span>,</span>
<span id="cb145-13"><a href="04-shape.html#cb145-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Age&quot;</span>,</span>
<span id="cb145-14"><a href="04-shape.html#cb145-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Predicted Externalizing Behavior&quot;</span>) <span class="sc">+</span></span>
<span id="cb145-15"><a href="04-shape.html#cb145-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) </span></code></pre></div>
<p><img src="longitudinal_primer_files/figure-html/piecewise%2003-1.png" width="672" /></p>
<p>To fit piecewise models in the MLM, we simply create observed variables that correspond to the factor loadings we specified in the LCM code. Below we show how to generate these observed varaiables and the syntax to fit the two-rate version of the linear-linear model.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="04-shape.html#cb146-1" aria-hidden="true" tabindex="-1"></a>adversity.long <span class="ot">&lt;-</span> adversity <span class="sc">%&gt;%</span> </span>
<span id="cb146-2"><a href="04-shape.html#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;fmin&quot;</span>), </span>
<span id="cb146-3"><a href="04-shape.html#cb146-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;.value&quot;</span>, <span class="st">&quot;age&quot;</span>), </span>
<span id="cb146-4"><a href="04-shape.html#cb146-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_pattern =</span> <span class="st">&quot;(fmin)(.+)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb146-5"><a href="04-shape.html#cb146-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> <span class="fu">as.numeric</span>(age),</span>
<span id="cb146-6"><a href="04-shape.html#cb146-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">slp1 =</span> <span class="fu">ifelse</span>(age <span class="sc">&gt;</span> <span class="dv">7</span>, <span class="dv">0</span>, age <span class="sc">-</span> <span class="dv">7</span>),</span>
<span id="cb146-7"><a href="04-shape.html#cb146-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">slp2 =</span> <span class="fu">ifelse</span>(age <span class="sc">&lt;</span> <span class="dv">7</span>, <span class="dv">0</span>, age <span class="sc">-</span> <span class="dv">7</span>),</span>
<span id="cb146-8"><a href="04-shape.html#cb146-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">quad =</span> <span class="fu">ifelse</span>(age <span class="sc">&gt;</span> <span class="dv">7</span>, <span class="dv">0</span>, (age <span class="sc">-</span> <span class="dv">7</span>)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb146-9"><a href="04-shape.html#cb146-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-10"><a href="04-shape.html#cb146-10" aria-hidden="true" tabindex="-1"></a>two.rate.mlm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(fmin <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> slp1 <span class="sc">+</span> slp2 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> slp1 <span class="sc">+</span> slp2 <span class="sc">|</span> id),</span>
<span id="cb146-11"><a href="04-shape.html#cb146-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.action =</span> na.omit,</span>
<span id="cb146-12"><a href="04-shape.html#cb146-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">REML =</span> <span class="cn">TRUE</span>,</span>
<span id="cb146-13"><a href="04-shape.html#cb146-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> adversity.long,</span>
<span id="cb146-14"><a href="04-shape.html#cb146-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>,</span>
<span id="cb146-15"><a href="04-shape.html#cb146-15" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>)))</span>
<span id="cb146-16"><a href="04-shape.html#cb146-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(two.rate.mlm)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: fmin ~ 1 + slp1 + slp2 + (1 + slp1 + slp2 | id)
##    Data: adversity.long
## Control: lmerControl(optimizer = &quot;bobyqa&quot;, optCtrl = list(maxfun = 2e+05))
## 
## REML criterion at convergence: 3565.7
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.2040 -0.5616 -0.2004  0.4489  3.9715 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr     
##  id       (Intercept) 0.766247 0.8754            
##           slp1        0.020429 0.1429   1.00     
##           slp2        0.006305 0.0794   0.42 0.42
##  Residual             0.635271 0.7970            
## Number of obs: 1240, groups:  id, 398
## 
## Fixed effects:
##              Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)   0.21114    0.06180 403.54795   3.417 0.000698 ***
## slp1          0.07239    0.02774 556.14662   2.610 0.009304 ** 
## slp2          0.03752    0.01968 335.61477   1.907 0.057417 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##      (Intr) slp1  
## slp1  0.676       
## slp2 -0.450 -0.486
## optimizer (bobyqa) convergence code: 0 (OK)
## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<p>Fitting the piecewise model in the LCSM framework requires some additional work and unless we wish to include the dual-change effects, these models could be more-simply implemented as LCMs. This is due to a general complication in LCSMs if we wish to place the intercept anywhere except at the initial timepoint. If we look below at the <code>Regressions Between Adjacent Observations</code> section of the code below, we can see that for timepoints that come before the intercept (here before the knot point) we actually regression <em>earlier</em> timepoints on <em>later</em> timepoints. This reversal of the intuitive temporal order allows the LCSM to mimic the negative factor loadings in the LCM. Note also that the intercept timepoint (here <code>pfmin7</code>) appears twice, predicting the timepoint both before and after it. Finally, the loadings of the timepoints prior to the intercept load at a <span class="math inline">\(-1\)</span> on the delta factors rather than a <span class="math inline">\(1\)</span> as usual. The remainder of the model follows the conventions we are accustomed, but we comment below on the specific changes needed here.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="04-shape.html#cb148-1" aria-hidden="true" tabindex="-1"></a>two.rate.lcsm <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb148-2"><a href="04-shape.html#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="st">            # Define Phantom Variables (p = phantom)</span></span>
<span id="cb148-3"><a href="04-shape.html#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin4 =~ 1*fmin4; fmin4 ~ 0; fmin4 ~~ fmin4; pfmin4 ~~ 0*fmin4</span></span>
<span id="cb148-4"><a href="04-shape.html#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin5 =~ 1*fmin5; fmin5 ~ 0; fmin5 ~~ fmin5; pfmin5 ~~ 0*fmin5</span></span>
<span id="cb148-5"><a href="04-shape.html#cb148-5" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin6 =~ 1*fmin6; fmin6 ~ 0; fmin6 ~~ fmin6; pfmin6 ~~ 0*fmin6</span></span>
<span id="cb148-6"><a href="04-shape.html#cb148-6" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin7 =~ 1*fmin7; fmin7 ~ 0; fmin7 ~~ fmin7; pfmin7 ~~ 0*fmin7</span></span>
<span id="cb148-7"><a href="04-shape.html#cb148-7" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin8 =~ 1*fmin8; fmin8 ~ 0; fmin8 ~~ fmin8; pfmin8 ~~ 0*fmin8</span></span>
<span id="cb148-8"><a href="04-shape.html#cb148-8" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin9 =~ 1*fmin9; fmin9 ~ 0; fmin9 ~~ fmin9; pfmin9 ~~ 0*fmin9</span></span>
<span id="cb148-9"><a href="04-shape.html#cb148-9" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin10 =~ 1*fmin10; fmin10 ~ 0; fmin10 ~~ fmin10; pfmin10 ~~ 0*fmin10</span></span>
<span id="cb148-10"><a href="04-shape.html#cb148-10" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin11 =~ 1*fmin11; fmin11 ~ 0; fmin11 ~~ fmin11; pfmin11 ~~ 0*fmin11</span></span>
<span id="cb148-11"><a href="04-shape.html#cb148-11" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb148-12"><a href="04-shape.html#cb148-12" aria-hidden="true" tabindex="-1"></a><span class="st">            # Regressions Between Adjacent Observations</span></span>
<span id="cb148-13"><a href="04-shape.html#cb148-13" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin4 ~ 1*pfmin5  # temporal order reversed before intercept</span></span>
<span id="cb148-14"><a href="04-shape.html#cb148-14" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin5 ~ 1*pfmin6</span></span>
<span id="cb148-15"><a href="04-shape.html#cb148-15" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin6 ~ 1*pfmin7</span></span>
<span id="cb148-16"><a href="04-shape.html#cb148-16" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin8 ~ 1*pfmin7  # intercept time point appears twice</span></span>
<span id="cb148-17"><a href="04-shape.html#cb148-17" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin9 ~ 1*pfmin8</span></span>
<span id="cb148-18"><a href="04-shape.html#cb148-18" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin10 ~ 1*pfmin9</span></span>
<span id="cb148-19"><a href="04-shape.html#cb148-19" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin11 ~ 1*pfmin10</span></span>
<span id="cb148-20"><a href="04-shape.html#cb148-20" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb148-21"><a href="04-shape.html#cb148-21" aria-hidden="true" tabindex="-1"></a><span class="st">            # Define Change Latent Variables (delta)</span></span>
<span id="cb148-22"><a href="04-shape.html#cb148-22" aria-hidden="true" tabindex="-1"></a><span class="st">            # loadings prior to the intercept are negative</span></span>
<span id="cb148-23"><a href="04-shape.html#cb148-23" aria-hidden="true" tabindex="-1"></a><span class="st">            delta21 =~ -1*pfmin4;  delta21 ~~ 0*delta21 </span></span>
<span id="cb148-24"><a href="04-shape.html#cb148-24" aria-hidden="true" tabindex="-1"></a><span class="st">            delta32 =~ -1*pfmin5;  delta32 ~~ 0*delta32</span></span>
<span id="cb148-25"><a href="04-shape.html#cb148-25" aria-hidden="true" tabindex="-1"></a><span class="st">            delta43 =~ -1*pfmin6;  delta43 ~~ 0*delta43</span></span>
<span id="cb148-26"><a href="04-shape.html#cb148-26" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb148-27"><a href="04-shape.html#cb148-27" aria-hidden="true" tabindex="-1"></a><span class="st">            # loadings after the intercept are as usual</span></span>
<span id="cb148-28"><a href="04-shape.html#cb148-28" aria-hidden="true" tabindex="-1"></a><span class="st">            delta54 =~ 1*pfmin8;  delta54 ~~ 0*delta54</span></span>
<span id="cb148-29"><a href="04-shape.html#cb148-29" aria-hidden="true" tabindex="-1"></a><span class="st">            delta65 =~ 1*pfmin9;  delta65 ~~ 0*delta65</span></span>
<span id="cb148-30"><a href="04-shape.html#cb148-30" aria-hidden="true" tabindex="-1"></a><span class="st">            delta76 =~ 1*pfmin10;  delta76 ~~ 0*delta76</span></span>
<span id="cb148-31"><a href="04-shape.html#cb148-31" aria-hidden="true" tabindex="-1"></a><span class="st">            delta87 =~ 1*pfmin11;  delta87 ~~ 0*delta87</span></span>
<span id="cb148-32"><a href="04-shape.html#cb148-32" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb148-33"><a href="04-shape.html#cb148-33" aria-hidden="true" tabindex="-1"></a><span class="st">            # Define Intercept and Slope</span></span>
<span id="cb148-34"><a href="04-shape.html#cb148-34" aria-hidden="true" tabindex="-1"></a><span class="st">            int  =~ 1*pfmin7</span></span>
<span id="cb148-35"><a href="04-shape.html#cb148-35" aria-hidden="true" tabindex="-1"></a><span class="st">            slp1 =~ 1*delta21 + 1*delta32 + 1*delta43</span></span>
<span id="cb148-36"><a href="04-shape.html#cb148-36" aria-hidden="true" tabindex="-1"></a><span class="st">            slp2 =~ 1*delta54 + 1*delta65 + 1*delta76 + 1*delta87</span></span>
<span id="cb148-37"><a href="04-shape.html#cb148-37" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb148-38"><a href="04-shape.html#cb148-38" aria-hidden="true" tabindex="-1"></a><span class="st">            int ~ 1; slp1 ~ 1; slp2 ~ 1</span></span>
<span id="cb148-39"><a href="04-shape.html#cb148-39" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb148-40"><a href="04-shape.html#cb148-40" aria-hidden="true" tabindex="-1"></a><span class="st">            slp1 ~~ slp1</span></span>
<span id="cb148-41"><a href="04-shape.html#cb148-41" aria-hidden="true" tabindex="-1"></a><span class="st">            slp2 ~~ slp2</span></span>
<span id="cb148-42"><a href="04-shape.html#cb148-42" aria-hidden="true" tabindex="-1"></a><span class="st">            int ~~ slp1 + slp2</span></span>
<span id="cb148-43"><a href="04-shape.html#cb148-43" aria-hidden="true" tabindex="-1"></a><span class="st">            slp1 ~~ slp2</span></span>
<span id="cb148-44"><a href="04-shape.html#cb148-44" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb148-45"><a href="04-shape.html#cb148-45" aria-hidden="true" tabindex="-1"></a>two.rate.lcsm.fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(two.rate.lcsm,</span>
<span id="cb148-46"><a href="04-shape.html#cb148-46" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> adversity, </span>
<span id="cb148-47"><a href="04-shape.html#cb148-47" aria-hidden="true" tabindex="-1"></a>                         <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb148-48"><a href="04-shape.html#cb148-48" aria-hidden="true" tabindex="-1"></a>                         <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb148-49"><a href="04-shape.html#cb148-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-50"><a href="04-shape.html#cb148-50" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(two.rate.lcsm.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>, </span>
<span id="cb148-51"><a href="04-shape.html#cb148-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">TRUE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 50 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        17
## 
##   Number of observations                           398
##   Number of missing patterns                        40
## 
## Model Test User Model:
##                                                       
##   Test statistic                                35.322
##   Degrees of freedom                                27
##   P-value (Chi-square)                           0.131
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   pfmin4 =~                                                             
##     fmin4             1.000                               0.963    0.965
##   pfmin5 =~                                                             
##     fmin5             1.000                               0.815    0.866
##   pfmin6 =~                                                             
##     fmin6             1.000                               0.786    0.731
##   pfmin7 =~                                                             
##     fmin7             1.000                               0.886    0.761
##   pfmin8 =~                                                             
##     fmin8             1.000                               0.919    0.732
##   pfmin9 =~                                                             
##     fmin9             1.000                               0.955    0.776
##   pfmin10 =~                                                            
##     fmin10            1.000                               0.995    0.829
##   pfmin11 =~                                                            
##     fmin11            1.000                               1.038    0.774
##   delta21 =~                                                            
##     pfmin4           -1.000                              -0.341   -0.341
##   delta32 =~                                                            
##     pfmin5           -1.000                              -0.403   -0.403
##   delta43 =~                                                            
##     pfmin6           -1.000                              -0.418   -0.418
##   delta54 =~                                                            
##     pfmin8            1.000                               0.074    0.074
##   delta65 =~                                                            
##     pfmin9            1.000                               0.071    0.071
##   delta76 =~                                                            
##     pfmin10           1.000                               0.068    0.068
##   delta87 =~                                                            
##     pfmin11           1.000                               0.066    0.066
##   int =~                                                                
##     pfmin7            1.000                               1.000    1.000
##   slp1 =~                                                               
##     delta21           1.000                               1.000    1.000
##     delta32           1.000                               1.000    1.000
##     delta43           1.000                               1.000    1.000
##   slp2 =~                                                               
##     delta54           1.000                               1.000    1.000
##     delta65           1.000                               1.000    1.000
##     delta76           1.000                               1.000    1.000
##     delta87           1.000                               1.000    1.000
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   pfmin4 ~                                                              
##     pfmin5            1.000                               0.846    0.846
##   pfmin5 ~                                                              
##     pfmin6            1.000                               0.964    0.964
##   pfmin6 ~                                                              
##     pfmin7            1.000                               1.128    1.128
##   pfmin8 ~                                                              
##     pfmin7            1.000                               0.965    0.965
##   pfmin9 ~                                                              
##     pfmin8            1.000                               0.962    0.962
##   pfmin10 ~                                                             
##     pfmin9            1.000                               0.960    0.960
##   pfmin11 ~                                                             
##     pfmin10           1.000                               0.959    0.959
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##  .pfmin4 ~~                                                             
##    .fmin4             0.000                                 NaN      NaN
##  .pfmin5 ~~                                                             
##    .fmin5             0.000                                 NaN      NaN
##  .pfmin6 ~~                                                             
##    .fmin6             0.000                                 NaN      NaN
##  .pfmin7 ~~                                                             
##    .fmin7             0.000                                 NaN      NaN
##  .pfmin8 ~~                                                             
##    .fmin8             0.000                                 NaN      NaN
##  .pfmin9 ~~                                                             
##    .fmin9             0.000                                 NaN      NaN
##  .pfmin10 ~~                                                            
##    .fmin10            0.000                                 NaN      NaN
##  .pfmin11 ~~                                                            
##    .fmin11            0.000                                 NaN      NaN
##   int ~~                                                                
##     slp1              0.138    0.062    2.233    0.026    0.475    0.475
##     slp2              0.027    0.045    0.602    0.547    0.449    0.449
##   slp1 ~~                                                               
##     slp2              0.011    0.019    0.548    0.584    0.475    0.475
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .fmin4             0.000                               0.000    0.000
##    .fmin5             0.000                               0.000    0.000
##    .fmin6             0.000                               0.000    0.000
##    .fmin7             0.000                               0.000    0.000
##    .fmin8             0.000                               0.000    0.000
##    .fmin9             0.000                               0.000    0.000
##    .fmin10            0.000                               0.000    0.000
##    .fmin11            0.000                               0.000    0.000
##     int               0.216    0.062    3.495    0.000    0.244    0.244
##     slp1              0.079    0.029    2.741    0.006    0.239    0.239
##     slp2              0.031    0.020    1.576    0.115    0.455    0.455
##    .pfmin4            0.000                               0.000    0.000
##    .pfmin5            0.000                               0.000    0.000
##    .pfmin6            0.000                               0.000    0.000
##    .pfmin7            0.000                               0.000    0.000
##    .pfmin8            0.000                               0.000    0.000
##    .pfmin9            0.000                               0.000    0.000
##    .pfmin10           0.000                               0.000    0.000
##    .pfmin11           0.000                               0.000    0.000
##    .delta21           0.000                               0.000    0.000
##    .delta32           0.000                               0.000    0.000
##    .delta43           0.000                               0.000    0.000
##    .delta54           0.000                               0.000    0.000
##    .delta65           0.000                               0.000    0.000
##    .delta76           0.000                               0.000    0.000
##    .delta87           0.000                               0.000    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .fmin4             0.069    0.388    0.178    0.859    0.069    0.069
##    .fmin5             0.221    0.190    1.161    0.246    0.221    0.250
##    .fmin6             0.539    0.103    5.231    0.000    0.539    0.466
##    .fmin7             0.570    0.156    3.653    0.000    0.570    0.420
##    .fmin8             0.731    0.129    5.671    0.000    0.731    0.464
##    .fmin9             0.605    0.099    6.108    0.000    0.605    0.399
##    .fmin10            0.450    0.123    3.664    0.000    0.450    0.312
##    .fmin11            0.722    0.172    4.191    0.000    0.722    0.401
##    .delta21           0.000                               0.000    0.000
##    .delta32           0.000                               0.000    0.000
##    .delta43           0.000                               0.000    0.000
##    .delta54           0.000                               0.000    0.000
##    .delta65           0.000                               0.000    0.000
##    .delta76           0.000                               0.000    0.000
##    .delta87           0.000                               0.000    0.000
##     slp1              0.108    0.056    1.919    0.055    1.000    1.000
##     slp2              0.005    0.019    0.240    0.810    1.000    1.000
##    .pfmin4            0.000                               0.000    0.000
##    .pfmin5            0.000                               0.000    0.000
##    .pfmin6            0.000                               0.000    0.000
##    .pfmin7            0.000                               0.000    0.000
##    .pfmin8            0.000                               0.000    0.000
##    .pfmin9            0.000                               0.000    0.000
##    .pfmin10           0.000                               0.000    0.000
##    .pfmin11           0.000                               0.000    0.000
##     int               0.786    0.151    5.215    0.000    1.000    1.000</code></pre>
<p>If we wish to include proportional change into this model, there is another additional oddity. For the beta parameters prior to the intercept, we actually create a cycle in our model (in technical terms the model is non-recursive), where the delta factor that a given phantom loads on is then regressed on that same phantom variable. The model remains identified, however, because the loading is fixed to <span class="math inline">\(-1\)</span> while the proportional effect is freely estimated. The relevant syntax is below.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="04-shape.html#cb150-1" aria-hidden="true" tabindex="-1"></a>two.rate.prop.lcsm <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb150-2"><a href="04-shape.html#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="st">            # Define Phantom Variables (p = phantom)</span></span>
<span id="cb150-3"><a href="04-shape.html#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin4 =~ 1*fmin4; fmin4 ~ 0; fmin4 ~~ fmin4; pfmin4 ~~ 0*fmin4</span></span>
<span id="cb150-4"><a href="04-shape.html#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin5 =~ 1*fmin5; fmin5 ~ 0; fmin5 ~~ fmin5; pfmin5 ~~ 0*fmin5</span></span>
<span id="cb150-5"><a href="04-shape.html#cb150-5" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin6 =~ 1*fmin6; fmin6 ~ 0; fmin6 ~~ fmin6; pfmin6 ~~ 0*fmin6</span></span>
<span id="cb150-6"><a href="04-shape.html#cb150-6" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin7 =~ 1*fmin7; fmin7 ~ 0; fmin7 ~~ fmin7; pfmin7 ~~ 0*fmin7</span></span>
<span id="cb150-7"><a href="04-shape.html#cb150-7" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin8 =~ 1*fmin8; fmin8 ~ 0; fmin8 ~~ fmin8; pfmin8 ~~ 0*fmin8</span></span>
<span id="cb150-8"><a href="04-shape.html#cb150-8" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin9 =~ 1*fmin9; fmin9 ~ 0; fmin9 ~~ fmin9; pfmin9 ~~ 0*fmin9</span></span>
<span id="cb150-9"><a href="04-shape.html#cb150-9" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin10 =~ 1*fmin10; fmin10 ~ 0; fmin10 ~~ fmin10; pfmin10 ~~ 0*fmin10</span></span>
<span id="cb150-10"><a href="04-shape.html#cb150-10" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin11 =~ 1*fmin11; fmin11 ~ 0; fmin11 ~~ fmin11; pfmin11 ~~ 0*fmin11</span></span>
<span id="cb150-11"><a href="04-shape.html#cb150-11" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb150-12"><a href="04-shape.html#cb150-12" aria-hidden="true" tabindex="-1"></a><span class="st">            # Regressions Between Adjacent Observations</span></span>
<span id="cb150-13"><a href="04-shape.html#cb150-13" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin4 ~ 1*pfmin5  # temporal order reversed before intercept</span></span>
<span id="cb150-14"><a href="04-shape.html#cb150-14" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin5 ~ 1*pfmin6</span></span>
<span id="cb150-15"><a href="04-shape.html#cb150-15" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin6 ~ 1*pfmin7</span></span>
<span id="cb150-16"><a href="04-shape.html#cb150-16" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin8 ~ 1*pfmin7  # intercept time point appears twice</span></span>
<span id="cb150-17"><a href="04-shape.html#cb150-17" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin9 ~ 1*pfmin8</span></span>
<span id="cb150-18"><a href="04-shape.html#cb150-18" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin10 ~ 1*pfmin9</span></span>
<span id="cb150-19"><a href="04-shape.html#cb150-19" aria-hidden="true" tabindex="-1"></a><span class="st">            pfmin11 ~ 1*pfmin10</span></span>
<span id="cb150-20"><a href="04-shape.html#cb150-20" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb150-21"><a href="04-shape.html#cb150-21" aria-hidden="true" tabindex="-1"></a><span class="st">            # Define Change Latent Variables (delta)</span></span>
<span id="cb150-22"><a href="04-shape.html#cb150-22" aria-hidden="true" tabindex="-1"></a><span class="st">            # loadings prior to the intercept are negative</span></span>
<span id="cb150-23"><a href="04-shape.html#cb150-23" aria-hidden="true" tabindex="-1"></a><span class="st">            delta21 =~ -1*pfmin4;  delta21 ~~ 0*delta21 </span></span>
<span id="cb150-24"><a href="04-shape.html#cb150-24" aria-hidden="true" tabindex="-1"></a><span class="st">            delta32 =~ -1*pfmin5;  delta32 ~~ 0*delta32</span></span>
<span id="cb150-25"><a href="04-shape.html#cb150-25" aria-hidden="true" tabindex="-1"></a><span class="st">            delta43 =~ -1*pfmin6;  delta43 ~~ 0*delta43</span></span>
<span id="cb150-26"><a href="04-shape.html#cb150-26" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb150-27"><a href="04-shape.html#cb150-27" aria-hidden="true" tabindex="-1"></a><span class="st">            # loadings after the intercept are as usual</span></span>
<span id="cb150-28"><a href="04-shape.html#cb150-28" aria-hidden="true" tabindex="-1"></a><span class="st">            delta54 =~ 1*pfmin8;  delta54 ~~ 0*delta54</span></span>
<span id="cb150-29"><a href="04-shape.html#cb150-29" aria-hidden="true" tabindex="-1"></a><span class="st">            delta65 =~ 1*pfmin9;  delta65 ~~ 0*delta65</span></span>
<span id="cb150-30"><a href="04-shape.html#cb150-30" aria-hidden="true" tabindex="-1"></a><span class="st">            delta76 =~ 1*pfmin10;  delta76 ~~ 0*delta76</span></span>
<span id="cb150-31"><a href="04-shape.html#cb150-31" aria-hidden="true" tabindex="-1"></a><span class="st">            delta87 =~ 1*pfmin11;  delta87 ~~ 0*delta87</span></span>
<span id="cb150-32"><a href="04-shape.html#cb150-32" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb150-33"><a href="04-shape.html#cb150-33" aria-hidden="true" tabindex="-1"></a><span class="st">            # Define Proportional Change Regressions (beta = equality constraint)</span></span>
<span id="cb150-34"><a href="04-shape.html#cb150-34" aria-hidden="true" tabindex="-1"></a><span class="st">            # Non-recursive Proportional Paths</span></span>
<span id="cb150-35"><a href="04-shape.html#cb150-35" aria-hidden="true" tabindex="-1"></a><span class="st">            delta21 ~ beta*pfmin4</span></span>
<span id="cb150-36"><a href="04-shape.html#cb150-36" aria-hidden="true" tabindex="-1"></a><span class="st">            delta32 ~ beta*pfmin5</span></span>
<span id="cb150-37"><a href="04-shape.html#cb150-37" aria-hidden="true" tabindex="-1"></a><span class="st">            delta43 ~ beta*pfmin6</span></span>
<span id="cb150-38"><a href="04-shape.html#cb150-38" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb150-39"><a href="04-shape.html#cb150-39" aria-hidden="true" tabindex="-1"></a><span class="st">            # Standard Proportional Paths</span></span>
<span id="cb150-40"><a href="04-shape.html#cb150-40" aria-hidden="true" tabindex="-1"></a><span class="st">            delta54 ~ beta*pfmin7</span></span>
<span id="cb150-41"><a href="04-shape.html#cb150-41" aria-hidden="true" tabindex="-1"></a><span class="st">            delta65 ~ beta*pfmin8</span></span>
<span id="cb150-42"><a href="04-shape.html#cb150-42" aria-hidden="true" tabindex="-1"></a><span class="st">            delta76 ~ beta*pfmin9</span></span>
<span id="cb150-43"><a href="04-shape.html#cb150-43" aria-hidden="true" tabindex="-1"></a><span class="st">            delta87 ~ beta*pfmin10</span></span>
<span id="cb150-44"><a href="04-shape.html#cb150-44" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb150-45"><a href="04-shape.html#cb150-45" aria-hidden="true" tabindex="-1"></a><span class="st">            # Define Intercept and Slope</span></span>
<span id="cb150-46"><a href="04-shape.html#cb150-46" aria-hidden="true" tabindex="-1"></a><span class="st">            int  =~ 1*pfmin7</span></span>
<span id="cb150-47"><a href="04-shape.html#cb150-47" aria-hidden="true" tabindex="-1"></a><span class="st">            slp1 =~ 1*delta21 + 1*delta32 + 1*delta43</span></span>
<span id="cb150-48"><a href="04-shape.html#cb150-48" aria-hidden="true" tabindex="-1"></a><span class="st">            slp2 =~ 1*delta54 + 1*delta65 + 1*delta76 + 1*delta87</span></span>
<span id="cb150-49"><a href="04-shape.html#cb150-49" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb150-50"><a href="04-shape.html#cb150-50" aria-hidden="true" tabindex="-1"></a><span class="st">            int ~ 1; slp1 ~ 1; slp2 ~ 1</span></span>
<span id="cb150-51"><a href="04-shape.html#cb150-51" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb150-52"><a href="04-shape.html#cb150-52" aria-hidden="true" tabindex="-1"></a><span class="st">            slp1 ~~ slp1</span></span>
<span id="cb150-53"><a href="04-shape.html#cb150-53" aria-hidden="true" tabindex="-1"></a><span class="st">            slp2 ~~ slp2</span></span>
<span id="cb150-54"><a href="04-shape.html#cb150-54" aria-hidden="true" tabindex="-1"></a><span class="st">            int ~~ slp1 + slp2</span></span>
<span id="cb150-55"><a href="04-shape.html#cb150-55" aria-hidden="true" tabindex="-1"></a><span class="st">            slp1 ~~ slp2</span></span>
<span id="cb150-56"><a href="04-shape.html#cb150-56" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb150-57"><a href="04-shape.html#cb150-57" aria-hidden="true" tabindex="-1"></a>two.rate.prop.lcsm.fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(two.rate.prop.lcsm,</span>
<span id="cb150-58"><a href="04-shape.html#cb150-58" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data =</span> adversity, </span>
<span id="cb150-59"><a href="04-shape.html#cb150-59" aria-hidden="true" tabindex="-1"></a>                              <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb150-60"><a href="04-shape.html#cb150-60" aria-hidden="true" tabindex="-1"></a>                              <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb150-61"><a href="04-shape.html#cb150-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-62"><a href="04-shape.html#cb150-62" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(two.rate.prop.lcsm.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>, </span>
<span id="cb150-63"><a href="04-shape.html#cb150-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">TRUE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 781 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        24
##   Number of equality constraints                     6
## 
##   Number of observations                           398
##   Number of missing patterns                        40
## 
## Model Test User Model:
##                                                       
##   Test statistic                                34.156
##   Degrees of freedom                                26
##   P-value (Chi-square)                           0.131
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   pfmin4 =~                                                             
##     fmin4             1.000                               0.763    0.741
##   pfmin5 =~                                                             
##     fmin5             1.000                               0.747    0.800
##   pfmin6 =~                                                             
##     fmin6             1.000                               0.741    0.705
##   pfmin7 =~                                                             
##     fmin7             1.000                               0.881    0.747
##   pfmin8 =~                                                             
##     fmin8             1.000                               0.893    0.720
##   pfmin9 =~                                                             
##     fmin9             1.000                               0.919    0.757
##   pfmin10 =~                                                            
##     fmin10            1.000                               0.973    0.820
##   pfmin11 =~                                                            
##     fmin11            1.000                               1.070    0.779
##   delta21 =~                                                            
##     pfmin4           -1.000                              -0.103   -0.103
##   delta32 =~                                                            
##     pfmin5           -1.000                              -0.242   -0.242
##   delta43 =~                                                            
##     pfmin6           -1.000                              -0.560   -0.560
##   delta54 =~                                                            
##     pfmin8            1.000                                  NA       NA
##   delta65 =~                                                            
##     pfmin9            1.000                                  NA       NA
##   delta76 =~                                                            
##     pfmin10           1.000                                  NA       NA
##   delta87 =~                                                            
##     pfmin11           1.000                                  NA       NA
##   int =~                                                                
##     pfmin7            1.000                               1.000    1.000
##   slp1 =~                                                               
##     delta21           1.000                              12.920   12.920
##     delta32           1.000                               5.619    5.619
##     delta43           1.000                               2.444    2.444
##   slp2 =~                                                               
##     delta54           1.000                                  NA       NA
##     delta65           1.000                                  NA       NA
##     delta76           1.000                                  NA       NA
##     delta87           1.000                                  NA       NA
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   pfmin4 ~                                                              
##     pfmin5            1.000                               0.979    0.979
##   pfmin5 ~                                                              
##     pfmin6            1.000                               0.992    0.992
##   pfmin6 ~                                                              
##     pfmin7            1.000                               1.189    1.189
##   pfmin8 ~                                                              
##     pfmin7            1.000                               0.987    0.987
##   pfmin9 ~                                                              
##     pfmin8            1.000                               0.971    0.971
##   pfmin10 ~                                                             
##     pfmin9            1.000                               0.944    0.944
##   pfmin11 ~                                                             
##     pfmin10           1.000                               0.910    0.910
##   delta21 ~                                                             
##     pfmin4  (beta)    1.299    1.593    0.815    0.415   12.630   12.630
##   delta32 ~                                                             
##     pfmin5  (beta)    1.299    1.593    0.815    0.415    5.378    5.378
##   delta43 ~                                                             
##     pfmin6  (beta)    1.299    1.593    0.815    0.415    2.320    2.320
##   delta54 ~                                                             
##     pfmin7  (beta)    1.299    1.593    0.815    0.415       NA       NA
##   delta65 ~                                                             
##     pfmin8  (beta)    1.299    1.593    0.815    0.415       NA       NA
##   delta76 ~                                                             
##     pfmin9  (beta)    1.299    1.593    0.815    0.415       NA       NA
##   delta87 ~                                                             
##     pfmin10 (beta)    1.299    1.593    0.815    0.415       NA       NA
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##  .pfmin4 ~~                                                             
##    .fmin4             0.000                                 NaN      NaN
##  .pfmin5 ~~                                                             
##    .fmin5             0.000                                 NaN      NaN
##  .pfmin6 ~~                                                             
##    .fmin6             0.000                                 NaN      NaN
##  .pfmin7 ~~                                                             
##    .fmin7             0.000                                 NaN      NaN
##  .pfmin8 ~~                                                             
##    .fmin8             0.000                                 NaN      NaN
##  .pfmin9 ~~                                                             
##    .fmin9             0.000                                 NaN      NaN
##  .pfmin10 ~~                                                            
##    .fmin10            0.000                                 NaN      NaN
##  .pfmin11 ~~                                                            
##    .fmin11            0.000                                 NaN      NaN
##   int ~~                                                                
##     slp1             -0.550    0.824   -0.667    0.505   -0.615   -0.615
##     slp2             -0.997    1.287   -0.775    0.438   -1.000   -1.000
##   slp1 ~~                                                               
##     slp2              0.713    1.938    0.368    0.713    0.621    0.621
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .fmin4             0.000                               0.000    0.000
##    .fmin5             0.000                               0.000    0.000
##    .fmin6             0.000                               0.000    0.000
##    .fmin7             0.000                               0.000    0.000
##    .fmin8             0.000                               0.000    0.000
##    .fmin9             0.000                               0.000    0.000
##    .fmin10            0.000                               0.000    0.000
##    .fmin11            0.000                               0.000    0.000
##     int               0.212    0.058    3.629    0.000    0.241    0.241
##     slp1             -0.026    0.143   -0.180    0.857   -0.025   -0.025
##     slp2             -0.265    0.366   -0.724    0.469   -0.234   -0.234
##    .pfmin4            0.000                               0.000    0.000
##    .pfmin5            0.000                               0.000    0.000
##    .pfmin6            0.000                               0.000    0.000
##    .pfmin7            0.000                               0.000    0.000
##    .pfmin8            0.000                               0.000    0.000
##    .pfmin9            0.000                               0.000    0.000
##    .pfmin10           0.000                               0.000    0.000
##    .pfmin11           0.000                               0.000    0.000
##    .delta21           0.000                               0.000    0.000
##    .delta32           0.000                               0.000    0.000
##    .delta43           0.000                               0.000    0.000
##    .delta54           0.000                                  NA       NA
##    .delta65           0.000                                  NA       NA
##    .delta76           0.000                                  NA       NA
##    .delta87           0.000                                  NA       NA
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .fmin4             0.478    0.272    1.758    0.079    0.478    0.451
##    .fmin5             0.315    0.200    1.574    0.116    0.315    0.361
##    .fmin6             0.555    0.112    4.948    0.000    0.555    0.502
##    .fmin7             0.613    0.118    5.191    0.000    0.613    0.441
##    .fmin8             0.743    0.135    5.482    0.000    0.743    0.482
##    .fmin9             0.630    0.101    6.248    0.000    0.630    0.427
##    .fmin10            0.463    0.120    3.846    0.000    0.463    0.328
##    .fmin11            0.742    0.500    1.484    0.138    0.742    0.393
##    .delta21           0.000                               0.000    0.000
##    .delta32           0.000                               0.000    0.000
##    .delta43           0.000                               0.000    0.000
##    .delta54           0.000                                  NA       NA
##    .delta65           0.000                                  NA       NA
##    .delta76           0.000                                  NA       NA
##    .delta87           0.000                                  NA       NA
##     slp1              1.029    2.207    0.466    0.641    1.000    1.000
##     slp2              1.282    3.261    0.393    0.694    1.000    1.000
##    .pfmin4            0.000                               0.000    0.000
##    .pfmin5            0.000                               0.000    0.000
##    .pfmin6            0.000                               0.000    0.000
##    .pfmin7            0.000                               0.000    0.000
##    .pfmin8            0.000                               0.000    0.000
##    .pfmin9            0.000                               0.000    0.000
##    .pfmin10           0.000                               0.000    0.000
##    .pfmin11           0.000                               0.000    0.000
##     int               0.776    0.113    6.844    0.000    1.000    1.000</code></pre>
</div>
<div id="nonlinear-trajectories" class="section level2 hasAnchor">
<h2>Nonlinear Trajectories<a href="04-shape.html#nonlinear-trajectories" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>However, we sometimes need to move beyond well-defined polynomial models in order to capture the complexity of developmental change over time and consider truly nonlinear trajectories. This is most common in applications with dense observations within-person or that cover wide (i.e., decades) age-ranges between-person, although we can model true nonlinearities in standard applications with 4-6 timepoints. GAMMs will shine in the former case, while LCMs and LCSMs offer some options for the latter.</p>
<p>We can start with the GAMM syntax we are familiar with to specify a nonlinear trend across ages <span class="math inline">\(8-28\)</span> in the <code>feedback.learning</code> data.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="04-shape.html#cb152-1" aria-hidden="true" tabindex="-1"></a>gamm <span class="ot">&lt;-</span> <span class="fu">gamm4</span>(<span class="fu">scale</span>(modularity) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">s</span>(age),</span>
<span id="cb152-2"><a href="04-shape.html#cb152-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">random =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> id),</span>
<span id="cb152-3"><a href="04-shape.html#cb152-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> feedback.learning)</span>
<span id="cb152-4"><a href="04-shape.html#cb152-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-5"><a href="04-shape.html#cb152-5" aria-hidden="true" tabindex="-1"></a><span class="fu">gamtabs</span>(gamm<span class="sc">$</span>gam, <span class="at">type =</span> <span class="st">&quot;html&quot;</span>,</span>
<span id="cb152-6"><a href="04-shape.html#cb152-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">pnames =</span> <span class="fu">c</span>(<span class="st">&quot;Intercept&quot;</span>), <span class="at">snames =</span> <span class="fu">c</span>(<span class="st">&quot;s(Age)&quot;</span>),</span>
<span id="cb152-7"><a href="04-shape.html#cb152-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">&quot;Modularity as a Function of Age&quot;</span>)</span></code></pre></div>
<!-- html table generated in R 4.2.2 by xtable 1.8-4 package -->
<!-- Mon Feb 13 13:36:54 2023 -->
<table border="1">
<caption align="bottom">
Modularity as a Function of Age
</caption>
<tr>
<td>
A. parametric coefficients
</td>
<td align="right">
Estimate
</td>
<td align="right">
Std. Error
</td>
<td align="right">
t-value
</td>
<td align="right">
p-value
</td>
</tr>
<tr>
<td>
Intercept
</td>
<td align="right">
-0.0095
</td>
<td align="right">
0.0464
</td>
<td align="right">
-0.2052
</td>
<td align="right">
0.8375
</td>
</tr>
<tr>
<td>
B. smooth terms
</td>
<td align="right">
edf
</td>
<td align="right">
Ref.df
</td>
<td align="right">
F-value
</td>
<td align="right">
p-value
</td>
</tr>
<tr>
<td>
s(Age)
</td>
<td align="right">
4.6471
</td>
<td align="right">
4.6471
</td>
<td align="right">
28.1838
</td>
<td align="right">
&lt; 0.0001
</td>
</tr>
<a name=tab.gam></a>
</table>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="04-shape.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.gam</span>(gamm<span class="sc">$</span>gam, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>, <span class="at">shade =</span> <span class="cn">TRUE</span>,</span>
<span id="cb153-2"><a href="04-shape.html#cb153-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">&quot;Age&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Fitted Modularity Values&quot;</span>)</span></code></pre></div>
<p><img src="longitudinal_primer_files/figure-html/nonlinear%2001-1.png" width="672" /></p>
<p>Nothing as changed about this model from what we have seen previously because the GAMM intrinsically captures non-linearities through the use of the splines. In principle, given the functional form that is revealed, these data might also be fit with a quadratic polynomial (indeed in McCormick et al., 2021, <em>NeuroImage</em>: see main analyses versus supplemental GAMMs as a sensitivity check). Indeed these models might be a nice tool for this purpose to check the reasonableness of the functional form specified in more restrictive polynomial models, even if we retain the polynomials for interpretability. With expanding age ranges, this type of sensitivity check becomes increasingly important, since the non-linearities of the GAMM are a better theoretical match for the complex patterns of growth across the lifespan. While deceptively simple in their implementation (indeed this is the exact same model we keep fitting), GAMMS are a powerful and flexible tool for fitting developmental trajectories.</p>
<p>The SEMs also allow for the inclusion of some nonlinear terms. Like the GAMM, we have already seen the most common nonlinearity through the proportional change parameter of the LCSM. We include the code and output for this model below but otherwise will not explore it further here.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="04-shape.html#cb154-1" aria-hidden="true" tabindex="-1"></a>executive.function <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/executive-function.csv&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb154-2"><a href="04-shape.html#cb154-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, dlpfc1<span class="sc">:</span>dlpfc4)</span>
<span id="cb154-3"><a href="04-shape.html#cb154-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-4"><a href="04-shape.html#cb154-4" aria-hidden="true" tabindex="-1"></a>proportional.lcsm <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb154-5"><a href="04-shape.html#cb154-5" aria-hidden="true" tabindex="-1"></a><span class="st">               # Define Phantom Variables (p = phantom)</span></span>
<span id="cb154-6"><a href="04-shape.html#cb154-6" aria-hidden="true" tabindex="-1"></a><span class="st">               pdlpfc1 =~ 1*dlpfc1; dlpfc1 ~ 0; dlpfc1 ~~ dlpfc1; pdlpfc1 ~~ 0*pdlpfc1</span></span>
<span id="cb154-7"><a href="04-shape.html#cb154-7" aria-hidden="true" tabindex="-1"></a><span class="st">               pdlpfc2 =~ 1*dlpfc2; dlpfc2 ~ 0; dlpfc2 ~~ dlpfc2; pdlpfc2 ~~ 0*pdlpfc2</span></span>
<span id="cb154-8"><a href="04-shape.html#cb154-8" aria-hidden="true" tabindex="-1"></a><span class="st">               pdlpfc3 =~ 1*dlpfc3; dlpfc3 ~ 0; dlpfc3 ~~ dlpfc3; pdlpfc3 ~~ 0*pdlpfc3</span></span>
<span id="cb154-9"><a href="04-shape.html#cb154-9" aria-hidden="true" tabindex="-1"></a><span class="st">               pdlpfc4 =~ 1*dlpfc4; dlpfc4 ~ 0; dlpfc4 ~~ dlpfc4; pdlpfc4 ~~ 0*pdlpfc4</span></span>
<span id="cb154-10"><a href="04-shape.html#cb154-10" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb154-11"><a href="04-shape.html#cb154-11" aria-hidden="true" tabindex="-1"></a><span class="st">               # Regressions Between Adjacent Observations</span></span>
<span id="cb154-12"><a href="04-shape.html#cb154-12" aria-hidden="true" tabindex="-1"></a><span class="st">               pdlpfc2 ~ 1*pdlpfc1</span></span>
<span id="cb154-13"><a href="04-shape.html#cb154-13" aria-hidden="true" tabindex="-1"></a><span class="st">               pdlpfc3 ~ 1*pdlpfc2</span></span>
<span id="cb154-14"><a href="04-shape.html#cb154-14" aria-hidden="true" tabindex="-1"></a><span class="st">               pdlpfc4 ~ 1*pdlpfc3</span></span>
<span id="cb154-15"><a href="04-shape.html#cb154-15" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb154-16"><a href="04-shape.html#cb154-16" aria-hidden="true" tabindex="-1"></a><span class="st">               # Define Change Latent Variables (delta)</span></span>
<span id="cb154-17"><a href="04-shape.html#cb154-17" aria-hidden="true" tabindex="-1"></a><span class="st">               delta21 =~ 1*pdlpfc2; delta21 ~~ 0*delta21</span></span>
<span id="cb154-18"><a href="04-shape.html#cb154-18" aria-hidden="true" tabindex="-1"></a><span class="st">               delta32 =~ 1*pdlpfc3; delta32 ~~ 0*delta32</span></span>
<span id="cb154-19"><a href="04-shape.html#cb154-19" aria-hidden="true" tabindex="-1"></a><span class="st">               delta43 =~ 1*pdlpfc4; delta43 ~~ 0*delta43</span></span>
<span id="cb154-20"><a href="04-shape.html#cb154-20" aria-hidden="true" tabindex="-1"></a><span class="st">               </span></span>
<span id="cb154-21"><a href="04-shape.html#cb154-21" aria-hidden="true" tabindex="-1"></a><span class="st">               # Define Proportional Change Regressions (beta = equality constraint)</span></span>
<span id="cb154-22"><a href="04-shape.html#cb154-22" aria-hidden="true" tabindex="-1"></a><span class="st">               delta21 ~ beta*pdlpfc1</span></span>
<span id="cb154-23"><a href="04-shape.html#cb154-23" aria-hidden="true" tabindex="-1"></a><span class="st">               delta32 ~ beta*pdlpfc2</span></span>
<span id="cb154-24"><a href="04-shape.html#cb154-24" aria-hidden="true" tabindex="-1"></a><span class="st">               delta43 ~ beta*pdlpfc3</span></span>
<span id="cb154-25"><a href="04-shape.html#cb154-25" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb154-26"><a href="04-shape.html#cb154-26" aria-hidden="true" tabindex="-1"></a><span class="st">               # Define Intercept and Slope</span></span>
<span id="cb154-27"><a href="04-shape.html#cb154-27" aria-hidden="true" tabindex="-1"></a><span class="st">               int =~ 1*pdlpfc1</span></span>
<span id="cb154-28"><a href="04-shape.html#cb154-28" aria-hidden="true" tabindex="-1"></a><span class="st">               slp =~ 1*delta21 + 1*delta32 + 1*delta43</span></span>
<span id="cb154-29"><a href="04-shape.html#cb154-29" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb154-30"><a href="04-shape.html#cb154-30" aria-hidden="true" tabindex="-1"></a><span class="st">               int ~ 1</span></span>
<span id="cb154-31"><a href="04-shape.html#cb154-31" aria-hidden="true" tabindex="-1"></a><span class="st">               slp ~ 1</span></span>
<span id="cb154-32"><a href="04-shape.html#cb154-32" aria-hidden="true" tabindex="-1"></a><span class="st">               </span></span>
<span id="cb154-33"><a href="04-shape.html#cb154-33" aria-hidden="true" tabindex="-1"></a><span class="st">               int ~~ slp</span></span>
<span id="cb154-34"><a href="04-shape.html#cb154-34" aria-hidden="true" tabindex="-1"></a><span class="st">               slp ~~ slp</span></span>
<span id="cb154-35"><a href="04-shape.html#cb154-35" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb154-36"><a href="04-shape.html#cb154-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-37"><a href="04-shape.html#cb154-37" aria-hidden="true" tabindex="-1"></a>lcsm.proportional <span class="ot">&lt;-</span> <span class="fu">sem</span>(proportional.lcsm, </span>
<span id="cb154-38"><a href="04-shape.html#cb154-38" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> executive.function, </span>
<span id="cb154-39"><a href="04-shape.html#cb154-39" aria-hidden="true" tabindex="-1"></a>                         <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb154-40"><a href="04-shape.html#cb154-40" aria-hidden="true" tabindex="-1"></a>                         <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb154-41"><a href="04-shape.html#cb154-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-42"><a href="04-shape.html#cb154-42" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lcsm.proportional)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 32 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        12
##   Number of equality constraints                     2
## 
##   Number of observations                           342
##   Number of missing patterns                         8
## 
## Model Test User Model:
##                                                       
##   Test statistic                                 1.132
##   Degrees of freedom                                 4
##   P-value (Chi-square)                           0.889
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   pdlpfc1 =~                                          
##     dlpfc1            1.000                           
##   pdlpfc2 =~                                          
##     dlpfc2            1.000                           
##   pdlpfc3 =~                                          
##     dlpfc3            1.000                           
##   pdlpfc4 =~                                          
##     dlpfc4            1.000                           
##   delta21 =~                                          
##     pdlpfc2           1.000                           
##   delta32 =~                                          
##     pdlpfc3           1.000                           
##   delta43 =~                                          
##     pdlpfc4           1.000                           
##   int =~                                              
##     pdlpfc1           1.000                           
##   slp =~                                              
##     delta21           1.000                           
##     delta32           1.000                           
##     delta43           1.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   pdlpfc2 ~                                           
##     pdlpfc1           1.000                           
##   pdlpfc3 ~                                           
##     pdlpfc2           1.000                           
##   pdlpfc4 ~                                           
##     pdlpfc3           1.000                           
##   delta21 ~                                           
##     pdlpfc1 (beta)   -0.090    0.276   -0.325    0.745
##   delta32 ~                                           
##     pdlpfc2 (beta)   -0.090    0.276   -0.325    0.745
##   delta43 ~                                           
##     pdlpfc3 (beta)   -0.090    0.276   -0.325    0.745
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   int ~~                                              
##     slp              -0.074    0.162   -0.457    0.647
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .dlpfc1            0.000                           
##    .dlpfc2            0.000                           
##    .dlpfc3            0.000                           
##    .dlpfc4            0.000                           
##     int               0.540    0.054    9.994    0.000
##     slp               0.179    0.183    0.981    0.326
##    .pdlpfc1           0.000                           
##    .pdlpfc2           0.000                           
##    .pdlpfc3           0.000                           
##    .pdlpfc4           0.000                           
##    .delta21           0.000                           
##    .delta32           0.000                           
##    .delta43           0.000                           
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .dlpfc1            0.208    0.102    2.043    0.041
##    .pdlpfc1           0.000                           
##    .dlpfc2            0.573    0.058    9.820    0.000
##    .pdlpfc2           0.000                           
##    .dlpfc3            0.577    0.060    9.570    0.000
##    .pdlpfc3           0.000                           
##    .dlpfc4            0.413    0.095    4.358    0.000
##    .pdlpfc4           0.000                           
##    .delta21           0.000                           
##    .delta32           0.000                           
##    .delta43           0.000                           
##     slp               0.079    0.016    4.970    0.000
##     int               0.796    0.115    6.925    0.000</code></pre>
<p>However, the LCM offers an unique opportunity to model non-linear trends by throwing back to its roots in confirmatory factor analysis. Instead of specifying factor loadings, as we have done up to this point, we can allow a subset of them to be freely-estimated. This means that equal change is estimated between each timepoint, growth can accelerate and decelerate across different increments. However, to identify the growth model, we have to set at least two of the factor loadings to pre-specified values (<span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>) to set the scale for the other factor loadings. In general, there are two reasonable specifications. In the first, we set the first loading to <span class="math inline">\(0\)</span> and the second to <span class="math inline">\(1\)</span>. This means that the other factor loadings are proportional to the amount of change that occurs between the first and second time point. We can see this specification below.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="04-shape.html#cb156-1" aria-hidden="true" tabindex="-1"></a>free.load1 <span class="ot">&lt;-</span> <span class="st">&quot;int   =~ 1*fmin4 + 1*fmin5 + 1*fmin6 + 1*fmin7 + </span></span>
<span id="cb156-2"><a href="04-shape.html#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="st">                        1*fmin8 + 1*fmin9 + 1*fmin10 + 1*fmin11</span></span>
<span id="cb156-3"><a href="04-shape.html#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="st">               basis =~ 0*fmin4 + 1*fmin5 + l3*fmin6 + l4*fmin7 + </span></span>
<span id="cb156-4"><a href="04-shape.html#cb156-4" aria-hidden="true" tabindex="-1"></a><span class="st">                        l5*fmin8 + l6*fmin9 + l7*fmin10 + l8*fmin11</span></span>
<span id="cb156-5"><a href="04-shape.html#cb156-5" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb156-6"><a href="04-shape.html#cb156-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-7"><a href="04-shape.html#cb156-7" aria-hidden="true" tabindex="-1"></a>free.load1.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(free.load1,</span>
<span id="cb156-8"><a href="04-shape.html#cb156-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> adversity,</span>
<span id="cb156-9"><a href="04-shape.html#cb156-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb156-10"><a href="04-shape.html#cb156-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb156-11"><a href="04-shape.html#cb156-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-12"><a href="04-shape.html#cb156-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(free.load1.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>,</span>
<span id="cb156-13"><a href="04-shape.html#cb156-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">TRUE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 166 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        19
## 
##   Number of observations                           398
##   Number of missing patterns                        40
## 
## Model Test User Model:
##                                                       
##   Test statistic                                22.185
##   Degrees of freedom                                25
##   P-value (Chi-square)                           0.625
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   int =~                                                                
##     fmin4             1.000                               0.600    0.591
##     fmin5             1.000                               0.600    0.649
##     fmin6             1.000                               0.600    0.549
##     fmin7             1.000                               0.600    0.517
##     fmin8             1.000                               0.600    0.468
##     fmin9             1.000                               0.600    0.511
##     fmin10            1.000                               0.600    0.531
##     fmin11            1.000                               0.600    0.431
##   basis =~                                                              
##     fmin4             0.000                               0.000    0.000
##     fmin5             1.000                               0.043    0.046
##     fmin6     (l3)   10.433   29.658    0.352    0.725    0.446    0.408
##     fmin7     (l4)   10.668   29.930    0.356    0.722    0.456    0.393
##     fmin8     (l5)   14.511   41.748    0.348    0.728    0.621    0.484
##     fmin9     (l6)   10.347   28.954    0.357    0.721    0.443    0.377
##     fmin10    (l7)   10.041   28.272    0.355    0.722    0.429    0.380
##     fmin11    (l8)   22.493   65.844    0.342    0.733    0.962    0.691
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   int ~~                                                                
##     basis             0.006    0.018    0.355    0.723    0.246    0.246
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .fmin4             0.000                               0.000    0.000
##    .fmin5             0.000                               0.000    0.000
##    .fmin6             0.000                               0.000    0.000
##    .fmin7             0.000                               0.000    0.000
##    .fmin8             0.000                               0.000    0.000
##    .fmin9             0.000                               0.000    0.000
##    .fmin10            0.000                               0.000    0.000
##    .fmin11            0.000                               0.000    0.000
##     int              -0.011    0.068   -0.155    0.876   -0.018   -0.018
##     basis             0.021    0.064    0.332    0.740    0.500    0.500
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .fmin4             0.671    0.134    5.021    0.000    0.671    0.651
##    .fmin5             0.480    0.114    4.203    0.000    0.480    0.562
##    .fmin6             0.505    0.101    5.008    0.000    0.505    0.422
##    .fmin7             0.642    0.097    6.632    0.000    0.642    0.478
##    .fmin8             0.716    0.146    4.911    0.000    0.716    0.436
##    .fmin9             0.691    0.094    7.340    0.000    0.691    0.502
##    .fmin10            0.606    0.107    5.656    0.000    0.606    0.475
##    .fmin11            0.368    0.215    1.712    0.087    0.368    0.190
##     int               0.360    0.109    3.292    0.001    1.000    1.000
##     basis             0.002    0.011    0.167    0.867    1.000    1.000</code></pre>
<p>Here we label the freely-estimated factor loadings for convenient reference. We also specify the second factor as a basis (or sometimes “shape”) rather than a “slope” factor to reflect the non-linearity inherent in this model. When we examine the model results, we can see a pretty striking pattern of factor loadings. The third loading (<code>l3</code>) is <span class="math inline">\(10.43\)</span>, which suggests that more than <span class="math inline">\(9\)</span> times the amount of change occurs between the second and third timepoints as does between the first two (remember we take the difference between adjacent loadings). However, <code>l4</code> suggests that then there is a sharp deceleration in growth between the next timepoints. At <code>l6</code>, we can see that the factor loading actuall <em>decreases</em>, which is how this model fits a negative trend between adjacent timepoints. Finally, <code>l8</code> suggests a large increase at the final timepoint, reversing the earlier decreases. One thing to highlight is the increase in complexity just in describing the factor loadings and interpreting adjacent timepoints that do not follow some monotonic trend. Like many non-linear models, visualization of the model-implied trajectories is key for interpreting the effects. We can do so below.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="04-shape.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">id=</span>free.load1.fit<span class="sc">@</span>Data<span class="sc">@</span>case.idx[[<span class="dv">1</span>]], </span>
<span id="cb158-2"><a href="04-shape.html#cb158-2" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">lavPredict</span>(free.load1.fit,<span class="at">type=</span><span class="st">&quot;ov&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb158-3"><a href="04-shape.html#cb158-3" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;fmin&quot;</span>), </span>
<span id="cb158-4"><a href="04-shape.html#cb158-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;.value&quot;</span>, <span class="st">&quot;age&quot;</span>), </span>
<span id="cb158-5"><a href="04-shape.html#cb158-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">names_pattern =</span> <span class="st">&quot;(fmin)(.+)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb158-6"><a href="04-shape.html#cb158-6" aria-hidden="true" tabindex="-1"></a>                  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age =</span> <span class="fu">as.numeric</span>(age)), </span>
<span id="cb158-7"><a href="04-shape.html#cb158-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> age, </span>
<span id="cb158-8"><a href="04-shape.html#cb158-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> fmin, </span>
<span id="cb158-9"><a href="04-shape.html#cb158-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">group =</span> id, </span>
<span id="cb158-10"><a href="04-shape.html#cb158-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> <span class="fu">factor</span>(id))) <span class="sc">+</span></span>
<span id="cb158-11"><a href="04-shape.html#cb158-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb158-12"><a href="04-shape.html#cb158-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Free-loading Model 1 Trajectories&quot;</span>,</span>
<span id="cb158-13"><a href="04-shape.html#cb158-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Age&quot;</span>,</span>
<span id="cb158-14"><a href="04-shape.html#cb158-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Predicted Forceps Minor Microstructure&quot;</span>) <span class="sc">+</span></span>
<span id="cb158-15"><a href="04-shape.html#cb158-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) </span></code></pre></div>
<p><img src="longitudinal_primer_files/figure-html/nonlinear%2004-1.png" width="672" /></p>
<p>Here we can see the power, and danger, of these free-loading model. Like a GAMM, we can have complex, localized change, with reversals and highly variable slopes. However, in looking at the first couple of timepoints, we have to wonder if we are overfitting noise in the data when some simpler functional form would (e.g., a line) would describe this trend in a more replicable/generalizable way. Very often, these free-loading models will fit the data better than many alternatives we have discussed elsewhere in this primer, but then be very sample-depenedent in an unsatisfying fashion. Like with the GAMM, one potential use for this model is as a sensitivity check for a more-constrained LCM to ensure we are not completely botching the functional form.</p>
<p>We can refit this model using a different specification where we set the first loading to <span class="math inline">\(0\)</span> and the <em>last</em> loading to <span class="math inline">\(1\)</span>. This scales the estimated loadings to be proportions of the total growth realized by that point. We can see this model below.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="04-shape.html#cb159-1" aria-hidden="true" tabindex="-1"></a>free.load2 <span class="ot">&lt;-</span> <span class="st">&quot;int   =~ 1*fmin4 + 1*fmin5 + 1*fmin6 + 1*fmin7 + </span></span>
<span id="cb159-2"><a href="04-shape.html#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="st">                        1*fmin8 + 1*fmin9 + 1*fmin10 + 1*fmin11</span></span>
<span id="cb159-3"><a href="04-shape.html#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="st">               basis =~ 0*fmin4 + l2*fmin5 + l3*fmin6 + l4*fmin7 + </span></span>
<span id="cb159-4"><a href="04-shape.html#cb159-4" aria-hidden="true" tabindex="-1"></a><span class="st">                        l5*fmin8 + l6*fmin9 + l7*fmin10 + 1*fmin11</span></span>
<span id="cb159-5"><a href="04-shape.html#cb159-5" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb159-6"><a href="04-shape.html#cb159-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-7"><a href="04-shape.html#cb159-7" aria-hidden="true" tabindex="-1"></a>free.load2.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>(free.load2,</span>
<span id="cb159-8"><a href="04-shape.html#cb159-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> adversity,</span>
<span id="cb159-9"><a href="04-shape.html#cb159-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb159-10"><a href="04-shape.html#cb159-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">missing =</span> <span class="st">&quot;FIML&quot;</span>)</span>
<span id="cb159-11"><a href="04-shape.html#cb159-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-12"><a href="04-shape.html#cb159-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(free.load2.fit, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">estimates =</span> <span class="cn">TRUE</span>,</span>
<span id="cb159-13"><a href="04-shape.html#cb159-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardize =</span> <span class="cn">TRUE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 50 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        19
## 
##   Number of observations                           398
##   Number of missing patterns                        40
## 
## Model Test User Model:
##                                                       
##   Test statistic                                22.185
##   Degrees of freedom                                25
##   P-value (Chi-square)                           0.625
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   int =~                                                                
##     fmin4             1.000                               0.600    0.591
##     fmin5             1.000                               0.600    0.649
##     fmin6             1.000                               0.600    0.549
##     fmin7             1.000                               0.600    0.517
##     fmin8             1.000                               0.600    0.468
##     fmin9             1.000                               0.600    0.511
##     fmin10            1.000                               0.600    0.531
##     fmin11            1.000                               0.600    0.431
##   basis =~                                                              
##     fmin4             0.000                               0.000    0.000
##     fmin5     (l2)    0.044    0.130    0.342    0.733    0.043    0.046
##     fmin6     (l3)    0.464    0.117    3.962    0.000    0.446    0.408
##     fmin7     (l4)    0.474    0.118    4.036    0.000    0.456    0.393
##     fmin8     (l5)    0.645    0.141    4.564    0.000    0.621    0.484
##     fmin9     (l6)    0.460    0.121    3.800    0.000    0.443    0.377
##     fmin10    (l7)    0.446    0.148    3.024    0.002    0.429    0.380
##     fmin11            1.000                               0.962    0.691
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   int ~~                                                                
##     basis             0.142    0.168    0.842    0.400    0.246    0.246
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .fmin4             0.000                               0.000    0.000
##    .fmin5             0.000                               0.000    0.000
##    .fmin6             0.000                               0.000    0.000
##    .fmin7             0.000                               0.000    0.000
##    .fmin8             0.000                               0.000    0.000
##    .fmin9             0.000                               0.000    0.000
##    .fmin10            0.000                               0.000    0.000
##    .fmin11            0.000                               0.000    0.000
##     int              -0.011    0.068   -0.155    0.876   -0.018   -0.018
##     basis             0.481    0.102    4.729    0.000    0.500    0.500
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .fmin4             0.671    0.134    5.021    0.000    0.671    0.651
##    .fmin5             0.480    0.114    4.203    0.000    0.480    0.562
##    .fmin6             0.505    0.101    5.008    0.000    0.505    0.422
##    .fmin7             0.642    0.097    6.632    0.000    0.642    0.478
##    .fmin8             0.716    0.146    4.911    0.000    0.716    0.436
##    .fmin9             0.691    0.094    7.340    0.000    0.691    0.502
##    .fmin10            0.606    0.107    5.656    0.000    0.606    0.475
##    .fmin11            0.368    0.215    1.712    0.087    0.368    0.190
##     int               0.360    0.109    3.292    0.001    1.000    1.000
##     basis             0.925    0.385    2.404    0.016    1.000    1.000</code></pre>
<p>We can see that the loadings are now all less than <span class="math inline">\(1\)</span> but that they follow the same pattern as in the model (which they should, as they are identically-fitting models). However, now the loadings are expressed as percentages of the total change that occurs between the first and final timepoint. Note one odd thing is that when a trajectory follows a parabolic shape, we can get loadings about <span class="math inline">\(1\)</span> reflecting <span class="math inline">\(&gt;100%\)</span> of the overall change has occurred by that time point. Nothing is wrong, per se, with that interpretation, but given the oddness of language it evokes, the first specification is by far the more common.</p>
</div>
<div id="fixed-and-random-effects" class="section level2 hasAnchor">
<h2>Fixed and Random Effects<a href="04-shape.html#fixed-and-random-effects" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before we move on, we want to highlight the distinction we make between fixed and random effects when we talk about the limitations of the functional form with respect to the number of repeated measures, per person. The oft-repeated mantra is that you need <span class="math inline">\(3\)</span> timepoints for a line, <span class="math inline">\(4\)</span> for a quadratic, and so on ad infinitum. <em>But</em>, on the other hand, we can fit a highly complex non-linear developmental trajectory to data where each individual contributes <strong>at most</strong> <span class="math inline">\(2\)</span> timepoints. How do we reconcile these two things? Well it has to do with whether we treat the effect in question as fixed or random. When we treat a parameter as fixed, we obtain a single value that describes all indiviudals in our sample (barring pesky things like interactions), but when we treat an effect as random, we also model individual differences in that “fixed” parameter (note that we estimate a single variance per random effect, not individual effects, but that’s a longer discussion and we can calculate individual effects with some well-developed methods). So to estimate these individually-varying random effects, we need more repeated measures <em>within-person</em>. However, we can still estimate an overall fixed effect trajectory that takes advantage of greater timepoints <em>between</em> individuals than exist for any given individual. This is how we might estimate a GAMM with some highly complex surface, even though we could never estimate a random effect for any individual since they only contribute up to two observations.</p>
<p>We can demonstrate this with our <code>feedback.learning</code> data where we can model both the effect of <code>wave</code>, which is a fully within-person measure, as well as linear and quadratic <code>age</code>. These latter two effects are specified as fixed effects because while <code>age</code> between-person ranges from <span class="math inline">\(8 - 29\)</span>, no one person contributes more than <span class="math inline">\(3\)</span> time points, so the quadratic random effect would not be estimable. However, we can estimate a random effect of <code>wave</code>. We can see these effects below. This distinction highlights some of the advantages of having measurement timing heterogeneity for estimating more complex effect than one could do with single-cohort data with fully consistent assessment schedules.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="04-shape.html#cb161-1" aria-hidden="true" tabindex="-1"></a>feedback.learning <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/feedback-learning.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb161-2"><a href="04-shape.html#cb161-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, wave, age, modularity, learning.rate)</span>
<span id="cb161-3"><a href="04-shape.html#cb161-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-4"><a href="04-shape.html#cb161-4" aria-hidden="true" tabindex="-1"></a>fixrand <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">scale</span>(modularity) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wave <span class="sc">+</span> age <span class="sc">+</span> <span class="fu">I</span>(age<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb161-5"><a href="04-shape.html#cb161-5" aria-hidden="true" tabindex="-1"></a>                  (<span class="dv">1</span> <span class="sc">+</span> wave <span class="sc">|</span> id),</span>
<span id="cb161-6"><a href="04-shape.html#cb161-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">na.action =</span> na.omit,</span>
<span id="cb161-7"><a href="04-shape.html#cb161-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">REML =</span> <span class="cn">TRUE</span>,</span>
<span id="cb161-8"><a href="04-shape.html#cb161-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> feedback.learning)</span>
<span id="cb161-9"><a href="04-shape.html#cb161-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-10"><a href="04-shape.html#cb161-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fixrand, <span class="at">correlation =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: scale(modularity) ~ 1 + wave + age + I(age^2) + (1 + wave | id)
##    Data: feedback.learning
## 
## REML criterion at convergence: 1852.3
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -3.04443 -0.56388  0.00211  0.54870  2.45150 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr
##  id       (Intercept) 0.42472  0.6517       
##           wave        0.01452  0.1205   0.00
##  Residual             0.36813  0.6067       
## Number of obs: 754, groups:  id, 297
## 
## Fixed effects:
##               Estimate Std. Error         df t value Pr(&gt;|t|)    
## (Intercept)  -4.653017   0.450546 425.247375 -10.328  &lt; 2e-16 ***
## wave         -0.021516   0.038502 499.542055  -0.559    0.577    
## age           0.517778   0.055054 451.886893   9.405  &lt; 2e-16 ***
## I(age^2)     -0.013251   0.001576 468.353795  -8.410 4.97e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="03-time.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="05-covariates.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["twitter", "facebook", "linkedin", "google", "weibo", "instapaper"],
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/McCormickNeuro/longitudinal-primer/edit/main/04-shape.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"depth": 2,
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
